{% extends "layout.html" %}


{% block css %}

    <style type="text/css">
    /*
        @page {
            margin: 0.1cm 0.5cm;
        }
    */
        @page {
            margin: 0.5cm 1cm;
        }

        @font-face {
            font-family: 'Suwannaphum';
            font-style: normal;
            font-weight: 400;
            src: local('Suwannaphum'), url(https://fonts.gstatic.com/s/suwannaphum/v9/1jIPOyXied3T79GCnSlCN1tXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+1780-17FF, U+200B-200C, U+25CC;
        }

        @font-face {
            font-family: "Battambang";
            src: url(/static/fonts/Battambang-Regular.ttf);
            unicode-range: U+1780-17FF, U+200B-200C, U+25CC;
        }
        @font-face {
            font-family: "Battambang";
            src: url(/static/fonts/Battambang-Bold.ttf);
            font-weight: bold;
            unicode-range: U+1780-17FF, U+200B-200C, U+25CC;
        }
        @font-face {
            font-family: "Moul";
            src: url(/static/fonts/Moul.ttf);
            unicode-range: U+1780-17FF, U+200B-200C, U+25CC;
        }

        body{
            background-color: #fff;
            color: #555;
            font-family: "Suwannaphum", Helvetica, Arial, sans-serif;
            font-size: 12px;
            line-height: 1.42857;
        }

        .header{
            margin: 0px 0px;
        }

        .logo{
            width: 20%;
            /*border: 1px solid;*/
            float: left;
            text-align: center;
        }

        .company{
            width: 75%;
            /*border: 1px solid;*/
            float: left;
        }

        .clearfix{
            clear: both;
            width: 10%;
            height: 15px;
        }
        p{
            margin: 0px 0px 2px;
        }

        input {
            border: none;
            background: transparent;
        }

        @font-face {
            font-family: 'Moul', Arial;
            font-style: normal;
            font-weight: 400;
            src: local('Moul'), url(https://fonts.gstatic.com/s/moul/v8/9pP9Dsyzm8X_vCLNoMZkag.woff2) format('woff2');
            unicode-range: U+1780-17FF, U+200B-200C, U+25CC;
        }

        .companyKh
        {
            font-family: 'Moul', Arial;
        }
        h3 {
            font-size: {% if CompanyKh|length > 25 %} 10pt {% else %} 11pt {% endif %};
        }
        h4 {
            font-size: 10pt;
        }
        textarea { 
            border-style: none; 
            border-color: Transparent; 
            overflow: hidden;    
            resize: none;    
        }

        @media print {
            .hideprint {
                display:none;
            }

            .id_table {
                
            }
        }

        .fillin {
            border-bottom: 2px dotted #888;
            display: inline-block;
            font-weight: bold;
            line-height: 12px;
        }
        .fillinen {
            border-bottom: 2px dotted #888;
            display: inline-block;
            font-weight: bold;
            font-family: "Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
            line-height: 12px;
        }

    </style>


{% endblock %}


{% block content %}
    
    {% macro isInputBox(width="100px",value="") %}
        <input text="text" style="width:{{width}}" placeholder="{{'_'*100}}" value="{{value}}">
    {%- endmacro %}

    <div class="se-pre-con1"></div>
    <div class="navbar navbar-default navbar-static-top ActionFotter" id="CriteriaSetting" >

        <div class="col-sm-12">

            <form action="" method="POST" role="FORM">
                <div style="margin-top: 8px;">
                </div>

                <div class="col-sm-3" style="padding-left: 0;">
                    <input name="ID" id="ID" value="{{ID}}" class="form-control" placeholder="Contract ID *" style="width: 100%;">
                </div>

                <div class="col-sm-2" style="padding-left: 10;display:none;">
                    <select name="Resource" class="form-control" style="width: 100%;">
                        {% if Resource == 'AUTH' %}
                            <option selected value="AUTH">AUTH</option>
                            <option value="INAU">INAU</option>
                        {% else %}
                            <option value="AUTH">AUTH</option>
                            <option selected value="INAU">INAU</option>
                        {% endif %}
                    </select>
                </div>

                <label class="col-sm-1" style="padding:0px;">
                    <button type="submit" class="btn btn-flat btn-labeled btn-primary" style="padding: 7px 25px;">
                        Show
                    </button>
                </label>


                <div class="pull-right" style="padding-top:10px; padding-left:0px;">

                    {% from "print.html" import exportButtonLink %}
                    {{exportButtonLink()}}

                </div>
            </form> 
        </div>
    </div>

    {% set LCObj        = Data.get("LCObj", "") %}
    {% set Status       = Data.get("Status", "") %}
    {% set CustomerObj  = Data.get("CustomerObj", "") %}
    {% set Address      = Data.get("Address", "") %}
    {% set RepSchedList = Data.get("RepSchedList", "") %}
    {% set CurrencyObj  = Data.get("CurrencyObj", "") %}

    {% set CustomerKh = CustomerObj.LastNameKh +' '+CustomerObj.FirstNameKh if CustomerObj else 'Customer not found' %}
    {% set CustomerEn = CustomerObj.LastNameEn +' '+CustomerObj.FirstNameEn if CustomerObj else 'Customer not found' %}

    {% if LCObj and Status == True %}
    <div class="container">
            <div class="header">
                    <div class="col-xs-12">
                        <div class="row text-center">
                            <div class="col-xs-12 text-right">
                                <img style="max-width: 100%; max-height: 95%; margin-top: 3px;" 
                                    src="{{ url_for('static', filename='company/logo.png') }}">
                                
                                <h3> <b>TGC Cambodia Co.,Ltd</b> </h3>
                                <p style="font-size:13px"> Level 16 Unit 09, <br>
                                    Vatanac Capital Tower, <br>
                                    No. 66 Preah Monivong Blvd, <br>
                                    Sankat Wat Phnom, Khan Daun Penh, <br>
                                    Phnom Penh, Kingdom of Cambodia
                                </p>
                            </div>
                            <div class="row text-left" style="font-size:13px">
                                <p>Loan Number: {{ID}}</p>

                                <p>Customer Name: {{CustomerEn}}</p>

                                <p>Address: {{isInputBox(width="450px",value=Address)}} </p>

                                <p>Registration Number: {{isInputBox(width="200px")}} </p>

                                <p>Date of Disbursement: {{LCObj.ValueDate}}</p>

                                <p>Initial Loan Amount: {{mktmoney.toMoney(LCObj.Disbursed|float,CurrencyObj,1)}}</p>

                                <p>Oustanding Loan Amount: {{mktmoney.toMoney(LCObj.OutstandingAmount|float, CurrencyObj,1)}} </p>

                                <p>Interest Rate: {{LCObj.InterestRate}} %</p>

                                <p>Interest Payment Date: {{isInputBox(width="200px")}}</p>

                                <p>Number of Renewal: {{isInputBox(width="150px")}}</p>

                                <p>Loan to Value: {{isInputBox(width="150px")}} </p>

                                <p><b>Updated On: {{isInputBox(width="150px",value=mktdate.getBankDate())}}</b></p>
                            </div>

                            <div class="row text-center">
                                <h3><b>Payment Schedule</b></h3>

                                <table class="table">
                                    <thead>
                                        <th class="text-center">Date</th>
                                        <th class="text-center">Interest Due</th>
                                        <th class="text-center">Principal Amount Due</th>
                                        <th class="text-center">Num of Days</th>
                                        <th class="text-center">Remarks</th>
                                    </thead>
                                    <tbody>
                                        {% for row in RepSchedList %}
                                            <tr>
                                                <td>{{row.get("NextColDate")}}</td>
                                                <td>{{mktmoney.toMoney(row.get("IntDue"), CurrencyObj, 1) }}</td>
                                                <td>{{mktmoney.toMoney(row.get("PrincipalDue"), CurrencyObj, 1)}}</td>
                                                <td>{{row.get("NumOfDays")}}</td>
                                                <td>{{isInputBox(width="300px")}}</td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>

                        </div>
                        
                    </div>
             </div>

                            
            <div class="col-lg-12 col-sm-12 col-xs-12" style="padding:0px">
            
                <div class="col-xs-12 text-left" style="padding:0px">
                    <p>
                        1. Repayment Schedule shown are based on the updated datae as indicated in this schedule.
                        The tenure of the loan will be based on the schedule indicated. Any changes to the tenure and amount 
                        shown will be based on the actual outstanding loan amount at the lastest updated Data.
                    </p>

                    <p>
                        2. Please make payment to TGC CAMBODIA CO.,LTD Prince Bank Account No: 000049328 on the {{isInputBox("200px",mktdate.toDateEngLong(LCObj.FirstCollectionDate))}} <br>
                        Date:{{isInputBox("200px", mktdate.toDateEngLong(mktdate.getBankDate()) )}}
                    </p>
                </div>

                <div class="clearfix"></div>
                <div class="clearfix"></div>
                <div class="clearfix"></div>

                <div class="col-xs-12" style="padding:0px !important">
                    <div class="col-xs-6 text-left" style="padding:0px !important">
                        <div style="width: 200px; float:left; overflow: hidden;">
                            <p>
                                ______________________________ <br>
                                Issued By:
                            </p>

                            <textarea rows="3" style="text-align:top; width:100%" placeholder=".........................................................."></textarea>

                        </div>
                    </div>

                    <div class="col-xs-6" style="padding:0px !important;">

                        <div style="width:200px; float: right; overflow: hidden;">
                            <p>
                                ______________________________ <br>
                                
                                Approved By:
                            </p>

                            <textarea rows="3" style="text-align:top; width:100%" placeholder=".........................................................."></textarea>
                        </div>
                    </div>

                    <div class="clearfix"></div>
                    <div class="clearfix"></div>
                    <div class="clearfix"></div>

                    <div class="col-xs-6" style="padding:0px !important;">

                        <div style="width:200px; float: left; overflow: hidden;">
                            <p>
                                ______________________________ <br>
                                
                                Acknowledged By:
                            </p>

                            <textarea rows="3" style="text-align:top; width:100%" placeholder=".........................................................."></textarea>
                        </div>
                    </div>

                </div>
            </div>
    </div>
    {% else %}
        {% if Msg %}
                <div class="alert alert-warning" >
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    {{Msg}}
                </div>    
        {% endif %}
    {% endif %}   
{% endblock %}

{% block js %}

{% from "print.html" import exportIncludeJS %}
{{exportIncludeJS()}}

    <script type="text/javascript">
        $(document).ready(function() {

            {% from "print.html" import exportDataTable %}
            {{exportDataTable("#mktlist","")}}

        });
    </script>

{% endblock %}