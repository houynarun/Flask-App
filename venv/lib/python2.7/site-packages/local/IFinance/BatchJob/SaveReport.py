from app.Branch.models 									import MKT_BRANCH
from local.IFinance.tools.mktuserscript 				import insertDataToTable
from local.IFinance.Report.PortfolioSummary.views 		import getPortfolioSummary, MKT_PORTFOLIO_SUMMARY
from local.IFinance.Report.NPLSummary.views 			import getNPLSummary, MKT_NPL_SUMMARY
from local.IFinance.Report.PortfolioMovement.views 		import getPortfolioMovement, MKT_PORTFOLIO_MOVEMENT

Branch = MKT_BRANCH.query.all()

print "+======================+"
print "|Saving report to table|"
print "+======================+"

for item in Branch:
	print 'Branch', item.ID
	PortfolioSummary 	= getPortfolioSummary(item.ID)
	NPLSummary 			= getNPLSummary(item.ID)
	PortfolioMovement 	= getPortfolioMovement(item.ID)
	insertDataToTable(PortfolioSummary, MKT_PORTFOLIO_SUMMARY, item.ID)
	insertDataToTable(NPLSummary, MKT_NPL_SUMMARY, item.ID)
	insertDataToTable(PortfolioMovement, MKT_PORTFOLIO_MOVEMENT, item.ID)
print 'Done'