{% extends "layout.html" %}

{% block css %}
	<style type="text/css">
		body {
			background: white;
		}

		table thead th {
			text-align: center;
		}

		.header1{
			color: #888 !important;
			font-size: 16px;
			font-weight: bold;
			margin: 5px 0 10px;
			padding: 10px 18px 0;
		}

		.header2{
			color: #888 !important;
			font-size: 14px;
			font-weight: normal;
			margin: 5px 0 10px;
			padding: 0px 18px 0;
		}


		.head-line{
			color: #888 !important;
			font-size: 16px;
			font-weight: bold;
			margin: 5px 0 10px;
			padding: 10px 0 5px 0 ;
			text-decoration: underline;
		}

		.modal-dialog {
			width: 350px;
		}
	</style>

{% endblock %}

{% block content %}

<div class="navbar navbar-default navbar-static-top">
	{# <form method="GET" id="frm" name="frm" role="form">
		<div class="col-sm-6">
			<div style="margin-top: 8px;">
				<div class="col-sm-4" style="padding-left: 0;">
					<input type="text" name="Date" class="form-control" value="{{ Date }}" style="width: 100%;" placeholder="Date * (yyyy-mm-dd)">
				</div>
				<label class="col-sm-1" style="padding:0px;">
					<button type="submit" class="btn btn-flat btn-labeled btn-primary" style="padding: 7px 25px;">
						Show
					</button>
				</label>
			</div>
		</div>
	</form> #}
		<div class="col-sm-6"></div>
		<div class="col-sm-6" style="margin-top: 8px;">
			<div class="pull-right">
				<button type="button" class="btn btn-flat btn-labeled btn-success" data-toggle="modal" data-target="#getCustomRange">
					<span class="btn-label icon fa fa-gear"></span> Custom
				</button>
				<a id="print" onclick="" class="btn btn-flat btn-labeled btn-success">
					<span class="btn-label icon fa fa-print"></span> Print
				</a>
			</div>
		</div>
</div>

<div class="container">
	<div class="row">
		<div class="col-sm-12">
			<header>
				<center>
					<h1 class="header1" style="text-transform: uppercase;">{{Company}}</h1>
					<h2 class="header2">CASH MOVEMENT REGISTER</h2>
				</center>
				<div class="col-sm-12">
					<div class="row"><span class="col-sm-2">Branch</span><span class="col-sm-8">: {{BranchName}}</span></div>
					<div class="row"><span class="col-sm-2">As of Date</span><span class="col-sm-8">: {{Date}}</span></div>
					<div class="row"><span class="col-sm-2">Prepared By</span><span class="col-sm-8">: .................</span></div>
					<div class="row"><span class="col-sm-2">Printed By</span><span class="col-sm-8">: {{User.DisplayName}}</span></div>
				</div>
			</header>

			<section>
				<div class="row">
					
					<div class="col-sm-12">
						<h3 class="head-line">I. CASH MOVEMENT</h3>
					</div>
						
					{% set currencyList = ['USD', 'KHR'] %}
					{% for c in currencyList %}
						{% set CurrencyObj = mktmoney.getCurrencyObj(c) %}
						{% set ZeroBalance = mktmoney.toMoney(0, CurrencyObj) %}
						<div class="col-sm-6">
							<h3 class="head-line">{{c}}</h3>
							<table class="table table-bordered table-condensed">
								<thead>
									<tr>
										<th>Teller Name</th>
										<th>Cash In</th>
										<th>Cash Out</th>
									</tr>
								</thead>
								<tbody>
									{% set Dict = {'DrAmount':0, 'CrAmount':0} %}	
									{% for t in List %}
										<tr>
											<td>{{t.Name}}</td>
											{% if t.Data %}
												
												{% if c in t.Data %}
													<td class="text-right">{{mktmoney.toMoney(t.Data[c].DrAmount, CurrencyObj)}}</td>
													<td class="text-right">{{mktmoney.toMoney(t.Data[c].CrAmount, CurrencyObj)}}</td>
													{% set DrAmount = Dict.DrAmount + t.Data[c].DrAmount|float %}
													{% set CrAmount = Dict.CrAmount + t.Data[c].CrAmount|float %}
													{% if Dict.update({'DrAmount': DrAmount, 'CrAmount': CrAmount }) %}{% endif %}
												{% else %}
													<td class="text-right">{{ZeroBalance}}</td>
													<td class="text-right">{{ZeroBalance}}</td>
												{% endif %}

											{% else %}
												<td class="text-right">{{ZeroBalance}}</td>
												<td class="text-right">{{ZeroBalance}}</td>
											{% endif %}
										</tr>
									{% endfor %}
									<tr>
										<td class="text-right">Total</td>
										<td class="text-right">{{mktmoney.toMoney(Dict.DrAmount, CurrencyObj)}}</td>
										<td class="text-right">{{mktmoney.toMoney(Dict.CrAmount, CurrencyObj)}}</td>
									</tr>
								</tbody>
							</table>

							<div class="row">
								<div class="col-sm-12 text-right">
									<div class="row">
										<div class="col-sm-7"><strong>OPENING BALANCE {{c}}</strong></div>
										<div class="col-sm-5">
											{% if c in OpeningBal %}
												{{mktmoney.toMoney(OpeningBal[c].Amount, CurrencyObj)}}
											{% else %}
												{{mktmoney.toMoney(0, CurrencyObj)}}
											{% endif %}
										</div>
									</div>
										
									<div class="row">
										<div class="col-sm-7">ADD CASH IN</div>
										<div class="col-sm-5">{{mktmoney.toMoney(Dict.DrAmount, CurrencyObj)}}</div>
									</div>
									<div class="row">
										<div class="col-sm-7">LESS CASH OUT</div>
										<div class="col-sm-5">{{mktmoney.toMoney(Dict.CrAmount, CurrencyObj)}}</div>
									</div>
									<div class="row">
										<div class="col-sm-7"><strong>CLOSING BALANCE {{c}}</strong></div>
										<div class="col-sm-5">
											{% if c in ClosingBal %}
												{{mktmoney.toMoney(ClosingBal[c].Amount, CurrencyObj)}}
											{% else %}
												{{mktmoney.toMoney(0, CurrencyObj)}}
											{% endif %}
										</div>
									</div>
								</div>
							</div>
									
						</div>

					{% endfor %}
				</div>
				<!-- {{OpeningBal}}={{ClosingBal}} -->
				<div class="row">
					<div class="col-sm-12">
						<h3 class="head-line">II. ACTUAL CASH</h3>
					</div>
						
					<div class="col-sm-6">
						<table class="table table-bordered table-condensed">
							<thead style="text-align:center;">
								<tr>
									<th colspan="3">USD CURRENCY</th>
								</tr>
								<tr>
									<th>Denomination</th>
									<th>Quantity</th>
									<th>Amount</th>
								</tr>
							</thead>
							<tbody>
								<tr><td class="text-center">100</td><td></td><td></td></tr>
								<tr><td class="text-center">50</td><td></td><td></td></tr>
								<tr><td class="text-center">20</td><td></td><td></td></tr>
								<tr><td class="text-center">10</td><td></td><td></td></tr>
								<tr><td class="text-center">5</td><td></td><td></td></tr>
								<tr><td class="text-center">2</td><td></td><td></td></tr>
								<tr><td class="text-center">1</td><td></td><td></td></tr>
								<tr><td class="text-center">Cents</td><td></td><td></td></tr>
								<tr><td class="text-right" colspan="2">Total<td></td></tr>
							</tbody>
						</table>
					</div>

					<div class="col-sm-6">
						<table class="table table-bordered table-condensed">
							<thead style="text-align:center;">
								<tr>
									<th colspan="3">KHR CURRENCY</th>
								</tr>
								<tr>
									<th>Denomination</th>
									<th>Quantity</th>
									<th>Amount</th>
								</tr>
							</thead>
							<tbody>
								<tr><td class="text-right">100000</td><td></td><td></td></tr>
								<tr><td class="text-right">50000</td><td></td><td></td></tr>
								<tr><td class="text-right">20000</td><td></td><td></td></tr>
								<tr><td class="text-right">10000</td><td></td><td></td></tr>
								<tr><td class="text-right">5000</td><td></td><td></td></tr>
								<tr><td class="text-right">2000</td><td></td><td></td></tr>
								<tr><td class="text-right">1000</td><td></td><td></td></tr>
								<tr><td class="text-right">500</td><td></td><td></td></tr>
								<tr><td class="text-right">200</td><td></td><td></td></tr>
								<tr><td class="text-right">100</td><td></td><td></td></tr>
								<tr><td class="text-right" colspan="2">Total<td></td></tr>
							</tbody>
						</table>
					</div>

				</div>

				<div class="row">
					<div class="col-sm-4 text-center">Checked by:</div>
					<div class="col-sm-4 text-center">Concurred by:</div>
					<div class="col-sm-4 text-center">Authorized by:</div>
				</div>

			</section>
					
		</div>
	</div>
</div>

<div class="modal fade" id="getCustomRange" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<form class="form-horizontal" method="GET">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="exampleModalLabel">Custom</h4>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label for="Branch" class="col-sm-4 control-label">Branch:</label>
							<div class="col-sm-8">
								<input name="Branch" value="{{ Branch }}" class="input-sm form-control" style="width: 100%;">
							</div>
						</div>

						<div class="form-group">
							<label for="Date" class="col-sm-4 control-label">Date:</label>
							<div class="col-sm-8">
								<input class="input-sm form-control" type="text" name="Date" id="Date" value="{{ Date }}" style="width: 100%;">
							</div>
						</div>
						
					</div>
					<div class="modal-footer">
						<button type="submit" class="btn btn-primary" id="Apply">Apply</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
					</div>
				</form>
			</div>
		</div>
	</div>

{% endblock %}

{% block js %}

	{% from "print.html" import exportIncludeJS %}
	{{exportIncludeJS()}}

	<script type="text/javascript">
		
		$(document).ready(function() {

			{% from "print.html" import exportDataTable %}
			{{exportDataTable("#mktlist",TemplateTitle ,PrintingDate=False)}}

			init.push(function () {
				var options = {
					orientation: $('body').hasClass('right-to-left') ? "auto right" : 'auto auto',
					format:"yyyy-mm-dd",
					autoclose:true
				}
				$('#Date').datepicker(options);
			});

		})            
	</script>
{% endblock %}
