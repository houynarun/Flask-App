from app.mktcore.imports 		import *
from app.tools.mktcustomreport   import *

class FRM_CUSTOM_REPORT_SEARCH_EX(FRM_CUSTOM_REPORT_SEARCH):
	Branch 			=	TextField("Branch")

@app.route('/Morakot/Report/FF/ClientSurvey', methods=['GET'])
@checkLogOutSession
@checkLogOutTime
def getClientSurvey():
	"""
	<ByCategory> : LoanProduct, CRO, CC

	"""
	try:
		ErrorMsg    = []
		DefualtUrl 	= CUSTOM_REPORT.getDefaultReportUrl(CurrentUrl=url_for(request.endpoint))
		getCheck    = checkAccess(DefualtUrl,"Search")
		if getCheck != True: 
			ErrorMsg.append(msg_error+msg_permission)
			return render_template("permission.html",ErrorMsg=ErrorMsg)

		''' Setup parameters '''
		# SystemBankDate 	= 	str(mktdate.getBankDate())
		Branch 			=	request.args.get("Branch") if "Branch" in request.args else mktuser.getCurrentBranch()
		CustomerID 		= 	request.args.get("CustomerID")
		# ReportedDate 	= 	request.args.get("ReportedDate") if "ReportedDate" in request.args else SystemBankDate
		Result 			=	getReport01(Branch=Branch,CustomerID=CustomerID)
		Parameters 		= 	{"Branch": Branch}
		FilterOption 	=	""

		SearchForm 		= 	FRM_CUSTOM_REPORT_SEARCH_EX()

		return CUSTOM_REPORT.getCustomReportTemplate(Parameters		=	Parameters,
													Result 			=	Result,
													FilterOption 	=	FilterOption,
													SearchForm 		=	SearchForm)
	except:
		raise