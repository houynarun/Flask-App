{% extends "layout.html" %}

{% block css %}
<style type="text/css">
.table-borderless td,
.table-borderless th
{
	border: 0 !important;
	padding-top: 3px !important;
	font-size: 14px;
}
th.table-header{
	border-bottom: 2px solid #ccc !important;
}
 h3.header-3{
            color: #888 !important;
            font-size: 16px;
            font-weight: bold;
            margin: 5px 0 10px;
            padding: 10px 18px 0;
        }

        h4.header-4{
            color: #888 !important;
            font-size: 14px;
            font-weight: normal;
            margin: 5px 0 10px;
            padding: 0px 18px 0;
        }
        #Main {
          width: 1px;
          min-width: 100%;
          *width: 100%;
        }
        .panel {
          width: 100%;
        }
</style>
{% endblock %}


{% block content %}
<script src="{{ url_for('static',filename='javascripts/jquery.datatables.min.js') }}"></script>
<script src="{{ url_for('static',filename='js/dataTables.tableTools.js') }}"></script>

<!-- <link rel=stylesheet type=text/css href="{{ url_for('static', filename='stylesheets/jquery.datatables.css') }}">
 -->
 <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.bootstrap.min.css">
 <link rel=stylesheet type=text/css href="{{ url_for('static', filename='stylesheets/dataTables.tableTools.css') }}">
 <script src="{{ url_for('static',filename='javascripts/dataTables.responsive.min.js') }}"></script>
 <div id="Main">
<form method="GET" id="frm" name="frm" role="form" >
<!-- Modal -->
<div id="myModal" class="modal fade" tabindex="-1" role="dialog" style="display: none;">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
				<h4 class="modal-title" id="myModalLabel">Custom</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label for="Branch" class="col-sm-3 control-label"> Show from Branch: {{Result['Branch']}} </label>
					<div class="col-sm-5">
						<select class="form-control" id="Branch" name="Branch" style="width:100%;">
							<optgroup label="Branch">
								{%for row in BranchObj %}
								<option value="{{row.ID}}"> {{row.ID}} - {{row.Description}} </option> 
								{%endfor%}
							 </optgroup>
						</select>
						<script type="text/javascript">
							init.push(function () {
								// Single select
								$("#Branch").val('{{Result["Branch"]}}');
								$("#Branch").select2({
									allowClear: true,
									placeholder: "Choose Branch"
								});

							});
						</script>
					</div>
				</div>
				<div class="form-group">
					<label for="CRO" class="col-sm-3 control-label"> Show from CRO: </label>
					<div class="col-sm-5">
						<select class="form-control" id="CRO" name="CRO" style="width:100%;">
							<optgroup label="CRO">
								{%for row in CROObj %}
								<option value="{{row.ID}}"> {{row.ID}} - {{row.LastName}} {{row.FirstName}} </option> 
								{%endfor%}
							 </optgroup>
						</select>
						<script type="text/javascript">
							init.push(function () {
								// Single select
								$("#CRO").val('{{ Result["CRO"] }}');
								$("#CRO").select2({
									allowClear: true,
									placeholder: "Choose CRO"
								});
							});
						</script>
					</div>
				</div>
			</div> <!-- / .modal-body -->
			<div class="modal-footer">
				
				<button type="submit" class="btn btn-primary">{{ getLanguage('Apply') }}</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">{{ getLanguage('Cancel') }}</button>
			</div>
		</div> <!-- / .modal-content -->
	</div> <!-- / .modal-dialog -->
</div> <!-- /.modal -->
<!-- / Modal -->
</form>
	<div class="navbar navbar-default navbar-static-top">
		<div class="col-sm-6" style="margin-top: 15px;">
			<!-- Button Export -->
			{% from "print.html" import exportButtonLink %}
			{{exportButtonLink()}}
		</div>
		<div class="col-sm-6" style="margin-top: 8px;">
			<a href="javascript:void(0)" title="Refresh" id="Refresh" class="btn btn-flat btn-labeled btn-warning pull-right" style="margin-left: 5px;">
				<span class="btn-label icon fa fa-refresh"></span> Refresh
			</a>
			<button  type="button" data-toggle="modal" data-target="#myModal"  class="btn btn-flat btn-labeled btn-success pull-right" >
				<span class="btn-label icon fa fa-gear" ></span> Custom 
			</button>
		</div>
	</div>
	<!--  message  -->
	<div class="clearfix"></div>
	<div class="col-sm-12">
		{% for message in get_flashed_messages() %}
			{% if contain(message, "Error") %}
				<div class="clearfix">&nbsp;</div>
				<div class="alert alert-danger">
					<button type="button" class="close" data-dismiss="alert">&times;</button>
					{{ message }}
				</div>
			{% else %}
				<div class="clearfix">&nbsp;</div>
				<div class="alert alert-info">
					<button type="button" class="close" data-dismiss="alert">&times;</button>
					{{ message }}
				</div>
			{% endif %}
		{% endfor %}
	</div>

	<div style="margin-left:10%; margin-right:10%;">
		<h3 class="header-3 text-center">{{ Result['Company'] }}</h3>
		<h4 class="header-4 text-center">Loan Contract Detail Listing</h4>
		<h4 class="header-4 text-center"><strong>As of:</strong> {{ Result['BankDate'] }}</h4>
		<h4 class="header-4 text-center"><strong>Currency:</strong> {{ Result['BaseCurrency'] }}</h4>
		<h4 class="header-4 text-center"><strong>Branch:</strong> {{ Result['Branch'] }}</h4>
		{% if Result["CRO"] %}
			<h4 class="header-4 text-center"><strong>CRO:</strong> {{ Result['CRO'] }}</h4>
		{% endif %}
	</div>
	<div class="clearfix">&nbsp;</div>

<div class="row">
	<div class="col-xs-12">
		<table id="mktlist" class="table table-striped table-borderless" cellspacing="0" width="100%">
			<thead>
				<tr>
					<th>Branch</th>
					<th>ID</th>
					<th>CustomerID</th>
					<th>Name</th>
					<th>Gender</th>
					<th>Account #</th>
					<th>Currency</th>
					<th>Disbursed</th>
					<th>Commitment</th>
					<th>Outstanding</th>
					<th>Intereest Earned</th>
					<th>Value Date</th>
					<th>Maturity Date</th>
					<th>Loan Product</th>
					<th>Term</th>
					<th>Interest Rate</th>
					<th>Status</th>
					<th>Asset Class</th>
					<th>Sector</th>
					<th>CRO ID</th>
					<th>CRO Name</th>
				</tr>
			</thead>
			<tbody>
				{% for key, value in ReportDict.iteritems() %}
					<tr>
						<td>{{value.Branch}}</td>
						<td>{{key}}</td>
						<td>{{value.CustomerID}}</td>
						<td>{{value.CustomerName}}</td>
						<td>{{value.Gender}}</td>
						<td>{{value.Account}}</td>
						<td>{{value.Currency}}</td>
						<td>{{value.Disbursed}}</td>
						<td>{{value.Commiment}}</td>
						<td>{{value.Outstanding}}</td>
						<td>{{value.InterestEarned}}</td>
						<td>{{value.ValueDate}}</td>
						<td>{{value.MaturityDate}}</td>
						<td>{{value.LoanProduct}}</td>
						<td>{{value.Term}}</td>
						<td>{{value.InterestRate}}</td>
						<td>{{value.DisbursedStat}}</td>
						<td>{{value.AssetClass}}</td>
						<td>{{value.Sector}}</td>
						<td>{{value.CRO}}</td>
						<td>{{value.CROName}}</td>
					</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				{% set result = Result['Total']%}
				<tr>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td><b>{{result['TotalDisbursed']}}</b></td>
					<td><b>{{result['TotalCommiment']}}</b></td>
					<td><b>{{result['TotalOutstanding']}}</b></td>
					<td><b>{{result['TotalInterestEarned']}}</b></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
			</tfoot>
		</table>
	</div>
</div>
</div>
{% endblock %}

{% block js %}
	{% from "print.html" import exportIncludeJS %}
	{{exportIncludeJS()}}

    {# <script src="{{ url_for('static',filename='javascripts/jquery.datatables.min.js') }}"></script> #}
    <script type="text/javascript">
        //Search dataTable
        $(document).ready(function() {
	        $('#mktlist').dataTable({
	        	responsive		: true,
	            "lengthMenu"    : [[25,50,100,200, -1], [25,50,100,200, "All"]],
	            "bSort"         : true,
	            "pageLength"    : 25,
	        });
	        $("#Refresh").click(function() {
	            fn_fadeIn();
	            window.location.reload(true);
	        });
	        {% from "print.html" import exportDataTable %}
            {{exportDataTable('#mktlist','Loan Contract Detail Listing')}}
	    });
    </script>
{% endblock %}