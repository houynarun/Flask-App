from app.ChargeRate.forms 				import *
from app.Transaction.models				import *
import app.tools.mktteller				as mktteller

def loadTransaction():
	return MKT_TRANSACTION.query

class FRM_CHARGE_RATE_EX(FRM_CHARGE_RATE):
	PromotionCat 		=	QuerySelectField("Promotion Category",
							query_factory=loadCategory,
							get_label=lambda a: a.ID + " - " + a.Description,
							allow_blank=True,
							blank_text=u'--None--'
						)

	PromotionTran 	 	=	QuerySelectField("Promotion Transaction",
							query_factory=loadTransaction,
							get_label=lambda a: a.ID + " - " + a.Description,
							allow_blank=True,
							blank_text=u'--None--'
						)

	PromotionRevTran	=	QuerySelectField("Promotion Rev. Transaction",
							query_factory=loadTransaction,
							get_label=lambda a: a.ID + " - " + a.Description,
							allow_blank=True,
							blank_text=u'--None--'
						)

	def validate_PromotionCat(form, field):
		PromotionCat = request.form['PromotionCat']
		if mktteller.isCashCateogry(PromotionCat):
			raise ValidationError("Cash Category are not allow.")