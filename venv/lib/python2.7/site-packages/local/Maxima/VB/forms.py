from app.VB.forms 			import *
import app.tools.mktdate 		as mktdate

class FRM_VB_EX(FRM_VB):
	Description 	= TextField(requiredlabel("Description", "*"))
	COID 			= TextField(requiredlabel("CO ID", "*"),
								validators=[validators.Required()])
	Coordinator 	= TextField(requiredlabel("CO Name", "*"),
								validators=[validators.Required()])
	KHName 			= TextField("Khmer Name")
	Telephone 		= TextField("Phone")
	ServiceOfficer 	= TextField("Service Officer")
	VBProvince 		= QuerySelectField(requiredlabel('Province', "*"),
		                        query_factory=loadProvince,
		                        get_label=u'Description',
		                        allow_blank=True,
		                        blank_text=u'--Choose Province--',
		                        validators=[validators.Required()])

	VBDistrict 		= QuerySelectField(requiredlabel('District','*'),
		                        query_factory=loadDistrict,
		                        get_label=u'Description',
		                        allow_blank=True,
		                        blank_text=u'--Choose District--',
		                        validators=[validators.Required()])

	VBCommune 		= QuerySelectField(requiredlabel('Commune','*'),
		                        query_factory=loadCommune,
		                        get_label=u'Description',
		                        allow_blank=True,
		                        blank_text=u'--Choose Commune--',
		                        validators=[validators.Required()])

	VBVillage 		= QuerySelectField(requiredlabel('Village','*'),
		                        query_factory=loadVillage,
		                        get_label=u'Description',
		                        allow_blank=True,
		                        blank_text=u'--Choose Village--',
		                        validators=[validators.Required()])

	Active 			= SelectField(choices=[('1','Active'),('0','Inactive')])


	def validate_Telephone(form, field):
		PhoneNumber = form.Telephone.data
		if PhoneNumber:
			if len(PhoneNumber) < 3:
				raise ValidationError("Invalid mobile phone number. Ex: 012xxxxxx")
			CheckMobileNumber, Msg = mkttool.isMobile(PhoneNumber)
			if not CheckMobileNumber:
				raise ValidationError(Msg)


	@staticmethod
	def setVisible():
		MainObj = super(FRM_VB_EX, FRM_VB_EX).setVisible()
		Field = ['Description']
		MainObj.extend(Field)
		
		return MainObj
