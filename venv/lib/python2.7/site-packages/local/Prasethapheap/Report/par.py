from app.mktcore.imports 			import *
from app.tools.mktcustomreport		import *
import app.tools.mktdate		as mktdate

class FRM_CUSTOM_REPORT_SEARCH_EX(FRM_CUSTOM_REPORT_SEARCH):
	Branch 			=   TextField("Branch")
	ReportedDate 	=	DateTextField("Reported Date")
@app.route('/Morakot/Report/Prasethapheap/Par', methods=['GET'])
@checkLogOutSession
@checkLogOutTime
def getPar():
	""" Route to view each report """
	try:		
		ErrorMsg    = []
		DefualtUrl 	= CUSTOM_REPORT.getDefaultReportUrl(CurrentUrl=url_for(request.endpoint))
		getCheck    = checkAccess(DefualtUrl,"Search")
		if getCheck != True: 
			ErrorMsg.append(msg_error+msg_permission)
			return render_template("permission.html",ErrorMsg=ErrorMsg)

		''' Setup parameters '''
		Branch 			=	request.args.get("Branch") if "Branch" in request.args else ""
		ReportedDate 	=	request.args.get("ReportedDate") if "ReportedDate" in request.args else ""
		Result 			=	getParReport(Branch=Branch,ReportedDate=ReportedDate)
		Parameters 		= 	{"Branch": Branch,"ReportedDate":ReportedDate}
		FilterOption 	=	""

		SearchForm      =   FRM_CUSTOM_REPORT_SEARCH_EX()

		return CUSTOM_REPORT.getCustomReportTemplate(Parameters     =   Parameters,
													Result          =   Result,
													FilterOption    =   FilterOption,
													SearchForm      =   SearchForm
													)	
	except:
		raise

@app.route('/Morakot/Report/Prasethapheap/Par/Excel', methods=['GET'])
@checkLogOutSession
@checkLogOutTime
def getParExport():
	""" Route to view each report """
	try:
		Branch 			=	request.args.get("Branch") if "Branch" in request.args else "" 
		ReportedDate 	=	request.args.get("ReportedDate") if "ReportedDate" in request.args else "" 
		Result 			=	[]
		response 		= 	CUSTOM_REPORT.exportExcel(Result=Result,FileName="ClosedLoansReport")

		return response

	except Exception as e:
		raise

def getParReport(**kwargs):
	try:
		Branch 			= 	kwargs.get("Branch")
		ReportedDate 	= 	kwargs.get("ReportedDate")
		ReportHeader 	=	CUSTOM_REPORT.getReportHeader()
		ReportHeader.update({"ReportTitle": "Par Report"})
		ReportHeader.update({"Parameters": kwargs})

		Data 		= []
		TableHeader = {}

		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'No', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="A")

		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Province', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="B")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="C")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Portfolio at risk', 
											Rowspan=0,Colspan=4,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="D")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Male', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="H")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Female', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="J")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Group by Clients ', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="L")

		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Individual by Client ', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="N")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Balloon by clients ', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="P")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Declining by clients', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="R")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Sector by clients', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="T")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Product by clients ', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="V")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Arban by clients', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="X")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Semi-Arban by clients', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="Z")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Rural by clients', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="AB")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Remote by clients', 
											Rowspan=0,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center",ExcelCol="AD")


		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="A")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'by Branch', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="B")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'by Currency', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="C")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="D")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'#', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="E")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'Amount', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="F")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'%', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="G")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD ', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="H")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="I")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="J")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="K")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="L")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="M")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="N")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="O")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="P")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="Q")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="R")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="S")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="T")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="U")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD ', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="V")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="W")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="X")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="Y")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="Z")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="AA")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="AB")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="AC")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'USD', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="AD")
		TableHeader = CUSTOM_REPORT.setTableHeader(Text=u'KHR', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center",ExcelCol="AE")

		Data = getRecordRow(**kwargs)

		Result = {'ReportHeader': ReportHeader, 'TableHeader': TableHeader, 'Data':Data }

		return Result
	except:
		raise

# def getAllClosedLoan(**kwargs):
# 	Branch 			 = 	kwargs.get("Branch")
# 	OfficerID 		 = 	kwargs.get("OfficerID")
# 	ProductID 		 = 	kwargs.get("ProductID")
# 	ValueDate 		 =	kwargs.get("ValueDate")
# 	CloseDate 		 = 	kwargs.get("CloseDate")

# 	ClosedLoanObj	 = 	db.session.query(MKT_CLOSED_LOAN.Branch,
# 									   MKT_CLOSED_LOAN.ContractCustomerID,
# 									   MKT_CLOSED_LOAN.Account,
# 									   MKT_CLOSED_LOAN.ID,
# 									   MKT_CLOSED_LOAN.ContractOfficerID,
# 									   MKT_CLOSED_LOAN.LoanProduct,
# 									   MKT_CLOSED_LOAN.ValueDate,
# 									   MKT_CLOSED_LOAN.MaturityDate,
# 									   MKT_CLOSED_LOAN.Term,
# 									   MKT_CLOSED_LOAN.ApprovedAmount,
# 									   MKT_CLOSED_LOAN.Disbursed,
# 									   MKT_CLOSED_LOAN.InterestRate,
# 									   MKT_CLOSED_LOAN.IRR,
# 									   MKT_CLOSED_LOAN.Currency,
# 									   MKT_CLOSED_LOAN.Installment,
# 									   MKT_LOAN_AMENDMENT.WaiveInterest,
# 									   MKT_LOAN_AMENDMENT.Operation,
# 									   MKT_LOAN_AMENDMENT.AmendDate).\
# 									   join(MKT_LOAN_AMENDMENT,MKT_LOAN_AMENDMENT.LoanID==MKT_CLOSED_LOAN.ID).\
# 									   filter(MKT_LOAN_AMENDMENT.Operation=='TMN').\
# 									   order_by(MKT_CLOSED_LOAN.ID)
# 	if Branch:
# 		Branch = Branch.split()
# 		ClosedLoanObj	 	= ClosedLoanObj if 'ALL' in Branch else ClosedLoanObj.\
# 							 				filter(MKT_CLOSED_LOAN.Branch.in_(Branch))
# 	if OfficerID:
# 		ClosedLoanObj	 	= ClosedLoanObj.filter(MKT_CLOSED_LOAN.ContractOfficerID==OfficerID)
# 	if ProductID:
# 		ClosedLoanObj	 	= ClosedLoanObj.filter(MKT_CLOSED_LOAN.LoanProduct==ProductID)
# 	if ValueDate:
# 		ValueDate = ValueDate.split()
# 		if len(ValueDate)==2:
# 			ClosedLoanObj 	= 	ClosedLoanObj.filter(MKT_CLOSED_LOAN.ValueDate>=ValueDate[0],
# 												   		   MKT_CLOSED_LOAN.ValueDate<=ValueDate[1])
# 		else:
# 			ClosedLoanObj 	= 	ClosedLoanObj.filter(MKT_CLOSED_LOAN.ValueDate.in_(ValueDate))
# 	if CloseDate:
# 		CloseDate 	= CloseDate.split()
# 		if len(CloseDate)==2:
#     			ClosedLoanObj 	= 	ClosedLoanObj.filter(or_(MKT_CLOSED_LOAN.MaturityDate>=CloseDate[0],MKT_LOAN_AMENDMENT.AmendDate>=CloseDate[0]),
# 												   		   or_(MKT_CLOSED_LOAN.MaturityDate<=CloseDate[1],MKT_LOAN_AMENDMENT.AmendDate<=CloseDate[1]))
# 		else:
# 			ClosedLoanObj 	= 	ClosedLoanObj.filter(or_(MKT_CLOSED_LOAN.MaturityDate.in_(CloseDate),MKT_LOAN_AMENDMENT.AmendDate.in_(CloseDate)))
# 	return ClosedLoanObj

def getRecordRow(**kwargs):
	Branch 			= 	kwargs.get("Branch")
	ProductName 	= ""
	RecordRow = []
	ListHistID=[]
	ValueList 		= 	["100$-1,000$","1,001$-5,000$","5,001$-10,000$","10,001$-50,000$"]
	ValueList1 		= 	["100$-1,000$","1,001$-5,000$","5,001$-10,000$","10,001$-50,000$"]
	ValueList2 		= 	["100$-1,000$","1,001$-5,000$","5,001$-10,000$","10,001$-50,000$"]
	ValueList3 		= 	["100$-1,000$","1,001$-5,000$","5,001$-10,000$","10,001$-50,000$"]
	# if isFirstLoaded(**kwargs):
				# RecordRow.append(({1: {"Value":},
				# 				   2: {"Value":Loan.ContractOfficerID},
				# 				   3: {"Value":Loan.ContractCustomerID},
				# 				   4: {"Value":Loan.Account},
				# 				   5: {"Value":Loan.ID},
				# 				   6: {"Value":Loan.LoanProduct},
				# 				   7: {"Value":ProductName},
				# 				   8: {"Value":Loan.ValueDate},
				# 				   9: {"Value":Loan.MaturityDate},
				# 				  10: {"Value":mktmoney.toMoney(float(Loan.Disbursed),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				  11: {"Value":Loan.Term},
				# 				  12: {"Value":Loan.InterestRate},
				# 				  13: {"Value":Loan.IRR},
				# 				  14: {"Value":Loan.Installment},
				# 				  15: {"Value":Schedule if Loan.Operation=='TMN' else Loan.Installment},
				# 				  16: {"Value":Loan.AmendDate if Loan.Operation=='TMN' else Loan.MaturityDate},
				# 				  17: {"Value":Loan.WaiveInterest if Loan.WaiveInterest else 0},
				# 				  18: {"Value":mktmoney.toMoney(float(PenaltyLate),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				  19: {"Value":mktmoney.toMoney(float(PenaltyTerminate),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				  20: {"Value":mktmoney.toMoney(float(ChargPaid),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				  21: {"Value":mktmoney.toMoney(float(InterestPaid),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				  22: {"Value":mktmoney.toMoney(float(PrincipalPaid),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				  23: {"Value":mktmoney.toMoney(float(TotalPaid),mktmoney.getCurrencyObj(Loan.Currency))},
				# 				 },{"Class":"text-right","Style":""}))  
	for row in ValueList:
		RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":row},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":""},
									   7: {"Value":""},
									   8: {"Value":""},
									   9: {"Value":""},
									  10: {"Value":""},
									  11: {"Value":""},
									  12: {"Value":""},
									  13: {"Value":""},
									  14: {"Value":""},
									  15: {"Value":""},
									  16: {"Value":""},
									  17: {"Value":""},
									  18: {"Value":""},
									  19: {"Value":""},
									  20: {"Value":""},
									  21: {"Value":""},
									  22: {"Value":""},
									  23: {"Value":""},
									  24: {"Value":""},
									  25: {"Value":""},
									  26: {"Value":""},
									  27: {"Value":""},
									  28: {"Value":""},
									  29: {"Value":""},
									  30: {"Value":""},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""})) 
	RecordRow.append(({1: {"Value":"No"},
									   2: {"Value":"District"},
									   3: {"Value":""},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":"Portfolio at risk"},
									   7: {"Value":""},
									   8: {"Value":"Male"},
									   9: {"Value":""},
									  10: {"Value":"Female"},
									  11: {"Value":""},
									  12: {"Value":"Group by Clients"},
									  13: {"Value":""},
									  14: {"Value":"Individual by Client"},
									  15: {"Value":""},
									  16: {"Value":"Balloon by Clients"},
									  17: {"Value":""},
									  18: {"Value":"Declining by clients"},
									  19: {"Value":""},
									  20: {"Value":"Sector by clients"},
									  21: {"Value":""},
									  22: {"Value":"Product by clients"},
									  23: {"Value":""},
									  24: {"Value":"Arban by clients"},
									  25: {"Value":""},
									  26: {"Value":"Semi-Arban by clients"},
									  27: {"Value":""},
									  28: {"Value":"Rural by clients"},
									  29: {"Value":""},
									  30: {"Value":"Remote by clients"},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""}))
	RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":"by Currency"},
									   4: {"Value":""},
									   5: {"Value":"#"},
									   6: {"Value":"Amount"},
									   7: {"Value":"%"},
									   8: {"Value":"USD"},
									   9: {"Value":"KHR"},
									  10: {"Value":"USD"},
									  11: {"Value":"KHR"},
									  12: {"Value":"USD"},
									  13: {"Value":"KHR"},
									  14: {"Value":"USD"},
									  15: {"Value":"KHR"},
									  16: {"Value":"USD"},
									  17: {"Value":"KHR"},
									  18: {"Value":"USD"},
									  19: {"Value":"KHR"},
									  20: {"Value":"USD"},
									  21: {"Value":"KHR"},
									  22: {"Value":"USD"},
									  23: {"Value":"KHR"},
									  24: {"Value":"USD"},
									  25: {"Value":"KHR"},
									  26: {"Value":"USD"},
									  27: {"Value":"KHR"},
									  28: {"Value":"USD"},
									  29: {"Value":"KHR"},
									  30: {"Value":"USD"},
									  31: {"Value":"KHR"},
									 },{"Class":"text-right text-bold","Style":""}))
	for row in ValueList1:
		RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":row},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":""},
									   7: {"Value":""},
									   8: {"Value":""},
									   9: {"Value":""},
									  10: {"Value":""},
									  11: {"Value":""},
									  12: {"Value":""},
									  13: {"Value":""},
									  14: {"Value":""},
									  15: {"Value":""},
									  16: {"Value":""},
									  17: {"Value":""},
									  18: {"Value":""},
									  19: {"Value":""},
									  20: {"Value":""},
									  21: {"Value":""},
									  22: {"Value":""},
									  23: {"Value":""},
									  24: {"Value":""},
									  25: {"Value":""},
									  26: {"Value":""},
									  27: {"Value":""},
									  28: {"Value":""},
									  29: {"Value":""},
									  30: {"Value":""},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""})) 
	RecordRow.append(({1: {"Value":"No"},
									   2: {"Value":"Communce"},
									   3: {"Value":""},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":"Portfolio at risk"},
									   7: {"Value":""},
									   8: {"Value":"Male"},
									   9: {"Value":""},
									  10: {"Value":"Female"},
									  11: {"Value":""},
									  12: {"Value":"Group by Clients"},
									  13: {"Value":""},
									  14: {"Value":"Individual by Client"},
									  15: {"Value":""},
									  16: {"Value":"Balloon by Clients"},
									  17: {"Value":""},
									  18: {"Value":"Declining by clients"},
									  19: {"Value":""},
									  20: {"Value":"Sector by clients"},
									  21: {"Value":""},
									  22: {"Value":"Product by clients"},
									  23: {"Value":""},
									  24: {"Value":"Arban by clients"},
									  25: {"Value":""},
									  26: {"Value":"Semi-Arban by clients"},
									  27: {"Value":""},
									  28: {"Value":"Rural by clients"},
									  29: {"Value":""},
									  30: {"Value":"Remote by clients"},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""}))
	RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":"by Currency"},
									   4: {"Value":""},
									   5: {"Value":"#"},
									   6: {"Value":"Amount"},
									   7: {"Value":"%"},
									   8: {"Value":"USD"},
									   9: {"Value":"KHR"},
									  10: {"Value":"USD"},
									  11: {"Value":"KHR"},
									  12: {"Value":"USD"},
									  13: {"Value":"KHR"},
									  14: {"Value":"USD"},
									  15: {"Value":"KHR"},
									  16: {"Value":"USD"},
									  17: {"Value":"KHR"},
									  18: {"Value":"USD"},
									  19: {"Value":"KHR"},
									  20: {"Value":"USD"},
									  21: {"Value":"KHR"},
									  22: {"Value":"USD"},
									  23: {"Value":"KHR"},
									  24: {"Value":"USD"},
									  25: {"Value":"KHR"},
									  26: {"Value":"USD"},
									  27: {"Value":"KHR"},
									  28: {"Value":"USD"},
									  29: {"Value":"KHR"},
									  30: {"Value":"USD"},
									  31: {"Value":"KHR"},
									 },{"Class":"text-right text-bold","Style":""}))
	for row in ValueList2:
		RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":row},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":""},
									   7: {"Value":""},
									   8: {"Value":""},
									   9: {"Value":""},
									  10: {"Value":""},
									  11: {"Value":""},
									  12: {"Value":""},
									  13: {"Value":""},
									  14: {"Value":""},
									  15: {"Value":""},
									  16: {"Value":""},
									  17: {"Value":""},
									  18: {"Value":""},
									  19: {"Value":""},
									  20: {"Value":""},
									  21: {"Value":""},
									  22: {"Value":""},
									  23: {"Value":""},
									  24: {"Value":""},
									  25: {"Value":""},
									  26: {"Value":""},
									  27: {"Value":""},
									  28: {"Value":""},
									  29: {"Value":""},
									  30: {"Value":""},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""})) 
	RecordRow.append(({1: {"Value":"No"},
									   2: {"Value":"Village"},
									   3: {"Value":""},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":"Portfolio at risk"},
									   7: {"Value":""},
									   8: {"Value":"Male"},
									   9: {"Value":""},
									  10: {"Value":"Female"},
									  11: {"Value":""},
									  12: {"Value":"Group by Clients"},
									  13: {"Value":""},
									  14: {"Value":"Individual by Client"},
									  15: {"Value":""},
									  16: {"Value":"Balloon by Clients"},
									  17: {"Value":""},
									  18: {"Value":"Declining by clients"},
									  19: {"Value":""},
									  20: {"Value":"Sector by clients"},
									  21: {"Value":""},
									  22: {"Value":"Product by clients"},
									  23: {"Value":""},
									  24: {"Value":"Arban by clients"},
									  25: {"Value":""},
									  26: {"Value":"Semi-Arban by clients"},
									  27: {"Value":""},
									  28: {"Value":"Rural by clients"},
									  29: {"Value":""},
									  30: {"Value":"Remote by clients"},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""}))
	RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":"by Currency"},
									   4: {"Value":""},
									   5: {"Value":"#"},
									   6: {"Value":"Amount"},
									   7: {"Value":"%"},
									   8: {"Value":"USD"},
									   9: {"Value":"KHR"},
									  10: {"Value":"USD"},
									  11: {"Value":"KHR"},
									  12: {"Value":"USD"},
									  13: {"Value":"KHR"},
									  14: {"Value":"USD"},
									  15: {"Value":"KHR"},
									  16: {"Value":"USD"},
									  17: {"Value":"KHR"},
									  18: {"Value":"USD"},
									  19: {"Value":"KHR"},
									  20: {"Value":"USD"},
									  21: {"Value":"KHR"},
									  22: {"Value":"USD"},
									  23: {"Value":"KHR"},
									  24: {"Value":"USD"},
									  25: {"Value":"KHR"},
									  26: {"Value":"USD"},
									  27: {"Value":"KHR"},
									  28: {"Value":"USD"},
									  29: {"Value":"KHR"},
									  30: {"Value":"USD"},
									  31: {"Value":"KHR"},
									 },{"Class":"text-right text-bold","Style":""}))
	for row in ValueList3:
		RecordRow.append(({1: {"Value":""},
									   2: {"Value":""},
									   3: {"Value":row},
									   4: {"Value":""},
									   5: {"Value":""},
									   6: {"Value":""},
									   7: {"Value":""},
									   8: {"Value":""},
									   9: {"Value":""},
									  10: {"Value":""},
									  11: {"Value":""},
									  12: {"Value":""},
									  13: {"Value":""},
									  14: {"Value":""},
									  15: {"Value":""},
									  16: {"Value":""},
									  17: {"Value":""},
									  18: {"Value":""},
									  19: {"Value":""},
									  20: {"Value":""},
									  21: {"Value":""},
									  22: {"Value":""},
									  23: {"Value":""},
									  24: {"Value":""},
									  25: {"Value":""},
									  26: {"Value":""},
									  27: {"Value":""},
									  28: {"Value":""},
									  29: {"Value":""},
									  30: {"Value":""},
									  31: {"Value":""},
									 },{"Class":"text-right text-bold","Style":""})) 
	return RecordRow
def isFirstLoaded(**kwargs):
	# If it is first loanded, the bellow variables will None
	Branch 			= kwargs.get("Branch")
	ReportedDate 	= kwargs.get("ReportedDate")

	if (Branch,ReportedDate) not in ['', None]:
		return True
	return False




