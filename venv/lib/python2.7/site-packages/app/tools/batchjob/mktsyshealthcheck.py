from 	SystemHealthCheck 				import 	*
from 	app.SystemHealthCheck.models 	import 	*
from 	app 							import 	app,db
import 	time, ast


DATE_NOW		= time.strftime('%Y-%m-%d %H:%M:%S')

class SystemHealthCheckProcessor(object):
	def  moveToHIST(self):
		GetAllSystemHealthCheck = 	MKT_SYSTEM_HEALTH_CHECK.query.all()
		if GetAllSystemHealthCheck:
			for Row	in  GetAllSystemHealthCheck:
				SystemHealthCheckHist 	=	MKT_SYSTEM_HEALTH_CHECK_HIST(
												Branch 			= 		"SYS",
												Curr 			=		'0',
												Inputter		=		'System',
												Createdon 		=	 	DATE_NOW,
												Authorizer		=		'System',
												Authorizeon		=	 	DATE_NOW,
												ID 				=		Row.ID,
												ItemName 		=		Row.ItemName,
												Title 			=		Row.Title,
												SystemDate  	= 		Row.SystemDate,
												Status 			=		Row.Status,
												Level 			= 		Row.Level,
												Code 			= 		Row.Code,
												Description 	=		Row.Description,
												ErrorDetail 	= 		Row.ErrorDetail,
												Suggestion 		=		Row.Suggestion
												)
				db.session.add(SystemHealthCheckHist)
			db.session.query(MKT_SYSTEM_HEALTH_CHECK).delete()
			db.session.commit()

	def runAllItems(self):
		SystemHealthCheck = SystemHealthCheckProcessor()
		SystemHealthCheck.moveToHIST()
		for ItemName in Items:
			Object = ItemName()
			Object.process()	

	def runItem(self,ItemNames):
		SystemHealthCheck = SystemHealthCheckProcessor()
		SystemHealthCheck.moveToHIST()
		for ItemName in ItemNames:
			Object = ItemName()
			Object.process()

	def suggestion(self, **kwargs):
		ItemName = kwargs.get('ItemName','')
		Object = eval(ItemName)
		Data = Object.runSuggestSolution(**kwargs)
		return Data