from decimal import *
from app 					import db
from app.Account.models 	import *
from app.AccProduct.models 	import *
from app.Category.models 	import *

import app.tools.mktdate 		as mktdate
import app.tools.saving.mktsaving		as mktsaving 

from app.SavingPlan.models 			import *
def savingCollection(**kwargs):
	'''
		Collect Saving from general account to saving account.	
		============================================================
		Process Flow
		============================================================
			1. Collect PD is exist
			2. Collect saving based on saving plan on collection date
			3. set next run date
	'''

	try:
		print "|===================|"
		print "| Saving Collection |"
		print "|===================|"

		BankDate 	= 	mktdate.getBankDate()
		NextRunDate = 	mktdate.getNextDay(BankDate,1)
		
		mktsaving.setSavingPDCollection()
		mktsaving.setSavingCollection()
		#commit
		db.session.commit()

	except Exception as e:
		db.session.rollback()
		raise