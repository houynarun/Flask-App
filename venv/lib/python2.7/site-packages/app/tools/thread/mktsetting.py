from app.mktcore.wtfimports 	import *
from app.Setting.models 		import MKT_SETTING, MKT_TERM_DEPOSIT_SETTING
from app.Dates.models 			import MKT_DATES
from sqlalchemy 				import or_
from ... 						import app, db, ThreadS

from app.AccSetting.models 		import MKT_ACCOUNTING_SETTING
from app.Category.models 		import MKT_CATEGORY
from app.GL.models 				import MKT_GL_MAPPING
from app.Setting.models 		import MKT_APP_SETTING
import os
import jinja2
import mktdate 		as mktdate
from sqlalchemy 	import create_engine,inspect
import importlib

import app.tools.thread.mktthread as mktthread
from app.tools.mktsetting import ExtendModule,getListOfTable

def getAppSetting(App, Condition=""):
	try:
		ListTable 	= getListOfTable()
		Value 		= 	""
		if 'MKT_APP_SETTING' in ListTable:
			if Condition == "ALL":
				return ThreadS.query(MKT_APP_SETTING)

			else:
				AppSettingObj 	=	ThreadS.query(MKT_APP_SETTING).get(App)
				if AppSettingObj:
					Value = AppSettingObj.Value
		return Value

	except Exception, e:
		raise

def getAccSetting():
	try:

		engine 		= create_engine(app.config['SQLALCHEMY_DATABASE_URI'])
		inspector 	= inspect(engine)
		ListTable 	= []
		
		for table_name in inspector.get_table_names():
			ListTable.append(str(table_name))
		
		Setting = ""

		if 'MKT_ACCOUNTING_SETTING' in ListTable:

			Setting = ThreadS.query(MKT_ACCOUNTING_SETTING).get("SYSTEM")
		engine.session.close()
		return Setting

	except:
		raise