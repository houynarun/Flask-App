from app.mktcore.wtfimports 	import *
from app.mktcore.imports 		import *
from flask 						import flash
from app.TellerParam.models 	import *
from app.PDParameter.models import MKT_PD_PARAM
from app.LoanContract.models import MKT_LOAN_CONTRACT

from sqlalchemy 				import create_engine,inspect
from app import ThreadS

def getTellerParam(ThreadS=ThreadS):
	
	engine 		= create_engine(app.config['SQLALCHEMY_DATABASE_URI'])
	inspector 	= inspect(engine)
	ListTable 	= []
	
	for table_name in inspector.get_table_names():
		ListTable.append(str(table_name))
	
	result=''

	if 'MKT_TELLER_PARAM' in ListTable:

		TellerParam = ThreadS.query(MKT_TELLER_PARAM).get('SYSTEM')

		if TellerParam:

			result = TellerParam
	engine.session.close()
	return result

def getPDParam(LoanProduct="SYSTEM",ThreadS=ThreadS):
	try:
		if LoanProduct != "SYSTEM":
			PD = ThreadS.query(MKT_PD_PARAM).get(LoanProduct)
		else:
			PD = ThreadS.query(MKT_PD_PARAM).get('SYSTEM')

		if not PD:
			PD = ThreadS.query(MKT_PD_PARAM).get('SYSTEM')
			
		return PD

	except Exception, e:
		raise
		return []
