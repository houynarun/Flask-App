'''
SOURCES OF FINANCING
'''

from app.mktcore.imports 		import *
import app.tools.mktdate 			as mktdate
import app.tools.mktsetting 		as mktsetting
import app.tools.mktnbc			as mktnbc
import app.tools.mktmessage 		as mktmessage

@app.route("/Morakot/Report/N015/")
@checkLogOutSession
@checkLogOutTime
def getNBCN015():
	try:
		return ''
	except Exception, e:
		raise e

def getNBC015(Branch="ALL", ReportedDate=""):
	try:
		
		Data 			=	[]
		Language 		=	mktnbc.getDefaultLang()
		CompanyName 	= 	mktnbc.getCompanyName()
		ReportHeader 	=	{
								'ReportName': u'SOURCES OF FINANCING',
								'CompanyName': CompanyName,
								'AsAt': mktdate.toDateShort(ReportedDate, mktmessage.getNBCLang(Language, '110000')),
								'Form': 'N015',
								'Title': u'NATIONAL BANK OF CAMBODIA',
								'ReportingRate': mktnbc.getDisplayReportingRate('', '', 6)
							}

		Result 	=	{
						'ReportHeader'	: ReportHeader,
						'ColumnHeader'	: 'ColumnHeader',
						'Data'			: Data
					}

		return Result

	except Exception, e:
		raise

def getWorksheetN015(workbook, worksheet, Language, Branch="ALL", Period=6, ReportedDate="", GLObj='', GLTable='', Year='', Month='', CYear='', CMonth=''):
	try:
		
		boldcenter = workbook.add_format({'bold': True, 'align': 'center'})
		center 	= 	workbook.add_format({'align': 'center'})
		Data 	=	getNBC015(Branch, ReportedDate)
		Header 	= 	Data['ReportHeader']

		worksheet.merge_range('A2:O2', Header['ReportName'], boldcenter)
		
		worksheet.write('A4',u"%s: %s" %(mktmessage.getNBCLang(Language, '110002').upper(), Header['CompanyName'].upper()))
		worksheet.write('A5',u"%s %s" %(mktmessage.getNBCLang(Language, '110003').upper(), Header['AsAt'].upper()))

		right = workbook.add_format({'align': 'right'})
		row_header_1 = workbook.add_format({
				'font_name':'Arial',
				'align': 'center',
				'valign': 'vcenter',
				'border': 1,
				'text_wrap': True,
				'bg_color':'#CCCCCC'
			})
		worksheet.write('O5', "In million Riels")
		worksheet.merge_range('A7:A9', "No.", row_header_1)
		worksheet.merge_range('B7:B9', "Name of Creditor", row_header_1)
		worksheet.merge_range('C7:C9', "Amount Approved", row_header_1)
		worksheet.merge_range('D7:D9', "Amount Disbursed", row_header_1)
		worksheet.merge_range('E7:E9', "Type of Currencies", row_header_1)
		worksheet.merge_range('F7:J7', "Conditions", row_header_1)
		worksheet.merge_range('K7:N7', "Payment", row_header_1)
		worksheet.merge_range('O7:O9', "Outstanding", row_header_1)

		worksheet.merge_range('F8:F9', "Interest rate", row_header_1)
		worksheet.merge_range('G8:G9', "Term of Payment", row_header_1)
		worksheet.merge_range('H8:H9', "Approved Date", row_header_1)
		worksheet.merge_range('I8:I9', "Maturity Date", row_header_1)
		worksheet.merge_range('J8:J9', "Date", row_header_1)
		worksheet.merge_range('K8:L8', "Principal", row_header_1)
		worksheet.merge_range('M8:N8', "Interest", row_header_1)

		worksheet.write('K9', "Current", row_header_1)
		worksheet.write('L9', "Accumulated", row_header_1)

		worksheet.write('M9', "Current", row_header_1)
		worksheet.write('N9', "Accumulated", row_header_1)

		worksheet.set_column('A:A', 5)
		worksheet.set_column('B:B', 25)
		worksheet.set_column('C:C', 15)
		worksheet.set_column('D:D', 15)
		worksheet.set_column('E:E', 10)
		worksheet.set_column('F:F', 10)
		worksheet.set_column('G:G', 13)
		worksheet.set_column('H:H', 10)
		worksheet.set_column('I:I', 10)
		worksheet.set_column('J:J', 10)
		worksheet.set_column('K:K', 10)
		worksheet.set_column('L:L', 13)
		worksheet.set_column('M:M', 10)
		worksheet.set_column('N:N', 13)
		worksheet.set_column('O:O', 13)

		row = 9
		liststyle    	= workbook.add_format({'border':1,'num_format':'_(* #,##0.#0_);_(* \(#,##0.#0\);_(* "-"??_);_(@_)'})

		for item in range(0, 11):

			worksheet.write(row, 0, '', liststyle)
			worksheet.write(row, 1, '', liststyle)
			worksheet.write(row, 2, '', liststyle)
			worksheet.write(row, 3, '', liststyle)
			worksheet.write(row, 4, '', liststyle)
			worksheet.write(row, 5, '', liststyle)
			worksheet.write(row, 6, '', liststyle)
			worksheet.write(row, 7, '', liststyle)
			worksheet.write(row, 8, '', liststyle)
			worksheet.write(row, 9, '', liststyle)
			worksheet.write(row, 10, '', liststyle)
			worksheet.write(row, 11, '', liststyle)
			worksheet.write(row, 12, '', liststyle)
			worksheet.write(row, 13, '', liststyle)
			worksheet.write(row, 14, '', liststyle)

			row += 1

		row += 1
		liststyle    	= workbook.add_format({'border':1,'num_format':'_(* #,##0.#0_);_(* \(#,##0.#0\);_(* "-"??_);_(@_)', 'bold':True, 'align':'right'})
		worksheet.merge_range('A%s:B%s'%(row, row), 'Total', liststyle)
		row -= 1
		worksheet.write(row, 2, '', liststyle)
		worksheet.write(row, 3, '', liststyle)
		worksheet.write(row, 4, '', liststyle)
		worksheet.write(row, 5, '', liststyle)
		worksheet.write(row, 6, '', liststyle)
		worksheet.write(row, 7, '', liststyle)
		worksheet.write(row, 8, '', liststyle)
		worksheet.write(row, 9, '', liststyle)
		worksheet.write(row, 10, '', liststyle)
		worksheet.write(row, 11, '', liststyle)
		worksheet.write(row, 12, '', liststyle)
		worksheet.write(row, 13, '', liststyle)
		worksheet.write(row, 14, '', liststyle)

		BorderBottom = workbook.add_format({'bottom':True})
		worksheet.write(row+5, 0, u'Name:', BorderBottom)
		worksheet.write(row+6, 0, u'Position:', BorderBottom)
		worksheet.write(row+5, 7, u'Date:', BorderBottom)

	except:
		raise