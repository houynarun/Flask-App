# -*- coding: utf-8 -*-
'''
Report Name: Net Open Position
'''

from app.mktcore.imports 		import *
from app.GLBalance.models 		import MKT_GL_BALANCE, MKT_GL_BALANCE_BACKUP
from app.Currency.models		import MKT_CURRENCY

import app.tools.mktdate 		as mktdate
import app.tools.mktsetting 	as mktsetting
import app.tools.mktmoney 		as mktmoney
import app.tools.mktnbc			as mktnbc
import app.tools.mktgl 			as mktgl
import app.tools.mktmessage 	as mktmessage
import app.NBCReport.V1.N016 					as N016
from .N01 						import *
from decimal 					import Decimal
from .N06 import *
import app.NBCReport.V2.BANK.BankSetting  as NBCBankSetting

def getGLValueForField(Branch = "ALL", Period = 2,NBCBank05Key='', NBCExchangeRateDict={},**Kargs):
	return NBCBankSetting.getGLValueFromField(Branch, Period, "NBCBankN05",NBCBank05Key, NBCExchangeRateDict,**Kargs)


def getBANK05(Branch = "ALL", ReportedDate = "", Period = 2, Month = "", Year = ""):
	''' 
		This function must return result like below:
		Result = {
			'Data': 		Data,
			'Excel': 		Excel,
			'ReportHeader': ReportHeader,
			'TableHeader': 	TableHeader
			}
	'''

	try:
		ID 					= 	"N001" # ID of Report 01 Balance Sheet
		LiabilityEquityLine =	'133' # TOTAL LIABILITIES AND SHAREHOLDER’S EQUITY
		TotalAssetLine 		=	'70' # TOTAL ASSETS
		TotalEquityLine 	=	'123' # Shareholder’s Equities 
		CurrencyObj			=	MKT_CURRENCY.query
		ReadAs = 1000000
		Condition = []
		if Year and Month:
			GLTable   	= MKT_GL_BALANCE_BACKUP
			Condition 	= [GLTable.GLYear == Year,GLTable.GLMonth == Month]
			CYear 	  	= Year
			CMonth 	  	= Month
		else:
			GLTable   	= MKT_GL_BALANCE
			BankDate  	= mktdate.getBankDate()
			CYear 	  	= BankDate.year
			CMonth 	  	= BankDate.month

		GLObj 			= GLTable.query.filter(*Condition)
		Kargs			= {'GLTable':GLTable, 'GLObj':GLObj, 'FCY':True}
		Result 			= {}
		Data 			= []
		Excel 			= {}
		CurrencyDic     =   mktnbc.getNBCExchangeRate(CYear, CMonth)


		LineObj 		=	mktnbc.getNBCLineReport(ID, int(Period), Branch, ReportedDate, Year=Year, Month=Month)[0].get("Data",[])
		DataList 		=	mktnbc.getNBCLineDetail(ID, Branch, Period, GLTable=GLTable, GLObj=GLObj, Year=CYear, Month=CMonth)

		NetWorthN06 	= str(getBANK06("ALL", ReportedDate, Period, Year, Month, True)).replace(',','')
		TotalNetWorth 	=	NetWorthN06 # It should take from Sovency Ratio Report
		TotalNetWorth 	= float(mktmoney.formatNumber(TotalNetWorth,1,2).replace(',',''))

		TotalNetWorth 	= Decimal(mktmoney.formatNumber(TotalNetWorth,1,2).replace(',',''))

		ReportHeader 	= {}
		ReportHeader 	= mktnbc.getHeaderReport(	ReportName 		=	u'MONTHLY REPORT ON SOLVENCY RATIO',
													Title 			=	u'របាយការណ៍ប្រចាំខែស្តីពី អនុបាតសាធនភាព',
													Form 			=	'Solvency Ratio',
													NetWorth 		= 	u'%s' %mktmoney.formatNumber(float(TotalNetWorth), 1, 2)
													)
		
		TableHeader 	= {}
		TableHeader 	= mktnbc.setTableHeader(Text=u'ការគណនាអនុបាតសាធនភាព CALCULATION OF SOLVENCY RATIO', 
                                            Rowspan=1,Colspan=1,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'Balance in USD', 
                                            Rowspan=1,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'ថ្លឹង \n Weighting', 
                                            Rowspan=1,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'ជាដុល្លារ \n in USD', 
                                            Rowspan=1,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'   ជាលានរៀល \n in Million of KHRs', 
                                            Rowspan=1,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'I- ធាតុនៃតារាងតុល្យការដែលថ្លឹងតាមកំរិតហានិភ័យសមភាគី​ \n Balance Sheet Items, weighted by degree of Counter-Party Risks', 
                                            Rowspan=1,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-left")
		
		TableHeader 	= mktnbc.setTableHeader(Text=u'', 
                                            Rowspan=1,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'', 
                                            Rowspan=1,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'', 
                                            Rowspan=1,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'', 
                                            Rowspan=1,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		
		ReportingRate = float(ReportHeader.get('ReportingRate',0))
		Excel.update({
				"A4" : u'As of:  %s'% mktdate.formatDate(ReportedDate,'%d %B %Y'),
				"E5" : ((ReportHeader.get('CompanyName',"")).splitlines())[0],
				"E6" : ((ReportHeader.get('CompanyName',"")).splitlines())[1],
				"H8" : u'%s'%ReportingRate,
				"D8" : u'%s'%TotalNetWorth
			})

		RepRateMil = Decimal(ReadAs / ReportingRate)
		CellRow = 13
		# Block I.1
		CashInHand11 = getGLValueForField(Branch, Period, 'CashInHand11', CurrencyDic, **Kargs)
		CashInHand11 = CashInHand11 * RepRateMil
		CashInHand11 = float(mktmoney.formatNumber(CashInHand11,0))

		GoldInHand12 = getGLValueForField(Branch, Period, 'GoldInHand12', CurrencyDic, **Kargs)
		GoldInHand12 = GoldInHand12 * RepRateMil
		GoldInHand12 = float(mktmoney.formatNumber(GoldInHand12,0))

		ClaimOnNBC13 = getGLValueForField(Branch, Period, 'ClaimOnNBC13', CurrencyDic, **Kargs)
		ClaimOnNBC13 = ClaimOnNBC13 * RepRateMil
		ClaimOnNBC13 = float(mktmoney.formatNumber(ClaimOnNBC13,0))

		DepositWithBank14 = getGLValueForField(Branch, Period, 'DepositWithBank14', CurrencyDic, **Kargs)
		DepositWithBank14 = DepositWithBank14 * RepRateMil
		DepositWithBank14 = float(mktmoney.formatNumber(DepositWithBank14,0))

		GuaranteedAAA15 = getGLValueForField(Branch, Period, 'GuaranteedAAA15', CurrencyDic, **Kargs)
		GuaranteedAAA15 = GuaranteedAAA15 * RepRateMil
		GuaranteedAAA15 = float(mktmoney.formatNumber(GuaranteedAAA15,0))

		TotalI1 = CashInHand11 + GoldInHand12 + ClaimOnNBC13 + DepositWithBank14 + GuaranteedAAA15
		TotalI1 = float(str(mktmoney.formatNumber(TotalI1)).replace(',',''))
		Data.append({
							1:u"1- ការថ្លឹង ០% ចំពោះទ្រព្យសកម្មដែលមានហានិភ័យទាប\n Weighting 0% on Assets with low Risk",
							2:u'%s' %TotalI1,
							3:u'',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})

		Data.append({
							1:u"1.1- សាច់ប្រាក់ Cash",
							2:u'%s' %CashInHand11,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"1.2- មាស Gold",
							2:u'%s' %GoldInHand12,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"1.3- ឥណទេយ្យលើធនាគារជាតិនៃកម្ពុជា\n Claim on the National Bank of Cambodia",
							2:u'%s' %ClaimOnNBC13,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"1.4- ទ្រព្យសកម្មដែលមានវត្ថុបញ្ចាំជាប្រាក់បញ្ញើ 100% នៅធនាគារ\n Assets collaterallized by Deposits 100% lodged with Banks",
							2:u'%s' %DepositWithBank14,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"1.5- ឥណទេយ្យលើ  ឬធានាដោយស្ថាប័នអធិបតេយ្យដែលមានចំណាត់ថ្នាក់ពី​ AAA ទៅ AA-\n Claims on or Guaranteed by Sovereigns rated AAA to AA- or equivalent",
							2:u'%s' %GuaranteedAAA15,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(CashInHand11)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(GoldInHand12)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(ClaimOnNBC13)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(DepositWithBank14)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(GuaranteedAAA15)).replace(',',''))
				})
		CellRow +=2

		# Block I.2
		GuaranteedA21 	= getGLValueForField(Branch, Period, 'GuaranteedA21', CurrencyDic, **Kargs)
		GuaranteedA21 	= GuaranteedA21 * RepRateMil
		GuaranteedA21 	= float(mktmoney.formatNumber(GuaranteedA21,0))

		GuaranteedAAA22 = getGLValueForField(Branch, Period, 'GuaranteedAAA22', CurrencyDic, **Kargs)
		GuaranteedAAA22 = GuaranteedAAA22 * RepRateMil
		GuaranteedAAA22 = float(mktmoney.formatNumber(GuaranteedAAA22,0))

		TotalI2 	= GuaranteedA21 + GuaranteedAAA22
		Weighting20 = 0.2

		GuaranteedAUSD21 	= GuaranteedA21 * Weighting20
		GuaranteedAAAUSD22 	= GuaranteedAAA22 * Weighting20
		TotalUSDI2 			= GuaranteedAUSD21 + GuaranteedAAAUSD22
		TotalUSDI2 			= float(str(mktmoney.formatNumber(TotalUSDI2)).replace(',',''))

		GuaranteedAKHR21 	= GuaranteedAUSD21 * ReportingRate / ReadAs
		GuaranteedAKHR21 = float(str(mktmoney.formatNumber(GuaranteedAKHR21)).replace(',',''))
		GuaranteedAAAKHR22 	= GuaranteedAAAUSD22 * ReportingRate / ReadAs
		GuaranteedAAAKHR22 = float(str(mktmoney.formatNumber(GuaranteedAAAKHR22)).replace(',',''))
		TotalKHRI2 			= GuaranteedAKHR21 + GuaranteedAAAKHR22
		TotalKHRI2 			= float(str(mktmoney.formatNumber(TotalKHRI2)).replace(',',''))


		Data.append({
							1:u"2- ការថ្លឹង ២០% ចំពោះទ្រព្យសកម្មដែលមានហានិភ័យធួនល្មម \nWeighting 20% on Assets with Moderate Risk",
							2:u'%s' %TotalI2,
							3:u'',
							4:u'%s' %TotalUSDI2,
							5:u'%s' %TotalKHRI2,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"2.1- ឥណទេយ្យលើ  ឬធានាដោយស្ថាប័នអធិបតេយ្យដែលមានចំណាត់ថ្នាក់ពី​ A+ ទៅ A- \nClaims on or Guaranteed by Sovereigns rated A+ to A- or equivalent",
							2:u'%s' %GuaranteedA21,
							3:u'%s %s' %(Weighting20*100, '%'),
							4:u'%s' %GuaranteedAUSD21,
							5:u'%s' %GuaranteedAKHR21,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Data.append({
							1:u"2.2- ឥណទេយ្យលើ  ឬធានាដោយធនាគារ ឫក្រុមហ៊ុនដែលមានចំណាត់ថ្នាក់ពី​ AAA ទៅ AA- \nClaims on or Guaranteed by banks rated AAA to AA- or equivalent",
							2:u'%s' %GuaranteedAAA22,
							3:u'%s %s' %(Weighting20*100, '%'),
							4:u'%s' %GuaranteedAAAUSD22,
							5:u'%s' %GuaranteedAAAKHR22,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(GuaranteedA21)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(GuaranteedAAA22)).replace(',',''))
				})
		CellRow += 2

		# Block I.3
		GuaranteedBBB31 = getGLValueForField(Branch, Period, 'GuaranteedBBB31', CurrencyDic, **Kargs)
		GuaranteedBBB31 = GuaranteedBBB31 * RepRateMil
		GuaranteedBBB31 = float(mktmoney.formatNumber(GuaranteedBBB31,0))

		GuaranteedA32 = getGLValueForField(Branch, Period, 'GuaranteedA32', CurrencyDic, **Kargs)
		GuaranteedA32 = GuaranteedA32 * RepRateMil
		GuaranteedA32 = float(mktmoney.formatNumber(GuaranteedA32,0))

		TotalI3 	= GuaranteedBBB31 + GuaranteedBBB31
		Weighting50 = 0.5

		GuaranteedBBBUSD31 	= GuaranteedBBB31 * Weighting50
		GuaranteedAUSD32 	= GuaranteedA32 * Weighting50
		TotalUSDI3 			= GuaranteedBBBUSD31 + GuaranteedAUSD32

		GuaranteedBBBKHR31 	= GuaranteedBBBUSD31 * ReportingRate / ReadAs
		GuaranteedBBBKHR31 = float(str(mktmoney.formatNumber(GuaranteedBBBKHR31)).replace(',',''))
		GuaranteedAKHR32 	= GuaranteedAUSD32 * ReportingRate / ReadAs
		GuaranteedAKHR32 = float(str(mktmoney.formatNumber(GuaranteedAKHR32)).replace(',',''))
		TotalKHRI3 			= GuaranteedBBBKHR31 + GuaranteedAKHR32

		Data.append({
							1:u"3- ការថ្លឹង ៥០% ចំពោះទ្រព្យសកម្មដែលមានហានិភ័យមធ្យម \nWeighting 50% on Assets with Medium Risk",
							2:u'%s' %TotalI3,
							3:u'',
							4:u'%s' %TotalUSDI3,
							5:u'%s' %TotalKHRI3,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})

		Data.append({
							1:u"3.1- ឥណទេយ្យលើ  ឬធានាដោយស្ថាប័នអធិបតេយ្យដែលមានចំណាត់ថ្នាក់ពី​ BBB+ ទៅ BBB- \nClaims on or Guaranteed by Sovereigns rated BBB+ to BBB- or equivalent",
							2:u'%s' %GuaranteedBBB31,
							3:u'%s %s' %(Weighting50*100, '%'),
							4:u'%s' %GuaranteedBBBUSD31,
							5:u'%s' %GuaranteedBBBKHR31,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		Data.append({
							1:u"3.2- ឥណទេយ្យលើ  ឬធានាដោយធនាគារ ឬក្រុមហ៊ុនដែលមានចំណាត់ថ្នាក់ពី​ A+ ទៅ A- \nClaims on or Guaranteed by Banks rated A+ to A- or equivalent",
							2:u'%s' %GuaranteedA32,
							3:u'%s %s' %(Weighting50*100, '%'),
							4:u'%s' %GuaranteedAUSD32,
							5:u'%s' %GuaranteedAKHR32,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(GuaranteedBBB31)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(GuaranteedA32)).replace(',',''))
				})
		CellRow += 2

		# Block I.4
		# TotalAsset = Decimal(mktnbc.getLineValue("Amount%s%s"%('USD', TotalAssetLine), DataList))
		TotalAsset = Decimal(getBANK01(Branch, ReportedDate, Period, Month, Year, NBC05=True))
		TotalAsset = TotalAsset * RepRateMil
		TotalAsset = float(str(mktmoney.formatNumber(TotalAsset)).replace(',','')) # Should get from Balance Sheet Report
		
		Weighting100 	= 1
		TotalI4 		= TotalAsset - (CashInHand11 + ClaimOnNBC13)
		AllOtherAssetUSDI4 	= abs(TotalI4 * Weighting100)
		TotalUSDI4 			= AllOtherAssetUSDI4

		AllOtherAssetKHRI4 	= AllOtherAssetUSDI4 * ReportingRate / ReadAs
		AllOtherAssetKHRI4 = float(str(mktmoney.formatNumber(AllOtherAssetKHRI4)).replace(',',''))
		TotalKHRI4 			= AllOtherAssetKHRI4
		Data.append({
							1:u"4- ការថ្លឹង ១០០% ចំពោះទ្រព្យសកម្មដែលមានហានិភ័យទាំងស្រុង \nWeighting 100% on Assets with Full Risk",
							2:u'%s' %TotalI4,
							3:u'',
							4:u'%s' %AllOtherAssetUSDI4,
							5:u'%s' %AllOtherAssetKHRI4,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		Data.append({
							1:u"4.1- ទ្រព្យសកម្មដ៏ទៃទៀត \nAll other Assets, besides mentioned above",
							2:u'%s' %TotalI4,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %AllOtherAssetUSDI4,
							5:u'%s' %AllOtherAssetKHRI4,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(TotalI4)).replace(',',''))
				})
		CellRow += 2

		#  Block I.5
		Weighting120 = 1.2
		TradableSecurity51 = getGLValueForField(Branch, Period, 'TradableSecurity51', CurrencyDic, **Kargs)
		TradableSecurity51 = TradableSecurity51 * RepRateMil
		TradableSecurity51 = float(mktmoney.formatNumber(TradableSecurity51,0))
		TotalI5 			= TradableSecurity51

		TradableSecurityUSD51 	= TradableSecurity51 * Weighting120
		TotalUSDI5 				= TradableSecurityUSD51

		TradableSecurityKHR51 	= TradableSecurityUSD51 * ReportingRate / ReadAs
		TradableSecurityKHR51 = float(str(mktmoney.formatNumber(TradableSecurityKHR51)).replace(',',''))
		TotalKHRI5 				= TradableSecurityKHR51

		Data.append({
							1:u"5- ការថ្លឹង ១២០% ចំពោះមូលប័ត្រសម្រាប់ជួញដូរ \nWeighting 120% on Tradable Securities",
							2:u'%s' %TotalI5,
							3:u'',
							4:u'%s' %TradableSecurityUSD51,
							5:u'%s' %TradableSecurityKHR51,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		Data.append({
							1:u"5.1- មូលប័ត្រសម្រាប់ជួញដូរ Tradable Securities",
							2:u'%s' %TradableSecurity51,
							3:u'%s %s' %(Weighting120*100, '%'),
							4:u'%s' %TradableSecurityUSD51,
							5:u'%s' %TradableSecurityKHR51,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(TradableSecurity51)).replace(',',''))
				})
		CellRow += 4

		TotalI 		= TotalI1 + TotalI2 + TotalI3 + TotalI4 + TotalI5
		TotalUSDI 	= TotalUSDI2 + TotalUSDI3 + TotalUSDI4 + TotalUSDI5
		TotalKHRI 	= TotalKHRI2 + TotalKHRI3 + TotalKHRI4 + TotalKHRI5
		TotalKHRI = float(str(mktmoney.formatNumber(TotalKHRI)).replace(',',''))

		Data.append({
							1:u"សរុប Total ( I ) = (1) + (2) + (3) + (4)",
							2:u'%s' %TotalI,
							3:u'',
							4:u'%s' %TotalUSDI,
							5:u'%s' %TotalKHRI,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		Data.append({
							1:u"II- ធាតុនៃក្រៅតារាងតុល្យការដែលថ្លឹងតាមកំរិតហានិភ័យសមភាគី \nOff-Balance Sheet items, weighted by degree of Counter-Party Risk",
							2:u'',
							3:u'',
							4:u'',
							5:u'',
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		# Block II.1
		UndrawnFacility11 = getGLValueForField(Branch, Period, 'UndrawnFacility11', CurrencyDic, **Kargs)
		UndrawnFacility11 = UndrawnFacility11 * RepRateMil
		UndrawnFacility11 = float(mktmoney.formatNumber(UndrawnFacility11,0))
		
		OtherItemCarrying12 = getGLValueForField(Branch, Period, 'OtherItemCarrying12', CurrencyDic, **Kargs)
		OtherItemCarrying12 = OtherItemCarrying12 * RepRateMil
		OtherItemCarrying12 = float(mktmoney.formatNumber(OtherItemCarrying12,0))

		TotalII1 		= UndrawnFacility11 + OtherItemCarrying12

		Data.append({
							1:u"1- ការថ្លឹង ០% ចំពោះប្រតិបត្តិការដែលមានហានិភ័យទាប \nWeighting 0% on Operations with low Risk",
							2:u'%s' %TotalII1,
							3:u'',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		Data.append({
							1:u"1.1- ឥណទានមិនទាន់ប្រើប្រាស់​ ជាពិសេសឥណទានលើសសមតុល្យ និងការសន្យាឲ្យខ្ចីដែល​ មាន​កាលកំណត់រហូតពេញមួយឆ្នាំ​ឬ​​ដែលអាចលុបចោលដោយគ្មានលក្ខខ័ណ្ឌនៅពេលណា ក៏បានដោយគ្មានជូនដំណឹង \nUndrawn Facilities, particularly overdrafts and commitments to lend, which are for an initial m",
							2:u'%s' %UndrawnFacility11,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"1.2- ប្រតិបត្តិការផ្សេងទៀតដែលមានហានិភ័យទាប \nOther items carrying a low risk",
							2:u'%s' %OtherItemCarrying12,
							3:u'0%',
							4:u'0.00',
							5:u'0.00',
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(UndrawnFacility11)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherItemCarrying12)).replace(',',''))
				})
		CellRow += 2

		# Block II.2
		Documentary21 = getGLValueForField(Branch, Period, 'Documentary21', CurrencyDic, **Kargs)
		Documentary21 = Documentary21 * RepRateMil
		Documentary21 = float(mktmoney.formatNumber(Documentary21,0))

		OtherItemCarrying22 = getGLValueForField(Branch, Period, 'OtherItemCarrying22', CurrencyDic, **Kargs)
		OtherItemCarrying22 = OtherItemCarrying22 * RepRateMil
		OtherItemCarrying22 = float(mktmoney.formatNumber(OtherItemCarrying22,0))

		TotalII2 				= Documentary21 + OtherItemCarrying22

		DocumentaryUSD21 		= Documentary21 * Weighting20
		OtherItemCarryingUSD22 	= OtherItemCarrying22 * Weighting20
		TotalUSDII2 			= DocumentaryUSD21 + OtherItemCarryingUSD22

		DocumentaryKHR21 		= DocumentaryUSD21 * ReportingRate / ReadAs
		DocumentaryKHR21 = float(str(mktmoney.formatNumber(DocumentaryKHR21)).replace(',',''))

		OtherItemCarryingKHR22 	= OtherItemCarryingUSD22 * ReportingRate / ReadAs
		OtherItemCarryingKHR22 = float(str(mktmoney.formatNumber(OtherItemCarryingKHR22)).replace(',',''))

		TotalKHRII2 			= DocumentaryKHR21 + OtherItemCarryingKHR22
		TotalKHRII2 = float(str(mktmoney.formatNumber(TotalKHRII2)).replace(',',''))

		Data.append({
							1:u"2- ការថ្លឹង ២០% ចំពោះប្រតិបត្តិការដែលមានហានិភ័យធួនល្មម \nWeighting 20% on Operations with Moderate Risk",
							2:u'%s' %TotalII2,
							3:u'',
							4:u'%s' %TotalUSDII2,
							5:u'%s' %TotalKHRII2,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		Data.append({
							1:u"2.1- ឯកសារឥណទានដែលត្រូវបានចេញផ្សាយ​ ឬបញ្ជាក់ ​ស្របពេលដែលទំនិញត្រូវបានប្រើជា វត្ថុ​​បញ្ចាំ និង​​ ប្រតិបត្តិការស្រដៀងគ្នាផ្សេងទៀត \nDocumentary credits is sued or confirmed where the underlying goods serve as​​ collateral and other similar transactions",
							2:u'%s' %Documentary21,
							3:u'%s %s' %(Weighting20*100, '%'),
							4:u'%s' %DocumentaryUSD21,
							5:u'%s' %DocumentaryKHR21,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"2.2- ប្រតិបត្តិការផ្សេងទៀតដែលមានហានិភ័យធួនល្មម​ \nOther Items carrying moderate risk",
							2:u'%s' %OtherItemCarrying22,
							3:u'%s %s' %(Weighting20*100, '%'),
							4:u'%s' %OtherItemCarryingUSD22,
							5:u'%s' %OtherItemCarryingKHR22,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Documentary21)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherItemCarrying22)).replace(',',''))
				})
		CellRow += 2

		# Block II.3
		Commitment31 = getGLValueForField(Branch, Period, 'Commitment31', CurrencyDic, **Kargs)
		Commitment31 = Commitment31 * RepRateMil
		Commitment31 = float(mktmoney.formatNumber(Commitment31,0))

		Warranty32 = getGLValueForField(Branch, Period, 'Warranty32', CurrencyDic, **Kargs)
		Warranty32 = Warranty32 * RepRateMil
		Warranty32 = float(mktmoney.formatNumber(Warranty32,0))

		UndrawnFacility33 = getGLValueForField(Branch, Period, 'UndrawnFacility33', CurrencyDic, **Kargs)
		UndrawnFacility33 = UndrawnFacility33 * RepRateMil
		UndrawnFacility33 = float(mktmoney.formatNumber(UndrawnFacility33,0))

		OtherItemCarrying34 = getGLValueForField(Branch, Period, 'OtherItemCarrying34', CurrencyDic, **Kargs)
		OtherItemCarrying34 = OtherItemCarrying34 * RepRateMil
		OtherItemCarrying34 = float(mktmoney.formatNumber(OtherItemCarrying34,0))

		TotalII3 = Commitment31 + Warranty32 + UndrawnFacility33 + OtherItemCarrying34

		CommitmentUSD31 = Commitment31 * Weighting50
		CommitmentKHR31 = CommitmentUSD31 * ReportingRate / ReadAs
		CommitmentKHR31 = float(str(mktmoney.formatNumber(CommitmentKHR31)).replace(',',''))

		WarrantyUSD32 	= Warranty32 * Weighting50
		WarrantyKHR32 	= WarrantyUSD32 * ReportingRate / ReadAs
		WarrantyKHR32 = float(str(mktmoney.formatNumber(WarrantyKHR32)).replace(',',''))

		UndrawnFacilityUSD33 	= UndrawnFacility33 * Weighting50
		UndrawnFacilityKHR33 	= UndrawnFacilityUSD33 * ReportingRate / ReadAs
		UndrawnFacilityKHR33 = float(str(mktmoney.formatNumber(UndrawnFacilityKHR33)).replace(',',''))

		OtherItemCarryingUSD34 	= OtherItemCarrying34 * Weighting50
		OtherItemCarryingKHR34 	= OtherItemCarryingUSD34 * ReportingRate / ReadAs
		OtherItemCarryingKHR34 = float(str(mktmoney.formatNumber(OtherItemCarryingKHR34)).replace(',',''))

		TotalUSDII3 = CommitmentUSD31 + WarrantyUSD32 + UndrawnFacilityUSD33 + OtherItemCarryingUSD34
		TotalKHRII3 = CommitmentKHR31 + WarrantyKHR32 + UndrawnFacilityKHR33 + OtherItemCarryingKHR34
		TotalKHRII3 = float(str(mktmoney.formatNumber(TotalKHRII3)).replace(',',''))

		Data.append({
							1:u"3- ការថ្លឹង ៥០% ចំពោះប្រតិបត្តិការដែលមានហានិភ័យមធ្យម \nWeighting 50% on Operations with Medium Risk",
							2:u'%s' %TotalII3,
							3:u'',
							4:u'%s' %TotalUSDII3,
							5:u'%s' %TotalKHRII3,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"3.1- ការសងប្រាក់តាមឯកសារឥណទានដែលបានចេញផ្សាយឬបញ្ជាក់ហើយ នៅពេលដែល ទំនិញមិនត្រូវបានប្រើជាវត្ថុបញ្ចាំ \nCommitments to pay resulting from documentary credits, issued or confirmed, where the underlying goods do not serve as collateral",
							2:u'%s' %Commitment31,
							3:u'%s %s' %(Weighting50*100, '%'),
							4:u'%s' %CommitmentUSD31,
							5:u'%s' %CommitmentKHR31,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"3.2- ការធានានិងសញ្ញាប័ណ្ណឧបត្ថម្ភ និងការធានាដែលមិនមានលក្ខណៈជំនួសឥណទាន \nWarranties and idemnity bonds (including tender, performance, customs and tax bonds) and guarantees not having the character of credit substitutes",
							2:u'%s' %Warranty32,
							3:u'%s %s' %(Weighting50*100, '%'),
							4:u'%s' %WarrantyUSD32,
							5:u'%s' %WarrantyKHR32,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"3.3- កិច្ចសន្យាផ្តល់ឥណទានមិនប្រើប្រាស់ ជាពិសេសឥណទានលើសសមតុល្យ និងការសន្យា អោយខ្ចីដែលមានកាលកំណត់លើសពី១ឆ្នាំ \nUndrawn facilities, particularly overdrafts and commitments to lend with an initial term of more than one year",
							2:u'%s' %UndrawnFacility33,
							3:u'%s %s' %(Weighting50*100, '%'),
							4:u'%s' %UndrawnFacilityUSD33,
							5:u'%s' %UndrawnFacilityKHR33,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"3.4- ប្រតិបត្តិការផ្សេងទៀតដែលមានហានិភ័យមធ្យម \nOther items carrying medium risk",
							2:u'%s' %OtherItemCarrying34,
							3:u'%s %s' %(Weighting50*100, '%'),
							4:u'%s' %OtherItemCarryingUSD34,
							5:u'%s' %OtherItemCarryingKHR34,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Commitment31)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Warranty32)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(UndrawnFacility33)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherItemCarrying34)).replace(',',''))
				})
		CellRow += 2

		# Block II.4
		LoanGuarantee41 = getGLValueForField(Branch, Period, 'LoanGuarantee41', CurrencyDic, **Kargs)
		LoanGuarantee41 = LoanGuarantee41 * RepRateMil
		LoanGuarantee41 = float(mktmoney.formatNumber(LoanGuarantee41,0))

		Acceptance42 = getGLValueForField(Branch, Period, 'Acceptance42', CurrencyDic, **Kargs)
		Acceptance42 = Acceptance42 * RepRateMil
		Acceptance42 = float(mktmoney.formatNumber(Acceptance42,0))

		Endorsement43 = getGLValueForField(Branch, Period, 'Endorsement43', CurrencyDic, **Kargs)
		Endorsement43 = Endorsement43 * RepRateMil
		Endorsement43 = float(mktmoney.formatNumber(Endorsement43,0))

		Transaction44 = getGLValueForField(Branch, Period, 'Transaction44', CurrencyDic, **Kargs)
		Transaction44 = Transaction44 * RepRateMil
		Transaction44 = float(mktmoney.formatNumber(Transaction44,0))

		Irrvocable45 = getGLValueForField(Branch, Period, 'Irrvocable45', CurrencyDic, **Kargs)
		Irrvocable45 = Irrvocable45 * RepRateMil
		Irrvocable45 = float(mktmoney.formatNumber(Irrvocable45,0))
		
		OtherItemCarrying46 = getGLValueForField(Branch, Period, 'OtherItemCarrying46', CurrencyDic, **Kargs)
		OtherItemCarrying46 = OtherItemCarrying46 * RepRateMil
		OtherItemCarrying46 = float(mktmoney.formatNumber(OtherItemCarrying46,0))
		
		TotalII4 = LoanGuarantee41 + Acceptance42 + Endorsement43 + Transaction44 + Irrvocable45 + OtherItemCarrying46

		LoanGuaranteeUSD41 	= LoanGuarantee41 * Weighting100
		LoanGuaranteeKHR41 	= LoanGuaranteeUSD41 * ReportingRate / ReadAs
		TotalKHRII3 = float(str(mktmoney.formatNumber(TotalKHRII3)).replace(',',''))

		AcceptanceUSD42 	= Acceptance42 * Weighting100
		AcceptanceKHR42 	= AcceptanceUSD42 * ReportingRate / ReadAs
		EndorsementUSD43 	= Endorsement43 * Weighting100
		EndorsementKHR43 	= EndorsementUSD43 * ReportingRate / ReadAs
		TransactionUSD44 	= Transaction44 * Weighting100
		TransactionKHR44 	= TransactionUSD44 * ReportingRate / ReadAs
		IrrvocableUSD45 	= Irrvocable45 * Weighting100
		IrrvocableKHR45 	= IrrvocableUSD45 * ReportingRate / ReadAs
		OtherItemCarryingUSD46 = OtherItemCarrying46 * Weighting100
		OtherItemCarryingKHR46 = OtherItemCarryingUSD46 * ReportingRate / ReadAs

		LoanGuaranteeKHR41 	= float(str(mktmoney.formatNumber(LoanGuaranteeKHR41)).replace(',',''))
		AcceptanceKHR42 	= float(str(mktmoney.formatNumber(AcceptanceKHR42)).replace(',',''))
		EndorsementKHR43 	= float(str(mktmoney.formatNumber(EndorsementKHR43)).replace(',',''))
		TransactionKHR44 	= float(str(mktmoney.formatNumber(TransactionKHR44)).replace(',',''))
		IrrvocableKHR45 	= float(str(mktmoney.formatNumber(IrrvocableKHR45)).replace(',',''))
		OtherItemCarryingUSD46	= float(str(mktmoney.formatNumber(OtherItemCarryingUSD46)).replace(',',''))

		TotalUSDII4 = LoanGuaranteeUSD41 + AcceptanceUSD42 + EndorsementUSD43 + TransactionUSD44 + IrrvocableUSD45 + OtherItemCarryingUSD46
		TotalKHRII4 = LoanGuaranteeKHR41 + AcceptanceKHR42 + EndorsementKHR43 + TransactionKHR44 + IrrvocableKHR45 + OtherItemCarryingKHR46
		TotalUSDII4 = float(str(mktmoney.formatNumber(TotalUSDII4)).replace(',',''))
		TotalKHRII4 = float(str(mktmoney.formatNumber(TotalKHRII4)).replace(',',''))
		Data.append({
							1:u"4- ការថ្លឹង ១០០% ចំពោះប្រតិបត្តិការដែលមានហានិភ័យទាំងស្រុង \nWeighting 100% on Operations with Full Risk",
							2:u'%s' %TotalII4,
							3:u'',
							4:u'%s' %TotalUSDII4,
							5:u'%s' %TotalKHRII4,
							'LineType':'GH',
							'Indent':1,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"4.1- ការធានាលើឥណទាន​ (ដកចេញហានិភ័យចំពោះអត្ថគាហកៈ) \nLoan guarantees (deductible from the risk exposure in respect of the beneficiary)",
							2:u'%s' %LoanGuarantee41,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %LoanGuaranteeUSD41,
							5:u'%s' %LoanGuaranteeKHR41,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"4.2- ការទទួលព្រម  Acceptances",
							2:u'%s' %Acceptance42,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %AcceptanceUSD42,
							5:u'%s' %AcceptanceKHR42,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"4.3- រូបិយបដិភោគ លើផលប័ត្រដែលមិនមានឈ្មោះរបស់ធនាគារ ឬគ្រឹះស្ថានហិរញ្ញវត្ថុ  Endorsement on bills not bearing the name of another bank or financial institution",
							2:u'%s' %Endorsement43,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %EndorsementUSD43,
							5:u'%s' %EndorsementKHR43,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"4.4- សកម្មភាពប្រតិបត្តិការដោយមានឧប្រាស្រ័យ Transactions with recourse",
							2:u'%s' %Transaction44,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %TransactionUSD44,
							5:u'%s' %TransactionKHR44,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Data.append({
							1:u"4.5- កម្រិតឥណទានមិនអាចបដិសេធបាន ឬការធានា ដែលមានលក្ខណះជំនួសឥណទាន  Irrevocable credit lines, or guarantees, having the character of credit substitutes",
							2:u'%s' %Irrvocable45,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %IrrvocableUSD45,
							5:u'%s' %IrrvocableKHR45,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})

		Data.append({
							1:u"4.6- ប្រតិបត្តិការផ្សេងៗទៀត  ដែលមានហានិភ័យខ្ពស់ \nOther items carrying a high risk",
							2:u'%s' %OtherItemCarrying46,
							3:u'%s %s' %(Weighting100*100, '%'),
							4:u'%s' %OtherItemCarryingUSD46,
							5:u'%s' %OtherItemCarryingKHR46,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':'',
							'LineFormat':'bold'
						})
		
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanGuarantee41)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Acceptance42)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Endorsement43)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Transaction44)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Irrvocable45)).replace(',',''))
				})
		CellRow += 1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherItemCarrying46)).replace(',',''))
				})
		CellRow += 1

		TotalII 	= TotalII1 + TotalII2 + TotalII3 + TotalII4
		TotalII = float(str(mktmoney.formatNumber(TotalII)).replace(',',''))
		TotalUSDII = TotalUSDII2 + TotalUSDII3 + TotalUSDII4
		TotalUSDII = float(str(mktmoney.formatNumber(TotalUSDII)).replace(',',''))
		TotalKHRII = TotalKHRII2 + TotalKHRII3 + TotalKHRII4
		TotalKHRII = float(str(mktmoney.formatNumber(TotalKHRII)).replace(',',''))

		Data.append({
							1:u"សរុប Total ( II ) = (1) + (2) + (3) + (4)",
							2:u'%s' %TotalII,
							3:u'',
							4:u'%s' %TotalUSDII,
							5:u'%s' %TotalKHRII,
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})

		# Block III
		TotalUSDIII =  TotalUSDI + TotalUSDII
		TotalUSDIII = float(str(mktmoney.formatNumber(TotalUSDIII)).replace(',',''))
		TotalKHRIII = TotalKHRI + TotalKHRII
		TotalKHRIII = float(str(mktmoney.formatNumber(TotalKHRIII)).replace(',',''))

		Data.append({
							1:u"III- សរុបទ្រព្យសកម្មនិងប្រតិបត្តិការក្រោយថ្លឹងហានិភ័យ \nTotal Assets and Operations after  weighting Risk = ( I ) + ( II )",
							2:u'',
							3:u'',
							4:u'%s' %TotalUSDIII,
							5:u'%s' %TotalKHRIII,
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})
		SolTotalUSDIII = Decimal((TotalUSDIII * ReportingRate))
		SolTotalUSDIII =  SolTotalUSDIII if SolTotalUSDIII != 0 else 1
		SolvencyRatioUSD = Decimal((TotalNetWorth * ReadAs)) / SolTotalUSDIII
		SolvencyRatioUSD = float(str(mktmoney.formatNumber(SolvencyRatioUSD)).replace(',',''))

		TotalKHRIII = Decimal(TotalKHRIII) if TotalKHRIII !=0 else 1
		SolvencyRatioKHED =  Decimal((TotalNetWorth)) / TotalKHRIII
		SolvencyRatioKHED = float(str(mktmoney.formatNumber(SolvencyRatioKHED)).replace(',',''))

		Data.append({
							1:u"អនុបាតសាធនភាព =​ មូលនិធិផ្ទាល់សុទ្ធ / III   Solvency Ratio = Total Net Worth / III ( >15% )",
							2:u'',
							3:u'',
							4:u'%s%s' %(SolvencyRatioUSD * 100,'%'),
							5:u'%s%s' %(SolvencyRatioKHED * 100,'%'),
							'LineType':'GH',
							'Indent':2,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':'bold'
						})

		Result.update({'TableHeader':TableHeader,'ReportHeader':ReportHeader,'Data':Data, 'Excel': Excel})

		CellSyle = {
					'B10':'top*double,FF000000',
					'C10':'top*double,FF000000:bottom*medium,FF000000',
					'D10':'top*double,FF000000:bottom*medium,FF000000',
					'E10':'top*double,FF000000:bottom*medium,FF000000',
					'A12':'left*thin,FF000000:bottom*thin,FF000000',
					'B12':'bottom*thin,FF000000',
					'F11':'left*thin,FF000000:bottom*thin,FF000000',
					'C12':'bottom*thin,FF000000:top*thin,FF000000',
					'D12':'bottom*thin,FF000000:top*thin,FF000000',
					'E12':'bottom*thin,FF000000:top*thin,FF000000',
					'E13':'right*thin,FF000000',
					'A14':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B14':'bottom*thin,FF000000:top*thin,FF000000',
					'C14':'bottom*thin,FF000000:top*thin,FF000000',
					'D14':'bottom*thin,FF000000:top*thin,FF000000',
					'E14':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',
					
					'E15':'right*thin,FF000000',
					'A16':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B16':'bottom*thin,FF000000:top*thin,FF000000',
					'C16':'bottom*thin,FF000000:top*thin,FF000000',
					'D16':'bottom*thin,FF000000:top*thin,FF000000',
					'E16':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E17':'right*thin,FF000000',
					'A18':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B18':'bottom*thin,FF000000:top*thin,FF000000',
					'C18':'bottom*thin,FF000000:top*thin,FF000000',
					'D18':'bottom*thin,FF000000:top*thin,FF000000',
					'E18':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E19':'right*thin,FF000000',
					'A20':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B20':'bottom*thin,FF000000:top*thin,FF000000',
					'C20':'bottom*thin,FF000000:top*thin,FF000000',
					'D20':'bottom*thin,FF000000:top*thin,FF000000',
					'E20':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'A22':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B22':'bottom*thin,FF000000:top*thin,FF000000',
					'C22':'bottom*thin,FF000000:top*thin,FF000000',
					'D22':'bottom*thin,FF000000:top*thin,FF000000',
					'E22':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E23':'right*thin,FF000000',
					'A24':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B24':'bottom*thin,FF000000:top*thin,FF000000',
					'C24':'bottom*thin,FF000000:top*thin,FF000000',
					'D24':'bottom*thin,FF000000:top*thin,FF000000',
					'E24':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E25':'right*thin,FF000000',
					'A26':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B26':'bottom*thin,FF000000:top*thin,FF000000',
					'C26':'bottom*thin,FF000000:top*thin,FF000000',
					'D26':'bottom*thin,FF000000:top*thin,FF000000',
					'E26':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',


					'E27':'right*thin,FF000000',
					'A28':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B28':'bottom*thin,FF000000:top*thin,FF000000',
					'C28':'bottom*thin,FF000000:top*thin,FF000000',
					'D28':'bottom*thin,FF000000:top*thin,FF000000',
					'E28':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E29':'right*thin,FF000000',
					'A30':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B30':'bottom*thin,FF000000:top*thin,FF000000',
					'C30':'bottom*thin,FF000000:top*thin,FF000000',
					'D30':'bottom*thin,FF000000:top*thin,FF000000',
					'E30':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E31':'right*thin,FF000000',
					'A32':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B32':'bottom*thin,FF000000:top*thin,FF000000',
					'C32':'bottom*thin,FF000000:top*thin,FF000000',
					'D32':'bottom*thin,FF000000:top*thin,FF000000',
					'E32':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'A34':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B34':'bottom*thin,FF000000:top*thin,FF000000',
					'C34':'bottom*thin,FF000000:top*thin,FF000000',
					'D34':'bottom*thin,FF000000:top*thin,FF000000',
					'E34':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E35':'right*thin,FF000000',
					'A36':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B36':'bottom*thin,FF000000:top*thin,FF000000',
					'C36':'bottom*thin,FF000000:top*thin,FF000000',
					'D36':'bottom*thin,FF000000:top*thin,FF000000',
					'E36':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E37':'right*thin,FF000000',
					'A38':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B38':'bottom*thin,FF000000:top*thin,FF000000',
					'C38':'bottom*thin,FF000000:top*thin,FF000000',
					'D38':'bottom*thin,FF000000:top*thin,FF000000',
					'E38':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E39':'right*thin,FF000000',
					'A40':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B40':'bottom*thin,FF000000:top*thin,FF000000',
					'C40':'bottom*thin,FF000000:top*thin,FF000000',
					'D40':'bottom*thin,FF000000:top*thin,FF000000',
					'E40':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'A42':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B42':'bottom*thin,FF000000:top*thin,FF000000',
					'C42':'bottom*thin,FF000000:top*thin,FF000000',
					'D42':'bottom*thin,FF000000:top*thin,FF000000',
					'E42':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E43':'right*thin,FF000000',
					'A44':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B44':'bottom*thin,FF000000:top*thin,FF000000',
					'C44':'bottom*thin,FF000000:top*thin,FF000000',
					'D44':'bottom*thin,FF000000:top*thin,FF000000',
					'E44':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E45':'right*thin,FF000000',
					'A46':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B46':'bottom*thin,FF000000:top*thin,FF000000',
					'C46':'bottom*thin,FF000000:top*thin,FF000000',
					'D46':'bottom*thin,FF000000:top*thin,FF000000',
					'E46':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'E47':'right*thin,FF000000',
					'F46':'left*thin,FF000000',
					'A48':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B48':'bottom*thin,FF000000:top*thin,FF000000',
					'C48':'bottom*thin,FF000000:top*thin,FF000000',
					'D48':'bottom*thin,FF000000:top*thin,FF000000',
					'E48':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					'A50':'bottom*thin,FF000000:top*thin,FF000000:left*thin,FF000000',
					'B50':'bottom*thin,FF000000:top*thin,FF000000',
					'C50':'bottom*thin,FF000000:top*thin,FF000000',
					'D50':'bottom*thin,FF000000:top*thin,FF000000',
					'E50':'bottom*thin,FF000000:top*thin,FF000000',
					'F50':'bottom*thin,FF000000:top*thin,FF000000',
					'G50':'bottom*thin,FF000000:top*thin,FF000000:right*thin,FF000000',

					}

		return Result,CellSyle

	except Exception, e:
		raise

