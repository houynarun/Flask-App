# -*- coding: utf-8 -*-
'''
Report Name: 	MONTHLY REPORT ON MATURITY PROFILE
				
URL 		: 	/Morakot/Report/NBC/N21
'''
from app.mktcore.imports 		import *
import app.tools.mktnbc			as mktnbc
from app.GLBalance.models         import MKT_GL_BALANCE, MKT_GL_BALANCE_BACKUP
from app.Currency.models        import MKT_CURRENCY

import app.tools.mktdate         as mktdate
import app.tools.mktsetting     as mktsetting
import app.tools.mktmoney         as mktmoney
import app.tools.mktnbc            as mktnbc
import app.tools.mktgl             as mktgl
import app.tools.mktmessage     as mktmessage
from decimal                     import Decimal
import app.NBCReport.V2.BANK.BankSetting  as NBCBankSetting
from app.NBCReport.V2.BANK.N27 		import *
from app.LoanContract.models 			import *
import calendar
import datetime
from dateutil import relativedelta


def getGLValueForField(Branch = "ALL", Period = 2,NBCBank21Key='', NBCExchangeRateDict={},**Kargs):
	return NBCBankSetting.getGLValueFromField(Branch, Period, "NBCBankN21",NBCBank21Key, NBCExchangeRateDict,**Kargs)

def getBANK21(Branch="ALL", ReportedDate="",Period=2,Month = "", Year = ""):
	''' 
		This function must return result like below:
		Result = {
			'Data': 		Data,
			'Excel': 		Excel,
			'ReportHeader': ReportHeader,
			'TableHeader': 	TableHeader
			}
	'''

	try:
		
		Result 			= {}
		Data 			= []
		Excel 			= {}
		ReportHeader 	= {}
		ReportHeader 	= mktnbc.getHeaderReport(	ReportName 		=	u'MONTHLY REPORT ON MATURITY PROFILE',
													Title 			=	u'របាយការណ៍ប្រចាំខែស្តីពី កាលវសាន្តនៃទ្រព្យសកម្មនិងទ្រព្យអកម្ម',
													Form 			=	'Maturity'
													)
		ReportingRate = ReportHeader.get('ReportingRate',0)
		Excel.update({
				"B4" : ((ReportHeader.get('CompanyName',"")).splitlines())[0],
				"B5" : u'%s'%(NBCBankSetting.formatDateNBC(ReportHeader.get('ReportedDate',""))),
				"F6" : u'%s%s'%(ReportingRate,''),
				"F5" : u'%s%s'%(ReportingRate,'')
			})
		Condition 	= []
		if Year and Month:
			GLTable       = MKT_GL_BALANCE_BACKUP
			Condition     = [GLTable.GLYear == Year,GLTable.GLMonth == Month]
			CYear         = Year
			CMonth        = Month
		else:
			GLTable       = MKT_GL_BALANCE
			BankDate      = mktdate.getBankDate()
			CYear         = BankDate.year
			CMonth        = BankDate.month
		GLObj             = GLTable.query.filter(*Condition)
		Kargs             = {'GLTable':GLTable, 'GLObj':GLObj, 'FCY':True}
		CurrencyDic       =   mktnbc.getNBCExchangeRate(CYear, CMonth)
		CellRow 		  = 11

		TableHeader 	= {}
		TableHeader 	= mktnbc.setTableHeader(Text=u'ប្រភេទគណនី\nItems', 
											Rowspan=4,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'សមតុល្យ\nBalance', 
											Rowspan=4,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		TableHeader 	= mktnbc.setTableHeader(Text=u'កាលវសាន្ត(Maturity *)', 
											Rowspan=0,Colspan=8,RowIndex=1, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'មិនលើសពី១ខែ\nUp to 1 month', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង១ខែ\nតែមិនលើសពី៣ខែ\n> 1 month up to \n3 months', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង៣ខែ\nតែមិនលើសពី៦ខែ\n> 3 months up to \n6 months', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង៦ខែ\nតែមិនលើសពី១២ខែ\n> 6 months up to 12 \nmonths', 
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង១ឆ្នាំ\nតែមិនលើសពី២ឆ្នាំ\n> 1 year up to 2 \nyears',
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង២ឆ្នាំ\nតែមិនលើសពី៥ឆ្នាំ\n> 2 years up to 5 \nyears',
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង៥ឆ្នាំ\nតែមិនលើសពី១០ឆ្នាំ\n> 5 years up to 10 \nyears',
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'ច្រើនជាង១០ឆ្នាំ\n> 10 years',
											Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		Data.append({
						1:u"ក. ទ្រព្យសកម្ម<br/>A. ASSETS",
						2:u'',
						3:u'',
						4:u'',
						5:u'',
						6:u'',
						7:u'',
						8:u'',
						9:u'',
						10:u'',
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})

		CashOnHandSmallerthan1Month      = getGLValueForField(Branch, Period, 'CashOnHandSmallerthan1Month', CurrencyDic, **Kargs)
		CashOnHand1to3Month      		 = getGLValueForField(Branch, Period, 'CashOnHand1to3Month', CurrencyDic, **Kargs)
		CashOnHand3to6Month      		 = getGLValueForField(Branch, Period, 'CashOnHand3to6Month', CurrencyDic, **Kargs)
		CashOnHand6to12Month      		 = getGLValueForField(Branch, Period, 'CashOnHand6to12Month', CurrencyDic, **Kargs)
		CashOnHand1to2Year      		 = getGLValueForField(Branch, Period, 'CashOnHand1to2Year', CurrencyDic, **Kargs)
		CashOnHand2to5Year      		 = getGLValueForField(Branch, Period, 'CashOnHand2to5Year', CurrencyDic, **Kargs)
		CashOnHand5to10Year      		 = getGLValueForField(Branch, Period, 'CashOnHand5to10Year', CurrencyDic, **Kargs)
		CashOnHandBigger10Year 			 = getGLValueForField(Branch, Period, 'CashOnHandBigger10Year', CurrencyDic, **Kargs)
		CashOnHandBalance				 = CashOnHandSmallerthan1Month + CashOnHand1to3Month + CashOnHand3to6Month + CashOnHand6to12Month + CashOnHand1to2Year + CashOnHand2to5Year + CashOnHand5to10Year + CashOnHandBigger10Year
		
		Data.append({
						1:u"១.សាច់ប្រាក់ក្នុងដៃ Cash on hand",
						2:u'%s' %mktmoney.formatNumber(float(CashOnHandBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(CashOnHandSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(CashOnHand1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(CashOnHand3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(CashOnHand6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(CashOnHand1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(CashOnHand2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(CashOnHand5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(CashOnHandBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		NBCBalanceSmallerthan1Month      = getGLValueForField(Branch, Period, 'NBCBalanceSmallerthan1Month', CurrencyDic, **Kargs)
		NBCBalance1to3Month      		 = getGLValueForField(Branch, Period, 'NBCBalance1to3Month', CurrencyDic, **Kargs)
		NBCBalance3to6Month      		 = getGLValueForField(Branch, Period, 'NBCBalance3to6Month', CurrencyDic, **Kargs)
		NBCBalance6to12Month      		 = getGLValueForField(Branch, Period, 'NBCBalance6to12Month', CurrencyDic, **Kargs)
		NBCBalance1to2Year      		 = getGLValueForField(Branch, Period, 'NBCBalance1to2Year', CurrencyDic, **Kargs)
		NBCBalance2to5Year      		 = getGLValueForField(Branch, Period, 'NBCBalance2to5Year', CurrencyDic, **Kargs)
		NBCBalance5to10Year      		 = getGLValueForField(Branch, Period, 'NBCBalance5to10Year', CurrencyDic, **Kargs)
		NBCBalanceBigger10Year 			 = getGLValueForField(Branch, Period, 'NBCBalanceBigger10Year', CurrencyDic, **Kargs)
		NBCBalance = NBCBalanceSmallerthan1Month + NBCBalance1to3Month + NBCBalance3to6Month + NBCBalance6to12Month + NBCBalance1to2Year + NBCBalance2to5Year + NBCBalance5to10Year + NBCBalanceBigger10Year
		
		Data.append({
						1:u"២.សមតុល្យនៅធនាគាជាតិ Balance with NBC",
						2:u'%s' %mktmoney.formatNumber(float(NBCBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(NBCBalanceSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(NBCBalance1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(NBCBalance3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(NBCBalance6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(NBCBalance1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(NBCBalance2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(NBCBalance5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(NBCBalanceBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		NBCBankFieldSetting 				= NBCBankSetting.getNBCBankFieldSetting('NBCBankN21')
		InterbankAssetSmallerthan1Month 	= NBCBankFieldSetting.get('InterbankAssetSmallerthan1Month',0)
		InterbankAsset1to3Month				= NBCBankFieldSetting.get('InterbankAsset1to3Month',0)
		InterbankAsset3to6Month 			= NBCBankFieldSetting.get('InterbankAsset3to6Month',0)
		InterbankAsset6to12Month			= NBCBankFieldSetting.get('InterbankAsset6to12Month',0)
		InterbankAsset1to2Year 				= NBCBankFieldSetting.get('InterbankAsset1to2Year',0)
		InterbankAsset2to5Year				= NBCBankFieldSetting.get('InterbankAsset2to5Year',0)
		InterbankAsset5to10Year 			= NBCBankFieldSetting.get('InterbankAsset5to10Year',0)
		InterbankAssetBigger10Year			= NBCBankFieldSetting.get('InterbankAssetBigger10Year',0)
		InterbankAssetBalance				= float(InterbankAssetSmallerthan1Month) + float(InterbankAsset1to3Month) + float(InterbankAsset3to6Month) + float(InterbankAsset6to12Month) + float(InterbankAsset1to2Year) + float(InterbankAsset2to5Year) +  float(InterbankAsset5to10Year) + float(InterbankAssetBigger10Year)
		Data.append({
						1:u"៣.ទ្រព្យសកម្មអន្តរធនាគារ Interbank assets",
						2:u'%s' %mktmoney.formatNumber(float(InterbankAssetBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(InterbankAssetSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(InterbankAsset1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(InterbankAsset3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(InterbankAsset6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(InterbankAsset1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(InterbankAsset2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(InterbankAsset5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(InterbankAssetBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		MarketableSecuritiesSmallerthan1Month    = getGLValueForField(Branch, Period, 'MarketableSecuritiesSmallerthan1Month', CurrencyDic, **Kargs)
		MarketableSecurities1to3Month      		 = getGLValueForField(Branch, Period, 'MarketableSecurities1to3Month', CurrencyDic, **Kargs)
		MarketableSecurities3to6Month      		 = getGLValueForField(Branch, Period, 'MarketableSecurities3to6Month', CurrencyDic, **Kargs)
		MarketableSecurities6to12Month      	 = getGLValueForField(Branch, Period, 'MarketableSecurities6to12Month', CurrencyDic, **Kargs)
		MarketableSecurities1to2Year      		 = getGLValueForField(Branch, Period, 'MarketableSecurities1to2Year', CurrencyDic, **Kargs)
		MarketableSecurities2to5Year      		 = getGLValueForField(Branch, Period, 'MarketableSecurities2to5Year', CurrencyDic, **Kargs)
		MarketableSecurities5to10Year      		 = getGLValueForField(Branch, Period, 'MarketableSecurities5to10Year', CurrencyDic, **Kargs)
		MarketableSecuritiesBigger10Year 		 = getGLValueForField(Branch, Period, 'MarketableSecuritiesBigger10Year', CurrencyDic, **Kargs)
		MarketableSecuritiesBalance 			 = float(MarketableSecuritiesSmallerthan1Month)+float(MarketableSecurities1to3Month)+float(MarketableSecurities3to6Month)+float(MarketableSecurities6to12Month)+float(MarketableSecurities1to2Year)+float(MarketableSecurities2to5Year)+float(MarketableSecurities5to10Year)+float(MarketableSecuritiesBigger10Year)
		Data.append({
						1:u"៤.មូលប័ត្រអាចជួញដូរបាននៅទីផ្សារ Marketable securities",
						2:u'%s' %mktmoney.formatNumber(float(MarketableSecuritiesBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(MarketableSecuritiesSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(MarketableSecurities1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(MarketableSecurities3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(MarketableSecurities6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(MarketableSecurities1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(MarketableSecurities2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(MarketableSecurities5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(MarketableSecuritiesBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		# CurrentSmallerthan1Month 	= 	NBCBankFieldSetting.get('CurrentSmallerthan1Month',0)
		# Current1to3Month= NBCBankFieldSetting.get('Current1to3Month',0)
		# Current3to6Month 	= 	NBCBankFieldSetting.get('Current3to6Month',0)
		# Current6to12Month= NBCBankFieldSetting.get('Current6to12Month',0)
		# Current1to2Year 	= 	NBCBankFieldSetting.get('Current1to2Year',0)
		# Current2to5Year= NBCBankFieldSetting.get('Current2to5Year',0)
		# Current5to10Year 	= 	NBCBankFieldSetting.get('Current5to10Year',0)
		# CurrentBigger10Year= NBCBankFieldSetting.get('CurrentBigger10Year',0)
		CurrentSmallerthan1Month 	= 0
		Current1to3Month			= 0
		Current3to6Month 			= 0
		Current6to12Month			= 0
		Current1to2Year 			= 0
		Current2to5Year				= 0
		Current5to10Year 			= 0
		CurrentBigger10Year			= 0
		LoanContractObj 			= getLoanContract()
		if LoanContractObj:
			for row in LoanContractObj:
				CurrentSmallerthan1Month 	+= 	Decimal(row.Smaller1Month)* ReportingRate / 1000000
				Current1to3Month 			+=	Decimal(row.OneToThreeMonths) * ReportingRate / 1000000
				Current3to6Month 			+= 	Decimal(row.ThreeToSixMonths) * ReportingRate / 1000000
				Current6to12Month			+= 	Decimal(row.SixToTwelveMonths) * ReportingRate / 1000000
				Current1to2Year 			+= 	Decimal(row.OneToTwoYears) * ReportingRate / 1000000
				Current2to5Year				+= 	Decimal(row.TwoToFiveYears) * ReportingRate / 1000000
				Current5to10Year 			+= 	Decimal(row.FiveToTenYears) * ReportingRate / 1000000
				CurrentBigger10Year			+=	Decimal(row.OverTenYears) * ReportingRate / 1000000
		CurrentBalance						=   float(CurrentSmallerthan1Month)+float(Current1to3Month)+float(Current3to6Month)+float(Current6to12Month)+float(Current1to2Year)+float(Current2to5Year)+float(Current5to10Year)+float(CurrentBigger10Year)
		
		NonPerfomanceSmallerthan1Month      = getGLValueForField(Branch, Period, 'NonPerfomanceSmallerthan1Month', CurrencyDic, **Kargs)
		NonPerfomance1to3Month      		= getGLValueForField(Branch, Period, 'NonPerfomance1to3Month', CurrencyDic, **Kargs)
		NonPerfomance3to6Month      		= getGLValueForField(Branch, Period, 'NonPerfomance3to6Month', CurrencyDic, **Kargs)
		NonPerfomance6to12Month      		= getGLValueForField(Branch, Period, 'NonPerfomance6to12Month', CurrencyDic, **Kargs)
		NonPerfomance1to2Year      		 	= getGLValueForField(Branch, Period, 'NonPerfomance1to2Year', CurrencyDic, **Kargs)
		NonPerfomance2to5Year      		 	= getGLValueForField(Branch, Period, 'NonPerfomance2to5Year', CurrencyDic, **Kargs)
		NonPerfomance5to10Year      		= getGLValueForField(Branch, Period, 'NonPerfomance5to10Year', CurrencyDic, **Kargs)
		NonPerfomanceBigger10Year 			= getGLValueForField(Branch, Period, 'NonPerfomanceBigger10Year', CurrencyDic, **Kargs)
		NonPerfomanceBalance 				= float(NonPerfomanceSmallerthan1Month)+float(NonPerfomance1to3Month)+float(NonPerfomance3to6Month)+float(NonPerfomance6to12Month)+float(NonPerfomance1to2Year)+float(NonPerfomance2to5Year)+float(NonPerfomance5to10Year)+float(NonPerfomanceBigger10Year)
		
		LoanAndAdvanceSmallerthan1Month 	= float(CurrentSmallerthan1Month) + float(NonPerfomanceSmallerthan1Month)
		LoanAndAdvance1to3Month				= float(Current1to3Month) + float(NonPerfomance1to3Month)
		LoanAndAdvance3to6Month 			= float(Current3to6Month) + float(NonPerfomance3to6Month)
		LoanAndAdvance6to12Month 			= float(Current6to12Month) + float(NonPerfomance6to12Month)
		LoanAndAdvance1to2Year 				= float(Current1to2Year) + float(NonPerfomance1to2Year)
		LoanAndAdvance2to5Year 				= float(Current2to5Year) + float(NonPerfomance2to5Year)
		LoanAndAdvance5to10Year 			= float(Current5to10Year) + float(NonPerfomance5to10Year)
		LoanAndAdvanceBigger10Year 			= float(CurrentBigger10Year) + float(NonPerfomanceBigger10Year)
		LoanAndAdvanceBalance 				= CurrentBalance + NonPerfomanceBalance

		Data.append({
						1:u"៥.អោយខ្ចីចងការ និង​បុរេប្រទានចំពោះអតិថិជន <br/>Loans and advances to customers",
						2:u'%s' %mktmoney.formatNumber(float(LoanAndAdvanceBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(LoanAndAdvanceSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(LoanAndAdvance1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(LoanAndAdvance3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(LoanAndAdvance6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(LoanAndAdvance1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(LoanAndAdvance2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(LoanAndAdvance5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(LoanAndAdvanceBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"៥.១.ចរន្ត Current",
						2:u'%s' %mktmoney.formatNumber(float(CurrentBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(CurrentSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(Current1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(Current3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(Current6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(Current1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(Current2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(Current5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(CurrentBigger10Year),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"៥.២.ឥណទានមិនដំណើរការ Non performing **",
						2:u'%s' %mktmoney.formatNumber(float(NonPerfomanceBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(NonPerfomanceSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(NonPerfomance1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(NonPerfomance3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(NonPerfomance6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(NonPerfomance1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(NonPerfomance2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(NonPerfomance5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(NonPerfomanceBigger10Year),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})
		PropertiesForeclosedSmallerthan1Month 	= NBCBankFieldSetting.get('PropertiesForeclosedSmallerthan1Month',0)
		PropertiesForeclosed1to3Month			= NBCBankFieldSetting.get('PropertiesForeclosed1to3Month',0)
		PropertiesForeclosed3to6Month 			= NBCBankFieldSetting.get('PropertiesForeclosed3to6Month',0)
		PropertiesForeclosed6to12Month			= NBCBankFieldSetting.get('PropertiesForeclosed6to12Month',0)
		PropertiesForeclosed1to2Year 			= NBCBankFieldSetting.get('PropertiesForeclosed1to2Year',0)
		PropertiesForeclosed2to5Year			= NBCBankFieldSetting.get('PropertiesForeclosed2to5Year',0)
		PropertiesForeclosed5to10Year 			= NBCBankFieldSetting.get('PropertiesForeclosed5to10Year',0)
		PropertiesForeclosedBigger10Year		= NBCBankFieldSetting.get('PropertiesForeclosedBigger10Year',0)
		PropertiesForeclosedBalance				= float(PropertiesForeclosedSmallerthan1Month)+float(PropertiesForeclosed1to3Month)+float(PropertiesForeclosed3to6Month)+float(PropertiesForeclosed6to12Month)+float(PropertiesForeclosed1to2Year)+float(PropertiesForeclosed2to5Year)+float(PropertiesForeclosed5to10Year)+float(PropertiesForeclosedBigger10Year)
		Data.append({
						1:u"៦.ទ្រព្យសម្បត្តិរិបអូសពីកូនបំណុល Properties foreclosed",
						2:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosedBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosedSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosed1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosed3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosed6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosed1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosed2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosed5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(PropertiesForeclosedBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		AssetOtherSmallerthan1Month     = getGLValueForField(Branch, Period, 'AssetOtherSmallerthan1Month', CurrencyDic, **Kargs)
		AssetOther1to3Month      		= getGLValueForField(Branch, Period, 'AssetOther1to3Month', CurrencyDic, **Kargs)
		AssetOther3to6Month      		= getGLValueForField(Branch, Period, 'AssetOther3to6Month', CurrencyDic, **Kargs)
		AssetOther6to12Month      		= getGLValueForField(Branch, Period, 'AssetOther6to12Month', CurrencyDic, **Kargs)
		AssetOther1to2Year      		= getGLValueForField(Branch, Period, 'AssetOther1to2Year', CurrencyDic, **Kargs)
		AssetOther2to5Year      		= getGLValueForField(Branch, Period, 'AssetOther2to5Year', CurrencyDic, **Kargs)
		AssetOther5to10Year      		= getGLValueForField(Branch, Period, 'AssetOther5to10Year', CurrencyDic, **Kargs)
		AssetOtherBigger10Year 			= getGLValueForField(Branch, Period, 'AssetOtherBigger10Year', CurrencyDic, **Kargs)
		AssetOtherBalance 	= float(AssetOtherSmallerthan1Month)+float(AssetOther1to3Month)+float(AssetOther3to6Month)+float(AssetOther6to12Month)+float(AssetOther1to2Year)+float(AssetOther2to5Year)+float(AssetOther5to10Year)+float(AssetOtherBigger10Year)
		Data.append({
						1:u"៧.ផ្សេងៗ Other",
						2:u'%s' %mktmoney.formatNumber(float(AssetOtherBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(AssetOtherSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(AssetOther1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(AssetOther3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(AssetOther6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(AssetOther1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(AssetOther2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(AssetOther5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(AssetOtherBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		TotalAssetSmallerthan1Month     = float(CashOnHandSmallerthan1Month) + float(NBCBalanceSmallerthan1Month) + float(InterbankAssetSmallerthan1Month) + float(MarketableSecuritiesSmallerthan1Month) + float(LoanAndAdvanceSmallerthan1Month) + float(PropertiesForeclosedSmallerthan1Month) + float(AssetOtherSmallerthan1Month)
		TotalAsset1to3Month       		= float(CashOnHand1to3Month) + float(NBCBalance1to3Month) + float(InterbankAsset1to3Month) + float(MarketableSecurities1to3Month) + float(LoanAndAdvance1to3Month) + float(PropertiesForeclosed1to3Month) + float(AssetOther1to3Month)
		TotalAsset3to6Month      		= float(CashOnHand3to6Month) + float(NBCBalance3to6Month) + float(InterbankAsset3to6Month) + float(MarketableSecurities3to6Month) + float(LoanAndAdvance3to6Month) + float(PropertiesForeclosed3to6Month) + float(AssetOther3to6Month)
		TotalAsset6to12Month     		= float(CashOnHand6to12Month) + float(NBCBalance6to12Month) + float(InterbankAsset6to12Month) + float(MarketableSecurities6to12Month) + float(LoanAndAdvance6to12Month) + float(PropertiesForeclosed6to12Month) + float(AssetOther6to12Month)
		TotalAsset1to2Year      		= float(CashOnHand1to2Year) + float(NBCBalance1to2Year) + float(InterbankAsset1to2Year) + float(MarketableSecurities1to2Year) + float(LoanAndAdvance1to2Year) + float(PropertiesForeclosed1to2Year) + float(AssetOther1to2Year)
		TotalAsset2to5Year      		= float(CashOnHand2to5Year) + float(NBCBalance2to5Year) + float(InterbankAsset2to5Year) + float(MarketableSecurities2to5Year) + float(LoanAndAdvance2to5Year) + float(PropertiesForeclosed2to5Year) + float(AssetOther2to5Year)
		TotalAsset5to10Year      		= float(CashOnHand5to10Year) + float(NBCBalance5to10Year) + float(InterbankAsset5to10Year) + float(MarketableSecurities5to10Year) + float(LoanAndAdvance5to10Year) + float(PropertiesForeclosed5to10Year) + float(AssetOther5to10Year)
		TotalAssetBigger10Year 			= float(CashOnHandBigger10Year) + float(NBCBalanceBigger10Year) + float(InterbankAssetBigger10Year) + float(MarketableSecuritiesBigger10Year) + float(LoanAndAdvanceBigger10Year) + float(PropertiesForeclosedBigger10Year) + float(AssetOtherBigger10Year)
		TotalAssetBalance 				= float(TotalAssetSmallerthan1Month)+float(TotalAsset1to3Month)+float(TotalAsset3to6Month)+float(TotalAsset6to12Month)+float(TotalAsset1to2Year)+float(TotalAsset2to5Year)+float(TotalAsset5to10Year)+float(TotalAssetBigger10Year)
		Data.append({
						1:u"សរុប​ TOTAL",
						2:u'%s' %mktmoney.formatNumber(float(TotalAssetBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(TotalAssetSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(TotalAsset1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(TotalAsset3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(TotalAsset6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(TotalAsset1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(TotalAsset2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(TotalAsset5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(TotalAssetBigger10Year),1,2),
						'LineType':'GH',
						'Indent':1,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})
		Data.append({
						1:u"ខ. ទ្រព្យអកម្ម <br/>B. LIABILITIES ",
						2:u'',
						3:u'',
						4:u'',
						5:u'',
						6:u'',
						7:u'',
						8:u'',
						9:u'',
						10:u'',
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})
		ResultAccountingObj				 = getAccountObj()
		DemandDepositSmallerthan1Month 	 = ""
		if ResultAccountingObj:
			for row in ResultAccountingObj:
				DemandDepositSmallerthan1Month    = row.AvailableBal
		DemandDeposit1to3Month      	= getGLValueForField(Branch, Period, 'DemandDeposit1to3Month', CurrencyDic, **Kargs)
		DemandDeposit3to6Month      	= getGLValueForField(Branch, Period, 'DemandDeposit3to6Month', CurrencyDic, **Kargs)
		DemandDeposit6to12Month      	= getGLValueForField(Branch, Period, 'DemandDeposit6to12Month', CurrencyDic, **Kargs)
		DemandDeposit1to2Year      		= getGLValueForField(Branch, Period, 'DemandDeposit1to2Year', CurrencyDic, **Kargs)
		DemandDeposit2to5Year      		= getGLValueForField(Branch, Period, 'DemandDeposit2to5Year', CurrencyDic, **Kargs)
		DemandDeposit5to10Year      	= getGLValueForField(Branch, Period, 'DemandDeposit5to10Year', CurrencyDic, **Kargs)
		DemandDepositBigger10Year 		= getGLValueForField(Branch, Period, 'DemandDepositBigger10Year', CurrencyDic, **Kargs)
		DemandDepositBalance 			= float(DemandDepositSmallerthan1Month)+float(DemandDeposit1to3Month)+float(DemandDeposit3to6Month)+float(DemandDeposit6to12Month)+float(DemandDeposit1to2Year)+float(DemandDeposit2to5Year)+float(DemandDeposit5to10Year)+float(DemandDepositBigger10Year)

		TimeDepositSmallerthan1Month    = getGLValueForField(Branch, Period, 'TimeDepositSmallerthan1Month', CurrencyDic, **Kargs)
		TimeDeposit1to3Month      		= getGLValueForField(Branch, Period, 'TimeDeposit1to3Month', CurrencyDic, **Kargs)
		TimeDeposit3to6Month      		= getGLValueForField(Branch, Period, 'TimeDeposit3to6Month', CurrencyDic, **Kargs)
		TimeDeposit6to12Month      		= getGLValueForField(Branch, Period, 'TimeDeposit6to12Month', CurrencyDic, **Kargs)
		TimeDeposit1to2Year      		= getGLValueForField(Branch, Period, 'TimeDeposit1to2Year', CurrencyDic, **Kargs)
		TimeDeposit2to5Year      		= getGLValueForField(Branch, Period, 'TimeDeposit2to5Year', CurrencyDic, **Kargs)
		TimeDeposit5to10Year      		= getGLValueForField(Branch, Period, 'TimeDeposit5to10Year', CurrencyDic, **Kargs)
		TimeDepositBigger10Year 		= getGLValueForField(Branch, Period, 'TimeDepositBigger10Year', CurrencyDic, **Kargs)
		TimeDepositBalance 				= float(TimeDepositSmallerthan1Month)+float(TimeDeposit1to3Month)+float(TimeDeposit3to6Month)+float(TimeDeposit6to12Month)+float(TimeDeposit1to2Year)+float(TimeDeposit2to5Year)+float(TimeDeposit5to10Year)+float(TimeDepositBigger10Year)

		DepositSmallerthan1Month    = float(DemandDepositSmallerthan1Month)+float(TimeDepositSmallerthan1Month)
		Deposit1to3Month      		= float(DemandDeposit1to3Month)+float(TimeDeposit1to3Month)
		Deposit3to6Month      		= float(DemandDeposit3to6Month)+float(TimeDeposit3to6Month)
		Deposit6to12Month      		= float(DemandDeposit6to12Month)+float(TimeDeposit6to12Month)
		Deposit1to2Year      		= float(DemandDeposit1to2Year)+float(TimeDeposit1to2Year)
		Deposit2to5Year      		= float(DemandDeposit2to5Year)+float(TimeDeposit2to5Year)
		Deposit5to10Year      		= float(DemandDeposit5to10Year)+float(TimeDeposit5to10Year)
		DepositBigger10Year 		= float(DemandDepositBigger10Year)+float(TimeDepositBigger10Year)
		DepositBalance 				= float(DepositSmallerthan1Month)+float(Deposit1to3Month)+float(Deposit3to6Month)+float(Deposit6to12Month)+float(Deposit1to2Year)+float(TimeDeposit2to5Year)+float(Deposit5to10Year)+float(DepositBigger10Year)
		
		Data.append({
						1:u"១.ប្រាក់បញ្ញើរ Deposit",
						2:u'%s' %mktmoney.formatNumber(float(DepositBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(DepositSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(Deposit1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(Deposit3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(Deposit6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(Deposit1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(Deposit2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(Deposit5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(DepositBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"១.១.ប្រាក់បញ្ញើរចរន្ត Demand deposits",
						2:u'%s' %mktmoney.formatNumber(float(DemandDepositBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(DemandDepositSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(DemandDeposit1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(DemandDeposit3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(DemandDeposit6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(DemandDeposit1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(DemandDeposit2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(DemandDeposit5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(DemandDepositBigger10Year),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"១.២.ប្រាក់បញ្ញើរមានកាលកំណត់ Time deposits",
						2:u'%s' %mktmoney.formatNumber(float(TimeDepositBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(TimeDepositSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(TimeDeposit1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(TimeDeposit3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(TimeDeposit6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(TimeDeposit1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(TimeDeposit2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(TimeDeposit5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(TimeDepositBigger10Year),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})
		NBCSmallerthan1Month    = getGLValueForField(Branch, Period, 'NBCSmallerthan1Month', CurrencyDic, **Kargs)
		NBC1to3Month      		= getGLValueForField(Branch, Period, 'NBC1to3Month', CurrencyDic, **Kargs)
		NBC3to6Month      		= getGLValueForField(Branch, Period, 'NBC3to6Month', CurrencyDic, **Kargs)
		NBC6to12Month      		= getGLValueForField(Branch, Period, 'NBC6to12Month', CurrencyDic, **Kargs)
		NBC1to2Year      		= getGLValueForField(Branch, Period, 'NBC1to2Year', CurrencyDic, **Kargs)
		NBC2to5Year      		= getGLValueForField(Branch, Period, 'NBC2to5Year', CurrencyDic, **Kargs)
		NBC5to10Year      		= getGLValueForField(Branch, Period, 'NBC5to10Year', CurrencyDic, **Kargs)
		NBCBigger10Year 		= getGLValueForField(Branch, Period, 'NBCBigger10Year', CurrencyDic, **Kargs)
		NBCLiabilitiesBalance 	= float(NBCSmallerthan1Month)+float(NBC1to3Month)+float(NBC3to6Month)+float(NBC6to12Month)+float(NBC1to2Year)+float(NBC2to5Year)+float(NBC5to10Year)+float(NBCBigger10Year)
		Data.append({
						1:u"២.ធនាគាជាតិ NBC",
						2:u'%s' %mktmoney.formatNumber(float(NBCLiabilitiesBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(NBCSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(NBC1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(NBC3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(NBC6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(NBC1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(NBC2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(NBC5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(NBCBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		InterbankLiabilitiesSmallerthan1Month 	= NBCBankFieldSetting.get('InterbankLiabilitiesSmallerthan1Month',0)
		InterbankLiabilities1to3Month			= NBCBankFieldSetting.get('InterbankLiabilities1to3Month',0)
		InterbankLiabilities3to6Month 			= NBCBankFieldSetting.get('InterbankLiabilities3to6Month',0)
		InterbankLiabilities6to12Month			= NBCBankFieldSetting.get('InterbankLiabilities6to12Month',0)
		InterbankLiabilities1to2Year 			= NBCBankFieldSetting.get('InterbankLiabilities1to2Year',0)
		InterbankLiabilities2to5Year			= NBCBankFieldSetting.get('InterbankLiabilities2to5Year',0)
		InterbankLiabilities5to10Year 			= NBCBankFieldSetting.get('InterbankLiabilities5to10Year',0)
		InterbankLiabilitiesBigger10Year		= NBCBankFieldSetting.get('InterbankLiabilitiesBigger10Year',0)
		InterbankLiabilitiesBalance 			= float(InterbankLiabilitiesSmallerthan1Month)+float(InterbankLiabilities1to3Month)+float(InterbankLiabilities3to6Month)+float(InterbankLiabilities6to12Month)+float(InterbankLiabilities1to2Year)+float(InterbankLiabilities2to5Year)+float(InterbankLiabilities5to10Year)+float(InterbankLiabilitiesBigger10Year)
		Data.append({
						1:u"៣.បំណុលអន្តរធនាគារ Interbank liabilities",
						2:u'%s' %mktmoney.formatNumber(float(InterbankLiabilitiesBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(InterbankLiabilitiesSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(InterbankLiabilities1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(InterbankLiabilities3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(InterbankLiabilities6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(InterbankLiabilities1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(InterbankLiabilities2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(InterbankLiabilities5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(InterbankLiabilitiesBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		SecuritiesIssuedSmallerthan1Month 	= NBCBankFieldSetting.get('SecuritiesIssuedSmallerthan1Month',0)
		SecuritiesIssued1to3Month			= NBCBankFieldSetting.get('SecuritiesIssued1to3Month',0)
		SecuritiesIssued3to6Month 			= NBCBankFieldSetting.get('SecuritiesIssued3to6Month',0)
		SecuritiesIssued6to12Month			= NBCBankFieldSetting.get('SecuritiesIssued6to12Month',0)
		SecuritiesIssued1to2Year 			= NBCBankFieldSetting.get('SecuritiesIssued1to2Year',0)
		SecuritiesIssued2to5Year			= NBCBankFieldSetting.get('SecuritiesIssued2to5Year',0)
		SecuritiesIssued5to10Year 			= NBCBankFieldSetting.get('SecuritiesIssued5to10Year',0)
		SecuritiesIssuedBigger10Year		= NBCBankFieldSetting.get('SecuritiesIssuedBigger10Year',0)
		SecuritiesIssuedBalance 			= float(SecuritiesIssuedSmallerthan1Month)+float(SecuritiesIssued1to3Month)+float(SecuritiesIssued3to6Month)+float(SecuritiesIssued6to12Month)+float(SecuritiesIssued1to2Year)+float(SecuritiesIssued2to5Year)+float(SecuritiesIssued5to10Year)+float(SecuritiesIssuedBigger10Year)
		Data.append({
						1:u"៤.មូលប័ត្របោះផ្សាយ Securities issued",
						2:u'%s' %mktmoney.formatNumber(float(SecuritiesIssuedBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(SecuritiesIssuedSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(SecuritiesIssued1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(SecuritiesIssued3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(SecuritiesIssued6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(SecuritiesIssued1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(SecuritiesIssued2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(SecuritiesIssued5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(SecuritiesIssuedBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		BorrowingSmallerthan1Month     	= getGLValueForField(Branch, Period, 'BorrowingSmallerthan1Month', CurrencyDic, **Kargs)
		Borrowing1to3Month      		= getGLValueForField(Branch, Period, 'Borrowing1to3Month', CurrencyDic, **Kargs)
		Borrowing3to6Month      		= getGLValueForField(Branch, Period, 'Borrowing3to6Month', CurrencyDic, **Kargs)
		Borrowing6to12Month      		= getGLValueForField(Branch, Period, 'Borrowing6to12Month', CurrencyDic, **Kargs)
		Borrowing1to2Year      			= getGLValueForField(Branch, Period, 'Borrowing1to2Year', CurrencyDic, **Kargs)
		Borrowing2to5Year      			= getGLValueForField(Branch, Period, 'Borrowing2to5Year', CurrencyDic, **Kargs)
		Borrowing5to10Year      		= getGLValueForField(Branch, Period, 'Borrowing5to10Year', CurrencyDic, **Kargs)
		BorrowingBigger10Year 			= getGLValueForField(Branch, Period, 'BorrowingBigger10Year', CurrencyDic, **Kargs)
		BorrowingBalance 				= float(BorrowingSmallerthan1Month)+float(Borrowing1to3Month)+float(Borrowing3to6Month)+float(Borrowing6to12Month)+float(Borrowing1to2Year)+float(Borrowing2to5Year)+float(Borrowing5to10Year)+float(BorrowingBigger10Year)
		Data.append({
						1:u"៥.ប្រាក់កម្ចី Borrowings",
						2:u'%s' %mktmoney.formatNumber(float(BorrowingBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(BorrowingSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(Borrowing1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(Borrowing3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(Borrowing6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(Borrowing1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(Borrowing2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(Borrowing5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(BorrowingBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		LiabilitiesOtherSmallerthan1Month   = getGLValueForField(Branch, Period, 'LiabilitiesOtherSmallerthan1Month', CurrencyDic, **Kargs)
		LiabilitiesOther1to3Month      		= getGLValueForField(Branch, Period, 'LiabilitiesOther1to3Month', CurrencyDic, **Kargs)
		LiabilitiesOther3to6Month      		= getGLValueForField(Branch, Period, 'LiabilitiesOther3to6Month', CurrencyDic, **Kargs)
		LiabilitiesOther6to12Month      	= getGLValueForField(Branch, Period, 'LiabilitiesOther6to12Month', CurrencyDic, **Kargs)
		LiabilitiesOther1to2Year      		= getGLValueForField(Branch, Period, 'LiabilitiesOther1to2Year', CurrencyDic, **Kargs)
		LiabilitiesOther2to5Year      		= getGLValueForField(Branch, Period, 'LiabilitiesOther2to5Year', CurrencyDic, **Kargs)
		LiabilitiesOther5to10Year      		= getGLValueForField(Branch, Period, 'LiabilitiesOther5to10Year', CurrencyDic, **Kargs)
		LiabilitiesOtherBigger10Year 		= getGLValueForField(Branch, Period, 'LiabilitiesOtherBigger10Year', CurrencyDic, **Kargs)
		LiabilitiesOtherBalance 			= float(LiabilitiesOtherSmallerthan1Month)+float(LiabilitiesOther1to3Month)+float(LiabilitiesOther3to6Month)+float(LiabilitiesOther6to12Month)+float(LiabilitiesOther1to2Year)+float(LiabilitiesOther2to5Year)+float(LiabilitiesOther5to10Year)+float(LiabilitiesOtherBigger10Year)
		Data.append({
						1:u"៦.ផ្សេងៗ Others",
						2:u'%s' %mktmoney.formatNumber(float(LiabilitiesOtherBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(LiabilitiesOtherSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(LiabilitiesOther1to3Month),1,8),
						5:u'%s' %mktmoney.formatNumber(float(LiabilitiesOther3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(LiabilitiesOther6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(LiabilitiesOther1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(LiabilitiesOther2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(LiabilitiesOther5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(LiabilitiesOtherBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		EquitySmallerthan1Month   	= getGLValueForField(Branch, Period, 'EquitySmallerthan1Month', CurrencyDic, **Kargs)
		Equity1to3Month      		= getGLValueForField(Branch, Period, 'Equity1to3Month', CurrencyDic, **Kargs)
		Equity3to6Month      		= getGLValueForField(Branch, Period, 'Equity3to6Month', CurrencyDic, **Kargs)
		Equity6to12Month      		= getGLValueForField(Branch, Period, 'Equity6to12Month', CurrencyDic, **Kargs)
		Equity1to2Year      		= getGLValueForField(Branch, Period, 'Equity1to2Year', CurrencyDic, **Kargs)
		Equity2to5Year      		= getGLValueForField(Branch, Period, 'Equity2to5Year', CurrencyDic, **Kargs)
		Equity5to10Year      		= getGLValueForField(Branch, Period, 'Equity5to10Year', CurrencyDic, **Kargs)
		EquityBigger10Year 			= getGLValueForField(Branch, Period, 'EquityBigger10Year', CurrencyDic, **Kargs)
		EquityBalance 				= float(EquitySmallerthan1Month)+float(Equity1to3Month)+float(Equity3to6Month)+float(Equity6to12Month)+float(Equity1to2Year)+float(Equity2to5Year)+float(Equity5to10Year)+float(EquityBigger10Year)
		Data.append({
						1:u"៧.មូលនិធិភាគទុនិក Equity ***",
						2:u'%s' %mktmoney.formatNumber(float(EquityBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(EquitySmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(Equity1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(Equity3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(Equity6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(Equity1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(Equity2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(Equity5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(EquityBigger10Year),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		TotalLiabilitySmallerthan1Month     = float(DepositSmallerthan1Month) + float(NBCSmallerthan1Month) + float(InterbankLiabilitiesSmallerthan1Month) + float(SecuritiesIssuedSmallerthan1Month) + float(BorrowingSmallerthan1Month) + float(LiabilitiesOtherSmallerthan1Month) + float(EquitySmallerthan1Month)
		TotalLiability1to3Month       		= float(Deposit1to3Month) + float(NBC1to3Month) + float(InterbankLiabilities1to3Month) + float(SecuritiesIssued1to3Month) + float(Borrowing1to3Month) + float(LiabilitiesOther1to3Month) + float(Equity1to3Month)
		TotalLiability3to6Month      		= float(Deposit3to6Month) + float(NBC3to6Month) + float(InterbankLiabilities3to6Month) + float(SecuritiesIssued3to6Month) + float(Borrowing3to6Month) + float(LiabilitiesOther3to6Month) + float(Equity3to6Month)
		TotalLiability6to12Month     		= float(Deposit6to12Month) + float(NBC6to12Month) + float(InterbankLiabilities6to12Month) + float(SecuritiesIssued6to12Month) + float(Borrowing6to12Month) + float(LiabilitiesOther6to12Month) + float(Equity6to12Month)
		TotalLiability1to2Year      		= float(Deposit1to2Year) + float(NBC1to2Year) + float(InterbankLiabilities1to2Year) + float(SecuritiesIssued1to2Year) + float(Borrowing1to2Year) + float(LiabilitiesOther1to2Year) + float(Equity1to2Year)
		TotalLiability2to5Year     	 		= float(Deposit2to5Year) + float(NBC2to5Year) + float(InterbankLiabilities2to5Year) + float(SecuritiesIssued2to5Year) + float(Borrowing2to5Year) + float(LiabilitiesOther2to5Year) + float(Equity2to5Year)
		TotalLiability5to10Year      		= float(Deposit5to10Year) + float(NBC5to10Year) + float(InterbankLiabilities5to10Year) + float(SecuritiesIssued5to10Year) + float(Borrowing5to10Year) + float(LiabilitiesOther5to10Year) + float(Equity5to10Year)
		TotalLiabilityBigger10Year 			= float(DepositBigger10Year) + float(NBCBigger10Year) + float(InterbankLiabilitiesBigger10Year) + float(SecuritiesIssuedBigger10Year) + float(BorrowingBigger10Year) + float(LiabilitiesOtherBigger10Year) + float(EquityBigger10Year)
		TotalLiabilityBalance 				= float(TotalLiabilitySmallerthan1Month)+float(TotalLiability1to3Month)+float(TotalLiability3to6Month)+float(TotalLiability6to12Month)+float(TotalLiability1to2Year)+float(TotalLiability2to5Year)+float(TotalLiability5to10Year)+float(TotalLiabilityBigger10Year)
		Data.append({
						1:u"សរុប​ TOTAL = 1+2+3+4+5+6+7",
						2:u'%s' %mktmoney.formatNumber(float(TotalLiabilityBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(TotalLiabilitySmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(TotalLiability1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(TotalLiability3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(TotalLiability6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(TotalLiability1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(TotalLiability2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(TotalLiability5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(TotalLiabilityBigger10Year),1,2),
						'LineType':'GH',
						'Indent':1,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})
		MaturityGAPSmallerthan1Month     	= float(TotalAssetSmallerthan1Month) 	- float(TotalLiabilitySmallerthan1Month) 
		MaturityGAP1to3Month       			= float(TotalAsset1to3Month) 			- float(TotalLiability1to3Month) 
		MaturityGAP3to6Month      			= float(TotalAsset3to6Month) 			- float(TotalLiability3to6Month)
		MaturityGAP6to12Month     			= float(TotalAsset6to12Month) 			- float(TotalLiability6to12Month) 
		MaturityGAP1to2Year      			= float(TotalAsset1to2Year) 			- float(TotalLiability1to2Year) 
		MaturityGAP2to5Year      			= float(TotalAsset2to5Year) 			- float(TotalLiability2to5Year) 
		MaturityGAP5to10Year      			= float(TotalAsset5to10Year) 			- float(TotalLiability5to10Year)
		MaturityGAPBigger10Year 			= float(TotalAssetBigger10Year) 		- float(TotalLiabilityBigger10Year) 
		MaturityGAPBalance 					= float(TotalAssetBalance) 				- float(TotalLiabilityBalance)
		Data.append({
						1:u"គ.គម្លាតកាលកំណត់(ក-ខ) <br/>C. MATURITY GAP (A - B)",
						2:u'%s' %mktmoney.formatNumber(float(MaturityGAPBalance),1,2),
						3:u'%s' %mktmoney.formatNumber(float(MaturityGAPSmallerthan1Month),1,2),
						4:u'%s' %mktmoney.formatNumber(float(MaturityGAP1to3Month),1,2),
						5:u'%s' %mktmoney.formatNumber(float(MaturityGAP3to6Month),1,2),
						6:u'%s' %mktmoney.formatNumber(float(MaturityGAP6to12Month),1,2),
						7:u'%s' %mktmoney.formatNumber(float(MaturityGAP1to2Year),1,2),
						8:u'%s' %mktmoney.formatNumber(float(MaturityGAP2to5Year),1,2),
						9:u'%s' %mktmoney.formatNumber(float(MaturityGAP5to10Year),1,2),
						10:u'%s' %mktmoney.formatNumber(float(MaturityGAPBigger10Year),1,2),
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})
		#C Column
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHandSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalanceSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAssetSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecuritiesSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvanceSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(CurrentSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomanceSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosedSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOtherSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(DepositSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDepositSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDepositSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilitiesSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssuedSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowingSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOtherSmallerthan1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"C%s"%(CellRow) : float(str(mktmoney.formatNumber(EquitySmallerthan1Month,1,8)).replace(',',''))
				})
		#D Column
		CellRow = 11
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAsset1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecurities1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvance1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(Current1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomance1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosed1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOther1to3Month,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(Deposit1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDeposit1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDeposit1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(NBC1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilities1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssued1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(Borrowing1to3Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOther1to3Month,1,8)).replace(',',''))
				})
		Excel.update({
					"D%s"%(CellRow) : float(str(mktmoney.formatNumber(Equity1to3Month,1,8)).replace(',',''))
				})
		CellRow = 11
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAsset3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecurities3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvance3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(Current3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomance3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosed3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOther3to6Month,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(Deposit3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDeposit3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDeposit3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(NBC3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilities3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssued3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(Borrowing3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOther3to6Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(Equity3to6Month,1,8)).replace(',',''))
				})

		CellRow = 11
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAsset6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecurities6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvance6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Current6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomance6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosed6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOther6to12Month,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Deposit6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDeposit6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDeposit6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(NBC6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilities6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssued6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Borrowing6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOther6to12Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Equity6to12Month,1,8)).replace(',',''))
				})

		CellRow = 11
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAsset1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecurities1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvance1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(Current1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomance1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosed1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOther1to2Year,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(Deposit1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDeposit1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDeposit1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(NBC1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilities1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssued1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(Borrowing1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOther1to2Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(Equity1to2Year,1,8)).replace(',',''))
				})
		CellRow = 11
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAsset2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecurities2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvance2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(Current2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomance2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosed2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOther2to5Year,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(Deposit2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDeposit2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDeposit2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(NBC2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilities2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssued2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(Borrowing2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOther2to5Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(Equity2to5Year,1,8)).replace(',',''))
				})

		CellRow = 11
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAsset5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecurities5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvance5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(Current5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomance5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosed5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOther5to10Year,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(Deposit5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDeposit5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDeposit5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(NBC5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilities5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssued5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(Borrowing5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOther5to10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(Equity5to10Year,1,8)).replace(',',''))
				})

		CellRow = 11
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHandBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalanceBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankAssetBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(MarketableSecuritiesBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvanceBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(CurrentBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(NonPerfomanceBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(PropertiesForeclosedBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetOtherBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=3
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(DepositBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(DemandDepositBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(TimeDepositBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(InterbankLiabilitiesBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(SecuritiesIssuedBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowingBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesOtherBigger10Year,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(EquityBigger10Year,1,8	)).replace(',',''))
				})

		Result.update({'TableHeader':TableHeader,'ReportHeader':ReportHeader,'Data':Data, 'Excel': Excel})

		CellStyle = {
					'A7':'bottom*medium,FF000000',
					'B7':'bottom*medium,FF000000',
					'J7':'bottom*medium,FF000000',
					'A8':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000:bottom*medium,FF000000',
					'B8':'top*medium,FF000000:bottom*medium,FF000000:right*medium,FF000000:left*medium,FF000000',
					'C8':'top*medium,FF000000:left*thin,FF000000:bottom*medium,FF000000',
					'D8':'top*medium,FF000000:bottom*medium,FF000000',
					'E8':'top*medium,FF000000:bottom*medium,FF000000',
					'F8':'top*medium,FF000000:bottom*medium,FF000000',
					'G8':'top*medium,FF000000:bottom*medium,FF000000',
					'H8':'top*medium,FF000000:bottom*medium,FF000000',
					'I8':'top*medium,FF000000:bottom*medium,FF000000',
					'J8':'top*medium,FF000000:right*medium,FF000000:bottom*medium,FF000000',
					'A9':'top*medium,FF000000:bottom*medium,FF000000:left*medium,FF000000',
					'B9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'C9':'right*medium,FF000000:top*medium,FF000000:bottom*medium,FF000000',
					'J9':'right*medium,FF000000',
					'A10':'left*medium,FF000000:top*medium,FF000000:right*thin,FF000000',
					'B10':'top*medium,FF000000',
					}

		return Result,CellStyle

	except Exception, e:
		raise

def getLoanContract():
	BankDate 	= mktdate.getBankDate()
	now 		= datetime.datetime.now()
	NextMonth1  = BankDate + relativedelta.relativedelta(months=1)
	NextMonth2 	= BankDate + relativedelta.relativedelta(months=2)
	NextMonth3 	= BankDate + relativedelta.relativedelta(months=3)
	NextMonth4 	= BankDate + relativedelta.relativedelta(months=4)
	NextMonth5 	= BankDate + relativedelta.relativedelta(months=5)
	NextMonth6 	= BankDate + relativedelta.relativedelta(months=6)
	NextMonth7 	= BankDate + relativedelta.relativedelta(months=7)
	NextMonth8 	= BankDate + relativedelta.relativedelta(months=8)
	NextMonth9 	= BankDate + relativedelta.relativedelta(months=9)
	NextMonth10 = BankDate + relativedelta.relativedelta(months=10)
	NextMonth11 = BankDate + relativedelta.relativedelta(months=11)
	NextMonth12 = BankDate + relativedelta.relativedelta(months=12)
	NextYear1   = (BankDate + relativedelta.relativedelta(years=1)).year
	NextYear2   = (BankDate + relativedelta.relativedelta(years=2)).year
	NextYear3 	= (BankDate + relativedelta.relativedelta(years=3)).year
	NextYear4 	= (BankDate + relativedelta.relativedelta(years=4)).year
	NextYear5 	= (BankDate + relativedelta.relativedelta(years=5)).year
	NextYear6 	= (BankDate + relativedelta.relativedelta(years=6)).year
	NextYear7 	= (BankDate + relativedelta.relativedelta(years=7)).year
	NextYear8 	= (BankDate + relativedelta.relativedelta(years=8)).year
	NextYear9 	= (BankDate + relativedelta.relativedelta(years=9)).year
	NextYear10 	= (BankDate + relativedelta.relativedelta(years=10)).year
	NumberOfYear1 = isLeapYear(NextYear1)
	NumberOfYear2 = isLeapYear(NextYear2)
	NumberOfYear3 = isLeapYear(NextYear3)
	NumberOfYear4 = isLeapYear(NextYear4)
	NumberOfYear5 = isLeapYear(NextYear5)
	NumberOfYear6 = isLeapYear(NextYear6)
	NumberOfYear7 = isLeapYear(NextYear7)
	NumberOfYear8 = isLeapYear(NextYear8)
	NumberOfYear9 = isLeapYear(NextYear9)
	NumberOfYear10 = isLeapYear(NextYear10)
	NumberOfYear1To2Years = NumberOfYear1 + NumberOfYear2
	NumberOfYear2To5Years = NumberOfYear1To2Years + NumberOfYear3 + NumberOfYear4 + NumberOfYear5
	NumberOfYear5To10Years = NumberOfYear2To5Years + NumberOfYear6 + NumberOfYear7 + NumberOfYear8 + NumberOfYear9 + NumberOfYear10
	NumberOfDay1Month = calendar.monthrange(BankDate.year, NextMonth1.month)[1]
	NumberOfDay2Month = calendar.monthrange(BankDate.year, NextMonth2.month)[1]
	NumberOfDay3Month = calendar.monthrange(BankDate.year, NextMonth3.month)[1]
	NumberOfDay4Month = calendar.monthrange(BankDate.year, NextMonth4.month)[1]
	NumberOfDay5Month = calendar.monthrange(BankDate.year, NextMonth5.month)[1]
	NumberOfDay6Month = calendar.monthrange(BankDate.year, NextMonth6.month)[1]
	NumberOfDay7Month = calendar.monthrange(BankDate.year, NextMonth7.month)[1]
	NumberOfDay8Month = calendar.monthrange(BankDate.year, NextMonth8.month)[1]
	NumberOfDay9Month = calendar.monthrange(BankDate.year, NextMonth9.month)[1]
	NumberOfDay10Month = calendar.monthrange(BankDate.year, NextMonth10.month)[1]
	NumberOfDay11Month = calendar.monthrange(BankDate.year, NextMonth11.month)[1]
	NumberOfDay12Month = calendar.monthrange(BankDate.year, NextMonth12.month)[1]
	NumberOfDay1To3Months = NumberOfDay1Month + NumberOfDay2Month + NumberOfDay3Month
	NumberOfDay3To6Months = NumberOfDay1To3Months + NumberOfDay4Month + NumberOfDay5Month + NumberOfDay6Month
	NumberOfDay6To12Months = NumberOfDay3To6Months + NumberOfDay7Month + NumberOfDay8Month + NumberOfDay9Month + NumberOfDay10Month + NumberOfDay11Month + NumberOfDay12Month
	
	LoanContractObj = db.session.query(
								MKT_LOAN_CONTRACT.Branch,
								MKT_LOAN_CONTRACT.OutstandingAmount.label('OutstandingAmount'),
								MKT_LOAN_CONTRACT.AccrInterest.label('Interest'),
								MKT_LOAN_CONTRACT.AssetClass,
								case([(
										(func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) <= NumberOfDay1Month ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('Smaller1Month'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay1Month,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay1To3Months) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OneToThreeMonths'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay1To3Months,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay3To6Months) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('ThreeToSixMonths'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay3To6Months,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay6To12Months) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('SixToTwelveMonths'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay6To12Months,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear1To2Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OneToTwoYears'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear1To2Years,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear2To5Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('TwoToFiveYears'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear2To5Years,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear5To10Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('FiveToTenYears'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear5To10Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OverTenYears'),
								).filter(MKT_LOAN_CONTRACT.MaturityDate >= str(BankDate)).\
								  filter(MKT_LOAN_CONTRACT.AssetClass == '0')
										 
	return LoanContractObj
def isLeapYear(year):
	Leap    = year % 4
	if Leap == 0: # year is leap 1-29
		days = 366
		return days
	else: #year is non leap 1-28
		days = 365
		return days