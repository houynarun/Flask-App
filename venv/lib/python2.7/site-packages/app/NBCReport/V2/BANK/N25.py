# -*- coding: utf-8 -*-
'''
Report Name: 	MONTHLY REPORT ON MATURITY PROFILE
				
URL 		: 	/Morakot/Report/NBC/N21
'''


from app.mktcore.imports 		import *
import app.tools.mktnbc			as mktnbc
from app.GLBalance.models         import MKT_GL_BALANCE, MKT_GL_BALANCE_BACKUP
from app.Currency.models        import MKT_CURRENCY

import app.tools.mktdate         as mktdate
import app.tools.mktsetting     as mktsetting
import app.tools.mktmoney         as mktmoney
import app.tools.mktnbc            as mktnbc
import app.tools.mktgl             as mktgl
import app.tools.mktmessage     as mktmessage
from decimal                     import Decimal
import app.NBCReport.V2.BANK.BankSetting  as NBCBankSetting
from app.NBCReport.V2.BANK.N27 		import *
from app.LoanContract.models 			import *
import app.tools.mktdate            as mktdate
import calendar
import datetime
from dateutil import relativedelta
# import datedelta


def getGLValueForField(Branch = "ALL", Period = 2,NBCBank25Key='', NBCExchangeRateDict={},**Kargs):
	return NBCBankSetting.getGLValueFromField(Branch, Period, "NBCBankN25",NBCBank25Key, NBCExchangeRateDict,**Kargs)

def getBANK25(Branch="ALL", ReportedDate="",Period=2,Month = "", Year = ""):
	''' 
		This function must return result like below:
		Result = {
			'Data': 		Data,
			'Excel': 		Excel,
			'ReportHeader': ReportHeader,
			'TableHeader': 	TableHeader
			}
	'''

	try:
		
		Result 			= {}
		Data 			= []
		Excel 			= {}
		ReportHeader 	= {}
		ReportHeader 	= mktnbc.getHeaderReport(	ReportName 		=	u'MONTHLY REPORT ON INTEREST SENSITIVITY GAP',
													Title 			=	u'របាយការណ៍ប្រចាំខែស្ដីពី គំលាតវេទយិតភាពការប្រាក់',
													Form 			=	'Int. Sensitivity'
													)
		ReportingRate 	= ReportHeader.get('ReportingRate',0)
		Excel.update({
				"D5" : ReportHeader.get('CompanyName',""),
				"D6" : ReportHeader.get('CompanyName',""),
				"D3" : u'កាលបរិច្ឆេទ: %s'%ReportHeader.get('ReportedDate',""),
				"D4" : u'As Of: %s'%ReportHeader.get('ReportedDate',""),
				"K8" : Decimal(ReportHeader.get('ReportingRate',0)),
				"K7" : Decimal(ReportHeader.get('ReportingRate',0))
			})
		Condition 	= []
		if Year and Month:
			GLTable       = MKT_GL_BALANCE_BACKUP
			Condition     = [GLTable.GLYear == Year,GLTable.GLMonth == Month]
			CYear         = Year
			CMonth        = Month
		else:
			GLTable       = MKT_GL_BALANCE
			BankDate      = mktdate.getBankDate()
			CYear         = BankDate.year
			CMonth        = BankDate.month
		GLObj             = GLTable.query.filter(*Condition)
		Kargs             = {'GLTable':GLTable, 'GLObj':GLObj, 'FCY':True}
		CurrencyDic       =   mktnbc.getNBCExchangeRate(CYear, CMonth)

		TableHeader 	= {}
		TableHeader 	= mktnbc.setTableHeader(Text=u'ពិពណ៌នា Description', 
											Rowspan=4,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'រហូតដល់​ ១ ខែ\n1 month​ or less', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'លើសពី​ ១ ខែ​ ដល់ ៣ ខែ\n> 1-3 months', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'លើសពី​ ៣ ខែ​ ដល់ ៦ ខែ\n3-6 months', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")

		TableHeader 	= mktnbc.setTableHeader(Text=u'លើសពី​ ៦ ខែ​ ដល់ ១២ ខែ\n6- 12 months', 
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		TableHeader 	= mktnbc.setTableHeader(Text=u'លើសពី​ ១ ឆ្នាំ ដល់ ៣ ឆ្នាំ\n1-3 years',
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		TableHeader 	= mktnbc.setTableHeader(Text=u'លើសពី​ ៣ ឆ្នាំ ដល់ ៥ ឆ្នាំ\n3-5 years',
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'លើសពី​ ៥ ឆ្នាំ\nOver 5 years',
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'គ្មានអត្រាការប្រាក់\nNonInterest Sensitive',
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		TableHeader 	= mktnbc.setTableHeader(Text=u'សរុប\nTotal ',
											Rowspan=0,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")
		#----------------------------------------------------------------------------------------------------------------#
		
		CashOnHandSmaller1Month      = getGLValueForField(Branch, Period, 'CashOnHandSmaller1Month', CurrencyDic, **Kargs)
		CashOnHand1to3Months      	 = getGLValueForField(Branch, Period, 'CashOnHand1to3Months', CurrencyDic, **Kargs)
		CashOnHand3to6Months      	 = getGLValueForField(Branch, Period, 'CashOnHand3to6Months', CurrencyDic, **Kargs)
		CashOnHand6to12Months      	 = getGLValueForField(Branch, Period, 'CashOnHand6to12Months', CurrencyDic, **Kargs)
		CashOnHand1to3Years      	 = getGLValueForField(Branch, Period, 'CashOnHand1to3Years', CurrencyDic, **Kargs)
		CashOnHand3to5Years      	 = getGLValueForField(Branch, Period, 'CashOnHand3to5Years', CurrencyDic, **Kargs)
		CashOnHandOver5Years      	 = getGLValueForField(Branch, Period, 'CashOnHandOver5Years', CurrencyDic, **Kargs)
		CashOnHandNonInterest 		 = getGLValueForField(Branch, Period, 'CashOnHandNonInterest', CurrencyDic, **Kargs)
		CashOnHandTotal				 = CashOnHandSmaller1Month + CashOnHand1to3Months + CashOnHand3to6Months + CashOnHand6to12Months + CashOnHand1to3Years + CashOnHand3to5Years + CashOnHandOver5Years + CashOnHandNonInterest

		NBCBalanceSmaller1Month      = getGLValueForField(Branch, Period, 'NBCBalanceSmaller1Month', CurrencyDic, **Kargs)
		NBCBalance1to3Months      	 = getGLValueForField(Branch, Period, 'NBCBalance1to3Months', CurrencyDic, **Kargs)
		NBCBalance3to6Months      	 = getGLValueForField(Branch, Period, 'NBCBalance3to6Months', CurrencyDic, **Kargs)
		NBCBalance6to12Months      	 = getGLValueForField(Branch, Period, 'NBCBalance6to12Months', CurrencyDic, **Kargs)
		NBCBalance1to3Years      	 = getGLValueForField(Branch, Period, 'NBCBalance1to3Years', CurrencyDic, **Kargs)
		NBCBalance3to5Years      	 = getGLValueForField(Branch, Period, 'NBCBalance3to5Years', CurrencyDic, **Kargs)
		NBCBalanceOver5Years      	 = getGLValueForField(Branch, Period, 'NBCBalanceOver5Years', CurrencyDic, **Kargs)
		NBCBalanceNonInterest 		 = getGLValueForField(Branch, Period, 'NBCBalanceNonInterest', CurrencyDic, **Kargs)
		NBCBalanceTotal				 = float(NBCBalanceSmaller1Month) + float(NBCBalance1to3Months) + float(NBCBalance3to6Months) + float(NBCBalance6to12Months) + float(NBCBalance1to3Years) + float(NBCBalance3to5Years) + float(NBCBalanceOver5Years) + float(NBCBalanceNonInterest)

		AssetBalanceOtherBankSmaller1Month       = getGLValueForField(Branch, Period, 'AssetBalanceOtherBankSmaller1Month', CurrencyDic, **Kargs)
		AssetBalanceOtherBank1to3Months      	 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBank1to3Months', CurrencyDic, **Kargs)
		AssetBalanceOtherBank3to6Months      	 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBank3to6Months', CurrencyDic, **Kargs)
		AssetBalanceOtherBank6to12Months      	 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBank6to12Months', CurrencyDic, **Kargs)
		AssetBalanceOtherBank1to3Years      	 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBank1to3Years', CurrencyDic, **Kargs)
		AssetBalanceOtherBank3to5Years      	 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBank3to5Years', CurrencyDic, **Kargs)
		AssetBalanceOtherBankOver5Years      	 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBankOver5Years', CurrencyDic, **Kargs)
		AssetBalanceOtherBankNonInterest 		 = getGLValueForField(Branch, Period, 'AssetBalanceOtherBankNonInterest', CurrencyDic, **Kargs)
		AssetBalanceOtherBankTotal				 = float(AssetBalanceOtherBankSmaller1Month) + float(AssetBalanceOtherBank1to3Months) + float(AssetBalanceOtherBank3to6Months) + float(AssetBalanceOtherBank6to12Months) + float(AssetBalanceOtherBank1to3Years) + float(AssetBalanceOtherBank3to5Years) + float(AssetBalanceOtherBankOver5Years) + float(AssetBalanceOtherBankNonInterest)

		NBCBankFieldSetting 				= NBCBankSetting.getNBCBankFieldSetting('NBCBankN25')
		PlacementsLocalBankSmaller1Month 	= NBCBankFieldSetting.get('PlacementsLocalBankSmaller1Month',0)
		PlacementsLocalBank1to3Months		= NBCBankFieldSetting.get('PlacementsLocalBank1to3Months',0)
		PlacementsLocalBank3to6Months 		= NBCBankFieldSetting.get('PlacementsLocalBank3to6Months',0)
		PlacementsLocalBank6to12Months		= NBCBankFieldSetting.get('PlacementsLocalBank6to12Months',0)
		PlacementsLocalBank1to3Years 		= NBCBankFieldSetting.get('PlacementsLocalBank1to3Years',0)
		PlacementsLocalBank3to5Years		= NBCBankFieldSetting.get('PlacementsLocalBank3to5Years',0)
		PlacementsLocalBankOver5Years 		= NBCBankFieldSetting.get('PlacementsLocalBankOver5Years',0)
		PlacementsLocalBankNonInterest		= NBCBankFieldSetting.get('PlacementsLocalBankNonInterest',0)
		PlacementsLocalBankTotal			= float(PlacementsLocalBankSmaller1Month) + float(PlacementsLocalBank1to3Months) + float(PlacementsLocalBank3to6Months) + float(PlacementsLocalBank6to12Months) + float(PlacementsLocalBank1to3Years) + float(PlacementsLocalBank3to5Years) + float(PlacementsLocalBankOver5Years) + float(PlacementsLocalBankNonInterest)
		
		OtherLoansAndAdvancesSmaller1Month 	= NBCBankFieldSetting.get('OtherLoansAndAdvancesSmaller1Month',0)
		OtherLoansAndAdvances1to3Months		= NBCBankFieldSetting.get('OtherLoansAndAdvances1to3Months',0)
		OtherLoansAndAdvances3to6Months 	= NBCBankFieldSetting.get('OtherLoansAndAdvances3to6Months',0)
		OtherLoansAndAdvances6to12Months	= NBCBankFieldSetting.get('OtherLoansAndAdvances6to12Months',0)
		OtherLoansAndAdvances1to3Years 		= NBCBankFieldSetting.get('OtherLoansAndAdvances1to3Years',0)
		OtherLoansAndAdvances3to5Years		= NBCBankFieldSetting.get('OtherLoansAndAdvances3to5Years',0)
		OtherLoansAndAdvancesOver5Years 	= NBCBankFieldSetting.get('OtherLoansAndAdvancesOver5Years',0)
		OtherLoansAndAdvancesNonInterest	= NBCBankFieldSetting.get('OtherLoansAndAdvancesNonInterest',0)
		OtherLoansAndAdvancesTotal			= float(OtherLoansAndAdvancesSmaller1Month) + float(OtherLoansAndAdvances1to3Months) + float(OtherLoansAndAdvances3to6Months) + float(OtherLoansAndAdvances6to12Months) + float(OtherLoansAndAdvances1to3Years) + float(OtherLoansAndAdvances3to5Years) + float(OtherLoansAndAdvancesOver5Years) + float(OtherLoansAndAdvancesNonInterest)
		
		LoanContractObj 		= getLoanContract()
		LoanTermSmaller1Month 	= 0
		LoanTerm1to3Months 		= 0
		LoanTerm3to6Months 		= 0
		LoanTerm6to12Months 	= 0
		LoanTerm1to3Years 		= 0
		LoanTerm3to5Years 		= 0 
		LoanTermOver5Years 		= 0
		LoanTermNonInterest 	= 0
		LoanTermTotal 			= 0
		if LoanContractObj[0]:
			for row in LoanContractObj[0]:
				LoanTermSmaller1Month 	+= Decimal(row.Smaller1Month) * ReportingRate / 1000000
				LoanTerm1to3Months 		+= Decimal(row.OneToThreeMonths) * ReportingRate / 1000000
				LoanTerm3to6Months 		+= Decimal(row.ThreeToSixMonths) * ReportingRate / 1000000
				LoanTerm6to12Months 	+= Decimal(row.SixToTwelveMonths) * ReportingRate / 1000000
				LoanTerm1to3Years 		+= Decimal(row.OneToThreeYears) * ReportingRate / 1000000
				LoanTerm3to5Years 		+= Decimal(row.ThreeToFiveYears) * ReportingRate / 1000000
				LoanTermOver5Years 		+= Decimal(row.OverFiveYears) * ReportingRate / 1000000
				LoanTermNonInterest 	+= Decimal(row.NonInterest) * ReportingRate / 1000000
				LoanTermTotal 			 = float(LoanTermSmaller1Month)+float(LoanTerm1to3Months)+float(LoanTerm3to6Months)+float(LoanTerm6to12Months)+float(LoanTerm1to3Years)+float(LoanTerm3to5Years)+float(LoanTermOver5Years)+float(LoanTermNonInterest)
		OverdraftSmaller1Month = 0
		Overdraft1to3Months    = 0
		Overdraft3to6Months    = 0
		Overdraft6to12Months   = 0
		Overdraft1to3Years 	   = 0
		Overdraft3to5Years 	   = 0 
		OverdraftOver5Years    = 0
		OverdraftNonInterest   = 0
		OverdraftTotal 		   = 0
		if LoanContractObj[1]:
			for row in LoanContractObj[1]:
				OverdraftSmaller1Month 	+= Decimal(row.Smaller1Month) * ReportingRate / 1000000
				Overdraft1to3Months 	+= Decimal(row.OneToThreeMonths) * ReportingRate / 1000000
				Overdraft3to6Months 	+= Decimal(row.ThreeToSixMonths) * ReportingRate / 1000000
				Overdraft6to12Months 	+= Decimal(row.SixToTwelveMonths) * ReportingRate / 1000000
				Overdraft1to3Years 		+= Decimal(row.OneToThreeYears) * ReportingRate / 1000000
				Overdraft3to5Years 		+= Decimal(row.ThreeToFiveYears) * ReportingRate / 1000000
				OverdraftOver5Years 	+= Decimal(row.OverFiveYears) * ReportingRate / 1000000
				OverdraftNonInterest 	+= Decimal(0)
				OverdraftTotal 			 = float(OverdraftSmaller1Month)+float(Overdraft1to3Months)+float(Overdraft3to6Months)+float(Overdraft6to12Months)+float(Overdraft1to3Years)+float(Overdraft3to5Years)+float(OverdraftOver5Years)+float(OverdraftNonInterest)
		LoanAndAdvancesSmaller1Month 	= float(LoanTermSmaller1Month)+float(OverdraftSmaller1Month) +float(OtherLoansAndAdvancesSmaller1Month)
		LoanAndAdvances1to3Months 		= float(LoanTerm1to3Months) + float(Overdraft1to3Months) + float(OtherLoansAndAdvances1to3Months)
		LoanAndAdvances3to6Months 		= float(LoanTerm3to6Months)+float(Overdraft3to6Months) + float(OtherLoansAndAdvances3to6Months)
		LoanAndAdvances6to12Months 		= float(LoanTerm6to12Months)+float(Overdraft6to12Months) +float(OtherLoansAndAdvances6to12Months)
		LoanAndAdvances1to3Years 		= float(LoanTerm1to3Years) + float(Overdraft1to3Years) + float(OtherLoansAndAdvances1to3Years)
		LoanAndAdvances3to5Years 		= float(LoanTerm3to5Years)+ float(Overdraft3to5Years) + float(OtherLoansAndAdvances3to5Years)
		LoanAndAdvancesOver5Years 		= float(LoanTermOver5Years)+float(OverdraftOver5Years) + float(OtherLoansAndAdvancesOver5Years)
		LoanAndAdvancesNonInterest 		= float(LoanTermNonInterest)+float(OverdraftNonInterest) + float(OtherLoansAndAdvancesNonInterest)
		LoanAndAdvancesTotal 			= float(LoanTermTotal) + float(OverdraftTotal) + float(OtherLoansAndAdvancesTotal)

		AssetFinancialInstrumentsSmaller1Month 	= NBCBankFieldSetting.get('AssetFinancialInstrumentsSmaller1Month',0)
		AssetFinancialInstruments1to3Months		= NBCBankFieldSetting.get('AssetFinancialInstruments1to3Months',0)
		AssetFinancialInstruments3to6Months 	= NBCBankFieldSetting.get('AssetFinancialInstruments3to6Months',0)
		AssetFinancialInstruments6to12Months	= NBCBankFieldSetting.get('AssetFinancialInstruments6to12Months',0)
		AssetFinancialInstruments1to3Years 		= NBCBankFieldSetting.get('AssetFinancialInstruments1to3Years',0)
		AssetFinancialInstruments3to5Years		= NBCBankFieldSetting.get('AssetFinancialInstruments3to5Years',0)
		AssetFinancialInstrumentsOver5Years 	= NBCBankFieldSetting.get('AssetFinancialInstrumentsOver5Years',0)
		AssetFinancialInstrumentsNonInterest	= NBCBankFieldSetting.get('AssetFinancialInstrumentsNonInterest',0)
		AssetFinancialInstrumentsTotal			= float(AssetFinancialInstrumentsSmaller1Month) + float(AssetFinancialInstruments1to3Months) + float(AssetFinancialInstruments3to6Months) + float(AssetFinancialInstruments6to12Months) + float(AssetFinancialInstruments1to3Years) + float(AssetFinancialInstruments3to5Years) + float(AssetFinancialInstrumentsOver5Years) + float(AssetFinancialInstrumentsNonInterest)
		
		OtherAssetSmaller1Month      = getGLValueForField(Branch, Period, 'OtherAssetSmaller1Month', CurrencyDic, **Kargs)
		OtherAsset1to3Months      	 = getGLValueForField(Branch, Period, 'OtherAsset1to3Months', CurrencyDic, **Kargs)
		OtherAsset3to6Months      	 = getGLValueForField(Branch, Period, 'OtherAsset3to6Months', CurrencyDic, **Kargs)
		OtherAsset6to12Months      	 = getGLValueForField(Branch, Period, 'OtherAsset6to12Months', CurrencyDic, **Kargs)
		OtherAsset1to3Years      	 = getGLValueForField(Branch, Period, 'OtherAsset1to3Years', CurrencyDic, **Kargs)
		OtherAsset3to5Years      	 = getGLValueForField(Branch, Period, 'OtherAsset3to5Years', CurrencyDic, **Kargs)
		OtherAssetOver5Years      	 = getGLValueForField(Branch, Period, 'OtherAssetOver5Years', CurrencyDic, **Kargs)
		OtherAssetNonInterest 		 = getGLValueForField(Branch, Period, 'OtherAssetNonInterest', CurrencyDic, **Kargs)
		OtherAssetTotal				 = float(OtherAssetSmaller1Month) + float(OtherAsset1to3Months) + float(OtherAsset3to6Months) + float(OtherAsset6to12Months) + float(OtherAsset1to3Years) + float(OtherAsset3to5Years) + float(OtherAssetOver5Years) + float(OtherAssetNonInterest)
		
		FinancialAssetsSmaller1Month = float(CashOnHandSmaller1Month)+float(NBCBalanceSmaller1Month)+float(AssetBalanceOtherBankSmaller1Month)+float(PlacementsLocalBankSmaller1Month)+float(LoanAndAdvancesSmaller1Month)+float(AssetFinancialInstrumentsSmaller1Month)+float(OtherAssetSmaller1Month)
		FinancialAssets1to3Months	 = float(CashOnHand1to3Months)+float(NBCBalance1to3Months)+float(AssetBalanceOtherBank1to3Months)+float(PlacementsLocalBank1to3Months)+float(LoanAndAdvances1to3Months)+float(AssetFinancialInstruments1to3Months)+float(OtherAsset1to3Months)
		FinancialAssets3to6Months	 = float(CashOnHand3to6Months)+float(NBCBalance3to6Months)+float(AssetBalanceOtherBank3to6Months)+float(PlacementsLocalBank3to6Months)+float(LoanAndAdvances3to6Months)+float(AssetFinancialInstruments3to6Months)+float(OtherAsset3to6Months)
		FinancialAssets6to12Months	 = float(CashOnHand6to12Months)+float(NBCBalance6to12Months)+float(AssetBalanceOtherBank6to12Months)+float(PlacementsLocalBank6to12Months)+float(LoanAndAdvances6to12Months)+float(AssetFinancialInstruments6to12Months)+float(OtherAsset6to12Months)
		FinancialAssets1to3Years	 = float(CashOnHand1to3Years)+float(NBCBalance1to3Years)+float(AssetBalanceOtherBank1to3Years)+float(PlacementsLocalBank1to3Years)+float(LoanAndAdvances1to3Years)+float(AssetFinancialInstruments1to3Years)+float(OtherAsset1to3Years)
		FinancialAssets3to5Years	 = float(CashOnHand3to5Years)+float(NBCBalance3to5Years)+float(AssetBalanceOtherBank3to5Years)+float(PlacementsLocalBank3to5Years)+float(LoanAndAdvances3to5Years)+float(AssetFinancialInstruments3to5Years)+float(OtherAsset3to5Years)
		FinancialAssetsOver5Years	 = float(CashOnHandOver5Years)+float(NBCBalanceOver5Years)+float(AssetBalanceOtherBankOver5Years)+float(PlacementsLocalBankOver5Years)+float(LoanAndAdvancesOver5Years)+float(AssetFinancialInstrumentsOver5Years)+float(OtherAssetOver5Years)
		FinancialAssetsNonInterest	 = float(CashOnHandNonInterest)+float(NBCBalanceNonInterest)+float(AssetBalanceOtherBankNonInterest)+float(PlacementsLocalBankNonInterest)+float(LoanAndAdvancesNonInterest)+float(AssetFinancialInstrumentsNonInterest)+float(OtherAssetNonInterest)
		FinancialAssetsTotal		 = float(FinancialAssetsSmaller1Month)+float(FinancialAssets1to3Months)+float(FinancialAssets3to6Months)+float(FinancialAssets6to12Months)+float(FinancialAssets1to3Years)+float(FinancialAssets3to5Years)+float(FinancialAssetsOver5Years)+float(FinancialAssetsNonInterest)

		Data.append({
						1:u"1.ទ្រព្យសកម្មហិរញ្ញវត្ថុ​ Financial Assets",
						2:u'%s' %mktmoney.formatNumber(float(FinancialAssetsSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(FinancialAssets1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(FinancialAssets3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(FinancialAssets6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(FinancialAssets1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(FinancialAssets3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(FinancialAssetsOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(FinancialAssetsNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(FinancialAssetsTotal),1,2),
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})
		Data.append({
						1:u"1.1.សាច់ប្រាក់ក្នុងដៃ Cash on hand",
						2:u'%s' %mktmoney.formatNumber(float(CashOnHandSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(CashOnHand1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(CashOnHand3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(CashOnHand6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(CashOnHand1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(CashOnHand3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(CashOnHandOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(CashOnHandNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(CashOnHandTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.2.សមតុល្យនៅធនាគារជាតិនៃកម្ពុជា Balances with NBC​​",
						2:u'%s' %mktmoney.formatNumber(float(NBCBalanceSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(NBCBalance1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(NBCBalance3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(NBCBalance6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(NBCBalance1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(NBCBalance3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(NBCBalanceOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(NBCBalanceNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(NBCBalanceTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.3.សមតុល្យជាមួយធនាគារផេ្សងទៀត Balances with other banks",
						2:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBankSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBank1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBank3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBank6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBank1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBank3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBankOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBankNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(AssetBalanceOtherBankTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.4.ប្រាក់បញ្ញើជាមួយធនាគារក្នុងស្រុក Placements with local banks",
						2:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBankSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBank1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBank3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBank6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBank1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBank3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBankOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBankNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(PlacementsLocalBankTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.5.ឥណទាននិងបុរេប្រទានចំពោះអតិថិជនLoans and advances to customers",
						2:u'%s' %mktmoney.formatNumber(float(LoanAndAdvancesSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(LoanAndAdvances1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(LoanAndAdvances3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(LoanAndAdvances6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(LoanAndAdvances1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(LoanAndAdvances3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(LoanAndAdvancesOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(LoanAndAdvancesNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(LoanAndAdvancesTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.5.1.ឥណទានមានកាលកំណត់ Term Loan​​s ",
						2:u'%s' %mktmoney.formatNumber(float(LoanTermSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(LoanTerm1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(LoanTerm3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(LoanTerm6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(LoanTerm1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(LoanTerm3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(LoanTermOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(LoanTermNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(LoanTermTotal),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.5.2.ឥណទានវិបារូបន៍ Overdraft​​ ",
						2:u'%s' %mktmoney.formatNumber(float(OverdraftSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(Overdraft1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(Overdraft3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(Overdraft6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(Overdraft1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(Overdraft3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(OverdraftOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(OverdraftNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(OverdraftTotal),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.5.3.ផ្សេងៗ Other ",
						2:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvancesSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvances1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvances3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvances6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvances1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvances3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvancesOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvancesNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(OtherLoansAndAdvancesTotal),1,2),
						'LineType':'LD',
						'Indent':2,
						'RowBGColor':'',
						'LineFormat':'',
					})

		Data.append({
						1:u"1.6.ឧបករណ៏ហិរញ្ញវត្ថុ Financial Instruments",
						2:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstrumentsSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstruments1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstruments3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstruments6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstruments1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstruments3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstrumentsOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstrumentsNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(AssetFinancialInstrumentsTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"1.7.ទ្រព្យសកម្មផេ្សងៗ Other assets",
						2:u'%s' %mktmoney.formatNumber(float(OtherAssetSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(OtherAsset1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(OtherAsset3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(OtherAsset6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(OtherAsset1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(OtherAsset3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(OtherAssetOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(OtherAssetNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(OtherAssetTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		# Liabilities
		LiabilitiesBalanceOtherBankSmaller1Month     = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBankSmaller1Month', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBank1to3Months      	 = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBank1to3Months', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBank3to6Months      	 = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBank3to6Months', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBank6to12Months       = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBank6to12Months', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBank1to3Years      	 = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBank1to3Years', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBank3to5Years      	 = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBank3to5Years', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBankOver5Years      	 = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBankOver5Years', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBankNonInterest 		 = getGLValueForField(Branch, Period, 'LiabilitiesBalanceOtherBankNonInterest', CurrencyDic, **Kargs)
		LiabilitiesBalanceOtherBankTotal			 = float(LiabilitiesBalanceOtherBankSmaller1Month) + float(LiabilitiesBalanceOtherBank1to3Months) + float(LiabilitiesBalanceOtherBank3to6Months) + float(LiabilitiesBalanceOtherBank6to12Months) + float(LiabilitiesBalanceOtherBank1to3Years) + float(LiabilitiesBalanceOtherBank3to5Years) + float(LiabilitiesBalanceOtherBankOver5Years) + float(LiabilitiesBalanceOtherBankNonInterest)

		ResultAccountingObj 					 = getAccountObj()
		CustomerDepositAndOtherNonInterest 		 = 0
		CustomerDepositAndOtherSmaller1Month	 = getGLValueForField(Branch, Period, 'CustomerDepositAndOtherSmaller1Month', CurrencyDic, **Kargs)
		CustomerDepositAndOther1to3Months      	 = getGLValueForField(Branch, Period, 'CustomerDepositAndOther1to3Months', CurrencyDic, **Kargs)
		CustomerDepositAndOther3to6Months      	 = getGLValueForField(Branch, Period, 'CustomerDepositAndOther3to6Months', CurrencyDic, **Kargs)
		CustomerDepositAndOther6to12Months       = getGLValueForField(Branch, Period, 'CustomerDepositAndOther6to12Months', CurrencyDic, **Kargs)
		CustomerDepositAndOther1to3Years      	 = getGLValueForField(Branch, Period, 'CustomerDepositAndOther1to3Years', CurrencyDic, **Kargs)
		CustomerDepositAndOther3to5Years      	 = getGLValueForField(Branch, Period, 'CustomerDepositAndOther3to5Years', CurrencyDic, **Kargs)
		CustomerDepositAndOtherOver5Years      	 = getGLValueForField(Branch, Period, 'CustomerDepositAndOtherOver5Years', CurrencyDic, **Kargs)
		if ResultAccountingObj:
			for row in ResultAccountingObj:
				CustomerDepositAndOtherNonInterest   = row.AvailableBal
		CustomerDepositAndOtherTotal				 = float(CustomerDepositAndOtherSmaller1Month) + float(CustomerDepositAndOther1to3Months) + float(CustomerDepositAndOther3to6Months) + float(CustomerDepositAndOther6to12Months) + float(CustomerDepositAndOther1to3Years) + float(CustomerDepositAndOther3to5Years) + float(CustomerDepositAndOtherOver5Years) + float(CustomerDepositAndOtherNonInterest)

		BorrowedFundsSmaller1Month       = getGLValueForField(Branch, Period, 'BorrowedFundsSmaller1Month', CurrencyDic, **Kargs)
		BorrowedFunds1to3Months      	 = getGLValueForField(Branch, Period, 'BorrowedFunds1to3Months', CurrencyDic, **Kargs)
		BorrowedFunds3to6Months      	 = getGLValueForField(Branch, Period, 'BorrowedFunds3to6Months', CurrencyDic, **Kargs)
		BorrowedFunds6to12Months      	 = getGLValueForField(Branch, Period, 'BorrowedFunds6to12Months', CurrencyDic, **Kargs)
		BorrowedFunds1to3Years      	 = getGLValueForField(Branch, Period, 'BorrowedFunds1to3Years', CurrencyDic, **Kargs)
		BorrowedFunds3to5Years      	 = getGLValueForField(Branch, Period, 'BorrowedFunds3to5Years', CurrencyDic, **Kargs)
		BorrowedFundsOver5Years      	 = getGLValueForField(Branch, Period, 'BorrowedFundsOver5Years', CurrencyDic, **Kargs)
		BorrowedFundsNonInterest 		 = getGLValueForField(Branch, Period, 'BorrowedFundsNonInterest', CurrencyDic, **Kargs)
		BorrowedFundsTotal				 = float(BorrowedFundsSmaller1Month) + float(BorrowedFunds1to3Months) + float(BorrowedFunds3to6Months) + float(BorrowedFunds6to12Months) + float(BorrowedFunds1to3Years) + float(BorrowedFunds3to5Years) + float(BorrowedFundsOver5Years) + float(BorrowedFundsNonInterest)
		
		LiabilitiesFinancialInstrumentsSmaller1Month 	= NBCBankFieldSetting.get('LiabilitiesFinancialInstrumentsSmaller1Month',0)
		LiabilitiesFinancialInstruments1to3Months		= NBCBankFieldSetting.get('LiabilitiesFinancialInstruments1to3Months',0)
		LiabilitiesFinancialInstruments3to6Months 		= NBCBankFieldSetting.get('LiabilitiesFinancialInstruments3to6Months',0)
		LiabilitiesFinancialInstruments6to12Months		= NBCBankFieldSetting.get('LiabilitiesFinancialInstruments6to12Months',0)
		LiabilitiesFinancialInstruments1to3Years 		= NBCBankFieldSetting.get('LiabilitiesFinancialInstruments1to3Years',0)
		LiabilitiesFinancialInstruments3to5Years		= NBCBankFieldSetting.get('LiabilitiesFinancialInstruments3to5Years',0)
		LiabilitiesFinancialInstrumentsOver5Years 		= NBCBankFieldSetting.get('LiabilitiesFinancialInstrumentsOver5Years',0)
		LiabilitiesFinancialInstrumentsNonInterest		= NBCBankFieldSetting.get('LiabilitiesFinancialInstrumentsNonInterest',0)
		LiabilitiesFinancialInstrumentsTotal			= float(LiabilitiesFinancialInstrumentsSmaller1Month) + float(LiabilitiesFinancialInstruments1to3Months) + float(LiabilitiesFinancialInstruments3to6Months) + float(LiabilitiesFinancialInstruments6to12Months) + float(LiabilitiesFinancialInstruments1to3Years) + float(LiabilitiesFinancialInstruments3to5Years) + float(LiabilitiesFinancialInstrumentsOver5Years) + float(LiabilitiesFinancialInstrumentsNonInterest)

		OtherLiabilitiesSmaller1Month		= getGLValueForField(Branch, Period, 'OtherLiabilitiesSmaller1Month', CurrencyDic, **Kargs)
		OtherLiabilities1to3Months			= getGLValueForField(Branch, Period, 'OtherLiabilities1to3Months', CurrencyDic, **Kargs)
		OtherLiabilities3to6Months			= getGLValueForField(Branch, Period, 'OtherLiabilities3to6Months', CurrencyDic, **Kargs)
		OtherLiabilities6to12Months			= getGLValueForField(Branch, Period, 'OtherLiabilities6to12Months', CurrencyDic, **Kargs)
		OtherLiabilities1to3Years			= getGLValueForField(Branch, Period, 'OtherLiabilities1to3Years', CurrencyDic, **Kargs)
		OtherLiabilities3to5Years			= getGLValueForField(Branch, Period, 'OtherLiabilities3to5Years', CurrencyDic, **Kargs)
		OtherLiabilitiesOver5Years			= getGLValueForField(Branch, Period, 'OtherLiabilitiesOver5Years', CurrencyDic, **Kargs)
		OtherLiabilitiesNonInterest			= getGLValueForField(Branch, Period, 'OtherLiabilitiesNonInterest', CurrencyDic, **Kargs)
		OtherLiabilitiesTotal				= float(OtherLiabilitiesSmaller1Month) + float(OtherLiabilities1to3Months) + float(OtherLiabilities3to6Months) + float(OtherLiabilities6to12Months) + float(OtherLiabilities1to3Years) + float(OtherLiabilities3to5Years) + float(OtherLiabilitiesOver5Years) + float(OtherLiabilitiesNonInterest)

		EquitiesSmaller1Month		= getGLValueForField(Branch, Period, 'EquitiesSmaller1Month', CurrencyDic, **Kargs)
		Equities1to3Months			= getGLValueForField(Branch, Period, 'Equities1to3Months', CurrencyDic, **Kargs)
		Equities3to6Months			= getGLValueForField(Branch, Period, 'Equities3to6Months', CurrencyDic, **Kargs)
		Equities6to12Months			= getGLValueForField(Branch, Period, 'Equities6to12Months', CurrencyDic, **Kargs)
		Equities1to3Years			= getGLValueForField(Branch, Period, 'Equities1to3Years', CurrencyDic, **Kargs)
		Equities3to5Years			= getGLValueForField(Branch, Period, 'Equities3to5Years', CurrencyDic, **Kargs)
		EquitiesOver5Years			= getGLValueForField(Branch, Period, 'EquitiesOver5Years', CurrencyDic, **Kargs)
		EquitiesNonInterest			= getGLValueForField(Branch, Period, 'EquitiesNonInterest', CurrencyDic, **Kargs)
		EquitiesTotal				= float(EquitiesSmaller1Month) + float(Equities1to3Months) + float(Equities3to6Months) + float(Equities6to12Months) + float(Equities1to3Years) + float(Equities3to5Years) + float(EquitiesOver5Years) + float(EquitiesNonInterest)
		
		FinancialLiabilitiesSmaller1Month 	= float(LiabilitiesBalanceOtherBankSmaller1Month) + float(CustomerDepositAndOtherSmaller1Month) + float(BorrowedFundsSmaller1Month) + float(LiabilitiesFinancialInstrumentsSmaller1Month) + float(OtherLiabilitiesSmaller1Month) + float(EquitiesSmaller1Month)
		FinancialLiabilities1to3Months 		= float(LiabilitiesBalanceOtherBank1to3Months) + float(CustomerDepositAndOther1to3Months) + float(BorrowedFunds1to3Months) + float(LiabilitiesFinancialInstruments1to3Months) + float(OtherLiabilities1to3Months) + float(Equities1to3Months)
		FinancialLiabilities3to6Months 		= float(LiabilitiesBalanceOtherBank3to6Months) + float(CustomerDepositAndOther3to6Months) + float(BorrowedFunds3to6Months) + float(LiabilitiesFinancialInstruments3to6Months) + float(OtherLiabilities3to6Months) + float(Equities3to6Months)
		FinancialLiabilities6to12Months 	= float(LiabilitiesBalanceOtherBank6to12Months) + float(CustomerDepositAndOther6to12Months) + float(BorrowedFunds6to12Months) + float(LiabilitiesFinancialInstruments6to12Months) + float(OtherLiabilities6to12Months) + float(Equities6to12Months)
		FinancialLiabilities1to3Years 		= float(LiabilitiesBalanceOtherBank1to3Years) + float(CustomerDepositAndOther1to3Years) + float(BorrowedFunds1to3Years) + float(LiabilitiesFinancialInstruments1to3Years) + float(OtherLiabilities1to3Years) + float(Equities1to3Years)
		FinancialLiabilities3to5Years 		= float(LiabilitiesBalanceOtherBank3to5Years) + float(CustomerDepositAndOther3to5Years) + float(BorrowedFunds3to5Years) + float(LiabilitiesFinancialInstruments3to5Years) + float(OtherLiabilities3to5Years) + float(Equities3to5Years)
		FinancialLiabilitiesOver5Years 		= float(LiabilitiesBalanceOtherBankOver5Years) + float(CustomerDepositAndOtherOver5Years) + float(BorrowedFundsOver5Years) + float(LiabilitiesFinancialInstrumentsOver5Years) + float(OtherLiabilitiesOver5Years) + float(EquitiesOver5Years)
		FinancialLiabilitiesNonInterest 	= float(LiabilitiesBalanceOtherBankNonInterest) + float(CustomerDepositAndOtherNonInterest) + float(BorrowedFundsNonInterest) + float(LiabilitiesFinancialInstrumentsNonInterest) + float(OtherLiabilitiesNonInterest) + float(EquitiesNonInterest)
		FinancialLiabilitiesTotal 			= float(FinancialLiabilitiesSmaller1Month)+float(FinancialLiabilities1to3Months)+float(FinancialLiabilities3to6Months)+float(FinancialLiabilities6to12Months)+float(FinancialLiabilities1to3Years)+float(FinancialLiabilities3to5Years)+float(FinancialLiabilitiesOver5Years)+float(FinancialLiabilitiesNonInterest)
		Data.append({
						1:u"2- ទ្រព្យអកម្មហិរញ្ញវត្ថុ Financial liabilities ",
						2:u'%s' %mktmoney.formatNumber(float(FinancialLiabilitiesSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(FinancialLiabilities1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(FinancialLiabilities3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(FinancialLiabilities6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(FinancialLiabilities1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(FinancialLiabilities3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(FinancialLiabilitiesOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(FinancialLiabilitiesNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(FinancialLiabilitiesTotal),1,2),
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'

					})
		
		Data.append({
						1:u"2.1- សមតុល្យរបស់ធនាគារដ៏ទៃទៀត Balances of other banks",
						2:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBankSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBank1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBank3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBank6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBank1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBank3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBankOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBankNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(LiabilitiesBalanceOtherBankTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"2.2- ប្រាក់បញ្ញើអតិថិជននិងផ្សេងៗ Customer deposits and others",
						2:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOtherSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOther1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOther3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOther6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOther1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOther3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOtherOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOtherNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(CustomerDepositAndOtherTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"2.3- មូលនិធិដែលបានខ្ចី Borrowed Funds",
						2:u'%s' %mktmoney.formatNumber(float(BorrowedFundsSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(BorrowedFunds1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(BorrowedFunds3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(BorrowedFunds6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(BorrowedFunds1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(BorrowedFunds3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(BorrowedFundsOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(BorrowedFundsNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(BorrowedFundsTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"2.4- ឧបករណ៏ហិរញ្ញវត្ថុ  Financial Instruments",
						2:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstrumentsSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstruments1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstruments3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstruments6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstruments1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstruments3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstrumentsOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstrumentsNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(LiabilitiesFinancialInstrumentsTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		
		Data.append({
						1:u"2.5- ទ្រព្យអកម្មផេ្សងៗ  Other liabilities",
						2:u'%s' %mktmoney.formatNumber(float(OtherLiabilitiesSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(OtherLiabilities1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(OtherLiabilities3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(OtherLiabilities6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(OtherLiabilities1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(OtherLiabilities3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(OtherLiabilitiesOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(OtherLiabilitiesNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(OtherLiabilitiesTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		Data.append({
						1:u"2.6- មូលនិធិ Equities",
						2:u'%s' %mktmoney.formatNumber(float(EquitiesSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(Equities1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(Equities3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(Equities6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(Equities1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(Equities3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(EquitiesOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(EquitiesNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(EquitiesTotal),1,2),
						'LineType':'LD',
						'Indent':1,
						'RowBGColor':'',
						'LineFormat':'',
					})
		InterestGAPSmaller1Month = float(FinancialAssetsSmaller1Month) - float(FinancialLiabilitiesSmaller1Month)
		InterestGAP1to3Months 	 = float(FinancialAssets1to3Months) - float(FinancialLiabilities1to3Months)
		InterestGAP3to6Months 	 = float(FinancialAssets3to6Months) - float(FinancialLiabilities3to6Months)
		InterestGAP6to12Months 	 = float(FinancialAssets6to12Months) - float(FinancialLiabilities6to12Months)
		InterestGAP1to3Years 	 = float(FinancialAssets1to3Years) - float(FinancialLiabilities1to3Years)
		InterestGAP3to5Years 	 = float(FinancialAssets3to5Years) - float(FinancialLiabilities3to5Years)
		InterestGAPOver5Years 	 = float(FinancialAssetsOver5Years) - float(FinancialLiabilitiesOver5Years)
		InterestGAPNonInterest 	 = float(FinancialAssetsNonInterest) - float(FinancialLiabilitiesNonInterest)
		InterestGAPTotal 		 = float(FinancialAssetsTotal)- float(FinancialLiabilitiesTotal)

		Data.append({
						1:u"គំលាតការប្រាក់វេទយិតភាព Interest sensitivity​ gap  (1) - (2) ",
						2:u'%s' %mktmoney.formatNumber(float(InterestGAPSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(InterestGAP1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(InterestGAP3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(InterestGAP6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(InterestGAP1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(InterestGAP3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(InterestGAPOver5Years),1,2),
						9:u'%s' %mktmoney.formatNumber(float(InterestGAPNonInterest),1,2),
						10:u'%s' %mktmoney.formatNumber(float(InterestGAPTotal),1,2),
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'
					})

		CumulativeInterestGAPSmaller1Month 		= InterestGAPSmaller1Month
		CumulativeInterestGAP1to3Months 	 	= float(InterestGAP1to3Months) + float(CumulativeInterestGAPSmaller1Month)
		CumulativeInterestGAP3to6Months 	 	= float(InterestGAP3to6Months) + float(CumulativeInterestGAP1to3Months)
		CumulativeInterestGAP6to12Months 	 	= float(InterestGAP6to12Months) + float(CumulativeInterestGAP3to6Months)
		CumulativeInterestGAP1to3Years			= float(InterestGAP1to3Years) + float(CumulativeInterestGAP6to12Months)
		CumulativeInterestGAP3to5Years			= float(InterestGAP3to5Years) + float(CumulativeInterestGAP1to3Years)
		CumulativeInterestGAPOver5Years			= float(InterestGAPOver5Years) + float(CumulativeInterestGAP3to5Years)

		Data.append({
						1:u"វេទយិតភាពការប្រាក់បង្គ​រ Cumulative Interest Sensitivity gap",
						2:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAPSmaller1Month),1,2),
						3:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAP1to3Months),1,2),
						4:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAP3to6Months),1,2),
						5:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAP6to12Months),1,2),
						6:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAP1to3Years),1,2),
						7:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAP3to5Years),1,2),
						8:u'%s' %mktmoney.formatNumber(float(CumulativeInterestGAPOver5Years),1,2),
						9:u'',
						10:u'',
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':'bold'
					})
		#E Column
		CellRow  = 12
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHandSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalanceSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBankSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBankSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvancesSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTermSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(OverdraftSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvancesSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstrumentsSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAssetSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBankSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOtherSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFundsSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstrumentsSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilitiesSmaller1Month,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"E%s"%(CellRow) : float(str(mktmoney.formatNumber(EquitiesSmaller1Month,1,8)).replace(',',''))
				})
		#F Column
		CellRow = 12
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBank1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBank1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvances1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTerm1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Overdraft1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvances1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstruments1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAsset1to3Months,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBank1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOther1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFunds1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstruments1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilities1to3Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"F%s"%(CellRow) : float(str(mktmoney.formatNumber(Equities1to3Months,1,8)).replace(',',''))
				})
		# G Column
		CellRow = 12
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBank3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBank3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvances3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTerm3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(Overdraft3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvances3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstruments3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAsset3to6Months,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBank3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOther3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFunds3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstruments3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilities3to6Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"G%s"%(CellRow) : float(str(mktmoney.formatNumber(Equities3to6Months,1,8)).replace(',',''))
				})
		#H Column
		CellRow = 12
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBank6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBank6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvances6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTerm6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(Overdraft6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvances6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstruments6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAsset6to12Months,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBank6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOther6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFunds6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstruments6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilities6to12Months,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"H%s"%(CellRow) : float(str(mktmoney.formatNumber(Equities6to12Months,1,8)).replace(',',''))
				})
		# I Column
		CellRow =12
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBank1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBank1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvances1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTerm1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(Overdraft1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvances1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstruments1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAsset1to3Years,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBank1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOther1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFunds1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstruments1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilities1to3Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"I%s"%(CellRow) : float(str(mktmoney.formatNumber(Equities1to3Years,1,8)).replace(',',''))
				})
		# J Colunm
		CellRow =12
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHand3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalance3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBank3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBank3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvances3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTerm3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(Overdraft3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvances3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstruments3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAsset3to5Years,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBank3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOther3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFunds3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstruments3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilities3to5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"J%s"%(CellRow) : float(str(mktmoney.formatNumber(Equities3to5Years,1,8)).replace(',',''))
				})
		# K Column
		CellRow =12
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHandOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalanceOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBankOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBankOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvancesOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTermOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(OverdraftOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvancesOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstrumentsOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAssetOver5Years,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBankOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOtherOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFundsOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstrumentsOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilitiesOver5Years,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"K%s"%(CellRow) : float(str(mktmoney.formatNumber(EquitiesOver5Years,1,8)).replace(',',''))
				})
		# L Column
		CellRow =12
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(CashOnHandNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(NBCBalanceNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetBalanceOtherBankNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(PlacementsLocalBankNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanAndAdvancesNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(LoanTermNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(OverdraftNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLoansAndAdvancesNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(AssetFinancialInstrumentsNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherAssetNonInterest,1,8)).replace(',',''))
				})
		CellRow +=2
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesBalanceOtherBankNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(CustomerDepositAndOtherNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(BorrowedFundsNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(LiabilitiesFinancialInstrumentsNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(OtherLiabilitiesNonInterest,1,8)).replace(',',''))
				})
		CellRow +=1
		Excel.update({
					"L%s"%(CellRow) : float(str(mktmoney.formatNumber(EquitiesNonInterest,1,8)).replace(',',''))
				})

		
		Result.update({'TableHeader':TableHeader,'ReportHeader':ReportHeader,'Data':Data, 'Excel': Excel})

		CellStyle = {
					'A9':'top*medium,FF000000',
					'B9':'top*medium,FF000000',
					'C9':'top*medium,FF000000',
					'D9':'top*medium,FF000000',
					'E9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'F9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'G9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'H9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'I9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'J9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'K9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'L9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'M9':'top*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'A10':'bottom*medium,FF000000',
					'B10':'bottom*medium,FF000000',
					'C10':'bottom*medium,FF000000',
					'D10':'bottom*medium,FF000000',
					'E10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'F10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'G10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'H10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'I10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'J10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'K10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'L10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					'M10':'bottom*medium,FF000000:left*medium,FF000000:right*medium,FF000000',
					}
		return Result,CellStyle
	except Exception, e:
		raise

def getLoanContract():
	BankDate 	= mktdate.getBankDate()
	now 		= datetime.datetime.now()
	NextMonth1  = BankDate + relativedelta.relativedelta(months=1)
	NextMonth2 	= BankDate + relativedelta.relativedelta(months=2)
	NextMonth3 	= BankDate + relativedelta.relativedelta(months=3)
	NextMonth4 	= BankDate + relativedelta.relativedelta(months=4)
	NextMonth5 	= BankDate + relativedelta.relativedelta(months=5)
	NextMonth6 	= BankDate + relativedelta.relativedelta(months=6)
	NextMonth7 	= BankDate + relativedelta.relativedelta(months=7)
	NextMonth8 	= BankDate + relativedelta.relativedelta(months=8)
	NextMonth9 	= BankDate + relativedelta.relativedelta(months=9)
	NextMonth10 = BankDate + relativedelta.relativedelta(months=10)
	NextMonth11 = BankDate + relativedelta.relativedelta(months=11)
	NextMonth12 = BankDate + relativedelta.relativedelta(months=12)
	NextYear1   = (BankDate + relativedelta.relativedelta(years=1)).year
	NextYear2	= (BankDate + relativedelta.relativedelta(years=2)).year
	NextYear3 	= (BankDate + relativedelta.relativedelta(years=3)).year
	NextYear4 	= (BankDate + relativedelta.relativedelta(years=4)).year
	NextYear5 	= (BankDate + relativedelta.relativedelta(years=5)).year
	NumberOfYear1 = isLeapYear(NextYear1)
	NumberOfYear2 = isLeapYear(NextYear2)
	NumberOfYear3 = isLeapYear(NextYear3)
	NumberOfYear4 = isLeapYear(NextYear4)
	NumberOfYear5 = isLeapYear(NextYear5)
	NumberOfYear1To3Years = NumberOfYear1 + NumberOfYear2 + NumberOfYear3
	NumberOfYear3To5Years = NumberOfYear1To3Years + NumberOfYear4 + NumberOfYear5
	NumberOfDay1Month = calendar.monthrange(BankDate.year, NextMonth1.month)[1]
	NumberOfDay2Month = calendar.monthrange(BankDate.year, NextMonth2.month)[1]
	NumberOfDay3Month = calendar.monthrange(BankDate.year, NextMonth3.month)[1]
	NumberOfDay4Month = calendar.monthrange(BankDate.year, NextMonth4.month)[1]
	NumberOfDay5Month = calendar.monthrange(BankDate.year, NextMonth5.month)[1]
	NumberOfDay6Month = calendar.monthrange(BankDate.year, NextMonth6.month)[1]
	NumberOfDay7Month = calendar.monthrange(BankDate.year, NextMonth7.month)[1]
	NumberOfDay8Month = calendar.monthrange(BankDate.year, NextMonth8.month)[1]
	NumberOfDay9Month = calendar.monthrange(BankDate.year, NextMonth9.month)[1]
	NumberOfDay10Month = calendar.monthrange(BankDate.year, NextMonth10.month)[1]
	NumberOfDay11Month = calendar.monthrange(BankDate.year, NextMonth11.month)[1]
	NumberOfDay12Month = calendar.monthrange(BankDate.year, NextMonth12.month)[1]
	NumberOfDay1To3Months = NumberOfDay1Month + NumberOfDay2Month + NumberOfDay3Month
	NumberOfDay3To6Months = NumberOfDay1To3Months + NumberOfDay4Month + NumberOfDay5Month + NumberOfDay6Month
	NumberOfDay6To12Months = NumberOfDay3To6Months + NumberOfDay7Month + NumberOfDay8Month + NumberOfDay9Month + NumberOfDay10Month + NumberOfDay11Month + NumberOfDay12Month
	
	LoanContractObj = db.session.query(
								MKT_LOAN_CONTRACT.Branch,
								MKT_LOAN_CONTRACT.OutstandingAmount.label('OutstandingAmount'),
								MKT_LOAN_CONTRACT.AccrInterest.label('Interest'),
								case([(
										(func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) <= NumberOfDay1Month ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('Smaller1Month'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay1Month,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay1To3Months) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OneToThreeMonths'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay1To3Months,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay3To6Months) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('ThreeToSixMonths'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay3To6Months,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay6To12Months) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('SixToTwelveMonths'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay6To12Months,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear1To3Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OneToThreeYears'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear1To3Years,func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear3To5Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('ThreeToFiveYears'),
								case([(
										and_((func.DATE(MKT_LOAN_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear3To5Years) ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OverFiveYears'),
								case([(
										MKT_LOAN_CONTRACT.AccrInterest == 0 ,
										(cast(MKT_LOAN_CONTRACT.OutstandingAmount,Float) + cast(MKT_LOAN_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('NonInterest'),
								).filter(MKT_LOAN_CONTRACT.MaturityDate >= str(BankDate))
	OverDraftObj  	=	db.session.query(MKT_OVERDRAFT_CONTRACT.Branch,
										 MKT_OVERDRAFT_CONTRACT.OutstandingAmount,
										 MKT_OVERDRAFT_CONTRACT.AccrInterest,
								case([(
										(func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) <= NumberOfDay1Month ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('Smaller1Month'),
								case([(
										and_((func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay1Month,func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay1To3Months,MKT_OVERDRAFT_CONTRACT.AccrInterest >= 0) ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OneToThreeMonths'),
								case([(
										and_((func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay1To3Months,func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay3To6Months,MKT_OVERDRAFT_CONTRACT.AccrInterest >= 0) ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('ThreeToSixMonths'),
								case([(
										and_((func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay3To6Months,func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfDay6To12Months,MKT_OVERDRAFT_CONTRACT.AccrInterest >= 0) ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('SixToTwelveMonths'),
								case([(
										and_((func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfDay6To12Months,func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear1To3Years,MKT_OVERDRAFT_CONTRACT.AccrInterest >= 0) ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OneToThreeYears'),
								case([(
										and_((func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear1To3Years,func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate) <= NumberOfYear3To5Years,MKT_OVERDRAFT_CONTRACT.AccrInterest >= 0) ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('ThreeToFiveYears'),
								case([(
										and_((func.DATE(MKT_OVERDRAFT_CONTRACT.MaturityDate)-func.DATE(BankDate)) >= NumberOfYear3To5Years,MKT_OVERDRAFT_CONTRACT.AccrInterest >= 0) ,
										(cast(MKT_OVERDRAFT_CONTRACT.OutstandingAmount,Float) + cast(MKT_OVERDRAFT_CONTRACT.AccrInterest, Float))
									)],
								else_=0
								).label('OverFiveYears'),
								).filter(MKT_OVERDRAFT_CONTRACT.MaturityDate >= str(BankDate))
										 
	return LoanContractObj,OverDraftObj
def isLeapYear(year):
	Leap    = year % 4
	if Leap == 0: # year is leap 1-29
		days = 366
		return days
	else: #year is non leap 1-28
		days = 365
		return days