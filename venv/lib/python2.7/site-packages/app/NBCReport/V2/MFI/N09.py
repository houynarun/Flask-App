# -*- coding: utf-8 -*-
'''
Report Name: 09 (MONTHLY REPORT ON MONEY AND INTERBANK MARKET TRANSACTION)
'''

from app.mktcore.imports 		import *
import app.tools.mktdate 		as mktdate
import app.tools.mktsetting 	as mktsetting
import app.tools.mktmoney 		as mktmoney
import app.tools.mktnbc			as mktnbc
import app.tools.mktgl 			as mktgl
import app.tools.mktmessage 	as mktmessage

from decimal 					import Decimal
def getMFI09(Branch = "ALL"):
	''' This function must return result like below:
			Result = {
				'Data': 		Data,
				'Excel': 		Excel,
				'ReportHeader': ReportHeader,
				'TableHeader': 	TableHeader
				}
	'''
	try:
		
		ReportHeader 	=   mktnbc.getHeaderReport(	ReportName 		=	'MONTHLY REPORT ON MONEY AND INTERBANK MARKET TRANSACTION',
													Title 			=	u'របាយការណ៏ប្រចាំខែសី្តពី រូបិយវត្ថុ និងប្រតិបតិ្តការទីផ្សារអន្តរធនាគារ',
													Form 			=	'9'
												   )
		Result			=   {}
		Data 			= 	[]
		Excel 			= 	{}
		TableHeader 	= 	{}

		TableHeader = mktnbc.setTableHeader(Text=u'ស្ថាប័នហិរញ្ញវត្ថុ\nFinancial Institution', 
									 Rowspan=2,Colspan=2,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ទ្រព្យសកម្ម\nAssets', 
									 Rowspan=0,Colspan=5,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'ប្រភេទ\nType *', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'អត្រាការប្រាក់\nInterest Rate', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ប្រភេទរូបិយប័ណ្ណ\nCurrencies', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ឥណប្រតិទាន\nMaturity', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	
		
		TableHeader = mktnbc.setTableHeader(Text=u'ឥណទានជាក់ស្តែង\nOutstanding', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ទ្រព្យអសកម្ម\nLiabilities', 
									 Rowspan=0,Colspan=5,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'ប្រភេទ\nType *', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'អត្រាការប្រាក់\nInterest Rate', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ប្រភេទរូបិយប័ណ្ណ\nCurrencies', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ឥណប្រតិទាន\nMaturity', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	
		
		TableHeader = mktnbc.setTableHeader(Text=u'ឥណទានជាក់ស្តែង\nOutstanding', 
									 Rowspan=0,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	



		#-----------------------------
		
		Excel.update({				
				"D3" : ReportHeader.get('ReportedDate',""),
				"C4" : ReportHeader.get('CompanyName',""),
				"J5" : Decimal(ReportHeader.get('ReportingRate',0))
			})

		Lists = [("គ្រឹះស្ថានធនាគារ\nBanks",(("Resident **",50),("Non - Resident **",50))),
				 ("គ្រឹះស្ថានមីក្រូរហិរញ្ញវត្ថុ\nMicrofinance Institutions",(("Resident **",50),("Non - Resident **",50))),
				 ("ក្រុមហ៊ុនមូលប័ត្រ\nSecurity Firms",(("Resident **",50),("Non - Resident **",50))),
				 ("ក្រុមហ៊ុនធានារ៉ាប់រង\nInsurance",(("Resident **",50),("Non - Resident **",50))),
				 ("គ្រឹះស្ថានហិរញ្ញវត្ថុផ្សេងទៀត\nOther​ Fis  (***)",(("Resident **",50),("Non - Resident **",50))),
				 ("គ្រឹះស្ថានហិរញ្ញវត្ថុផ្សេងទៀត\nOther​ Fis  (***)",(("Resident **",50),("Non - Resident **",50)))]

		for item in Lists:
			Data.append({
							1:u'',
							2:item[0].decode('utf-8'),
							3:u'',
							4:u'',
							5:u'',
							6:u'',
							7:u'',
							8:u'',
							9:u'',
							10:u'',
							11:u'',
							12:u'',
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':''
						})
			for subItem in item[1]:
				Data.append({
							1:u'',
							2:subItem[0].decode('utf-8'),
							3:u'',
							4:u'',
							5:u'',
							6:u'',
							7:u'',
							8:u'',
							9:u'',
							10:u'',
							11:u'',
							12:u'',
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':''
						})
				i = 1
				while i <= subItem[1]:
					Data.append({
								1:str(i),
								2:u'',
								3:u'',
								4:u'',
								5:u'',
								6:u'',
								7:u'',
								8:u'',
								9:u'',
								10:u'',
								11:u'',
								12:u'',
								'LineType':'GH',
								'Indent':0,
								'RowBGColor':'',
								'LineFormat':''
							})
					i+=1

			Data.append({
								1:u'',
								2:u'សរុបរង ៖\nSub-total :',
								3:u'',
								4:u'',
								5:u'',
								6:u'',
								7:u'',
								8:u'',
								9:u'',
								10:u'',
								11:u'',
								12:u'',
								'LineType':'GH',
								'Indent':0,
								'RowBGColor':mktnbc.BG_BODY_COLOR,
								'LineFormat':''
							})

		Data.append({
						1:u'',
						2:u'សរុប ៖\nTotal all :',
						3:u'',
						4:u'',
						5:u'',
						6:u'',
						7:u'',
						8:u'',
						9:u'',
						10:u'',
						11:u'',
						12:u'',
						'LineType':'GH',
						'Indent':0,
						'RowBGColor':mktnbc.BG_BODY_COLOR,
						'LineFormat':''
					})

		Result.update({'TableHeader':TableHeader,'ReportHeader':ReportHeader,'Data':Data,'Excel':Excel})

		CellSyle = {
					'B6':'top*medium,FF000000',
					'B7':'bottom*thin,FF000000',

					'D6':'top*medium,FF000000',
					'E6':'top*medium,FF000000',
					'F6':'top*medium,FF000000',
					'G6':'top*medium,FF000000:right*thin,FF000000',

					'I6':'top*medium,FF000000',
					'J6':'top*medium,FF000000',
					'K6':'top*medium,FF000000',
					'L6':'top*medium,FF000000:right*thin,FF000000',

					'B423':'top*thin,FF000000:bottom*thin,FF000000',

					'D423':'top*thin,FF000000:bottom*thin,FF000000',
					'E423':'top*thin,FF000000:bottom*thin,FF000000',
					'F423':'top*thin,FF000000:bottom*thin,FF000000',


					'I423':'top*thin,FF000000:bottom*thin,FF000000',
					'J423':'top*thin,FF000000:bottom*thin,FF000000',
					'K423':'top*thin,FF000000:bottom*thin,FF000000',


					'B425':'top*thin,FF000000:bottom*thin,FF000000',
					'C425':'top*thin,FF000000:bottom*thin,FF000000',
					'D425':'top*thin,FF000000:bottom*thin,FF000000',
					'E425':'top*thin,FF000000:bottom*thin,FF000000',
					'F425':'top*thin,FF000000:bottom*thin,FF000000',
					'G425':'top*thin,FF000000:bottom*thin,FF000000',
					'H425':'top*thin,FF000000:bottom*thin,FF000000',
					'I425':'top*thin,FF000000:bottom*thin,FF000000',
					'J425':'top*thin,FF000000:bottom*thin,FF000000',
					'K425':'top*thin,FF000000:bottom*thin,FF000000',
					'L425':'top*thin,FF000000:bottom*thin,FF000000:right*medium,FF000000',

					'B527':'top*thin,FF000000:bottom*thin,FF000000',
					'D527':'top*thin,FF000000:bottom*thin,FF000000',
					'E527':'top*thin,FF000000:bottom*thin,FF000000',
					'F527':'top*thin,FF000000:bottom*thin,FF000000',
					'I527':'top*thin,FF000000:bottom*thin,FF000000',
					'J527':'top*thin,FF000000:bottom*thin,FF000000',
					'K527':'top*thin,FF000000:bottom*thin,FF000000',

					'B528':'bottom*medium,FF000000',
					'D528':'bottom*medium,FF000000',
					'E528':'bottom*medium,FF000000',
					'F528':'bottom*medium,FF000000',
					'I528':'bottom*medium,FF000000',
					'J528':'bottom*medium,FF000000',
					'K528':'bottom*medium,FF000000',

					}

		return Result, CellSyle

	except Exception as e:
		raise

