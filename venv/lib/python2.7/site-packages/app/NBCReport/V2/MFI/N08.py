# -*- coding: utf-8 -*-
'''
Report Name: 08 (MONTHLY REPORT ON SOURCES OF FINANCING)
'''

from app.mktcore.imports 		import *
import app.tools.mktdate 		as mktdate
import app.tools.mktsetting 	as mktsetting
import app.tools.mktmoney 		as mktmoney
import app.tools.mktnbc			as mktnbc
import app.tools.mktgl 			as mktgl
import app.tools.mktmessage 	as mktmessage

from decimal 					import Decimal
def getMFI08(Branch = "ALL"):
	''' This function must return result like below:
			Result = {
				'Data': 		Data,
				'Excel': 		Excel,
				'ReportHeader': ReportHeader,
				'TableHeader': 	TableHeader
				}
	'''
	try:
		
		ReportHeader 	=   mktnbc.getHeaderReport(	ReportName 		=	'MONTHLY REPORT ON SOURCES OF FINANCING',
													Title 			=	u'របាយការណ៍ប្រចាំខែស្តីពី ប្រភពហិរញ្ញប្បទាន',
													Form 			=	'8'
												   )
		Result			=   {}
		Data 			= 	[]
		Excel 			= 	{}
		TableHeader 	= 	{}

		TableHeader = mktnbc.setTableHeader(Text=u'ល.រ \n No.', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

	 	TableHeader = mktnbc.setTableHeader(Text=u'ឈ្មោះឥណទាយក\nName of Creditors', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'Countries (*)', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")		

		TableHeader = mktnbc.setTableHeader(Text=u'Type of loan', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	
		
		TableHeader = mktnbc.setTableHeader(Text=u'ចំនួនទឹកប្រាក់ដែលបានអនុម័ត\nAmount Approved', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'ចំនួនទឹកប្រាក់ដែលបានបញ្ចេញ\nAmount Disbursed', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'Currency', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'លក្ខខណ្ឌកិច្ចសន្យា\nConditions', 
									 Rowspan=0,Colspan=4,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'អត្រាការប្រាក់ប្រចាំឆ្នាំ\nInterest Rate per annum', 
									 Rowspan=2,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'លក្ខខណ្ឌសង\nTerm of Payment', 
									 Rowspan=2,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'កាលបរិច្ឆេទអនុម័ត\nApproved Date', 
									 Rowspan=2,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'កាលអវសាន្ត\nMaturity Date', 
									 Rowspan=2,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'ការទូទាត់សង\nPayment', 
									 Rowspan=0,Colspan=5,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'កាលបរិច្ឆេទ\nDate', 
									 Rowspan=2,Colspan=0,RowIndex=2, TableHeader=TableHeader, Class="text-center")	

		TableHeader = mktnbc.setTableHeader(Text=u'ប្រាក់ដើម\nPrinciple', 
									 Rowspan=0,Colspan=2,RowIndex=2, TableHeader=TableHeader, Class="text-center")

		TableHeader = mktnbc.setTableHeader(Text=u'ក្នុងគ្រា\nCurrent', 
									 Rowspan=0,Colspan=0,RowIndex=3, TableHeader=TableHeader, Class="text-center")

		TableHeader = mktnbc.setTableHeader(Text=u'បង្គរ\nAccumulated', 
									 Rowspan=0,Colspan=0,RowIndex=3, TableHeader=TableHeader, Class="text-center")

		TableHeader = mktnbc.setTableHeader(Text=u'ការប្រាក\nInterest', 
									 Rowspan=0,Colspan=2,RowIndex=2, TableHeader=TableHeader, Class="text-center")

		TableHeader = mktnbc.setTableHeader(Text=u'ក្នុងគ្រា\nCurrent', 
									 Rowspan=0,Colspan=0,RowIndex=3, TableHeader=TableHeader, Class="text-center")

		TableHeader = mktnbc.setTableHeader(Text=u'បង្គរ\nAccumulated', 
									 Rowspan=0,Colspan=0,RowIndex=3, TableHeader=TableHeader, Class="text-center")

		TableHeader = mktnbc.setTableHeader(Text=u'សមតុល្យនៅសល់\nBalance Loan Outstanding', 
									 Rowspan=3,Colspan=0,RowIndex=1, TableHeader=TableHeader, Class="text-center")	

		#-----------------------------
		
		Excel.update({				
				"I3" : ReportHeader.get('ReportedDate',""),
				"C5" : ReportHeader.get('CompanyName',""),
				"O7" : Decimal(ReportHeader.get('ReportingRate',0))
			})

		Lists = [("Resident **",50),("Non - Resident **",200)]

		for item in Lists:
			Data.append({
							1:u'',
							2:item[0],
							3:u'',
							4:u'',
							5:u'',
							6:u'',
							7:u'',
							8:u'',
							9:u'',
							10:u'',
							11:u'',
							12:u'',
							13:u'',
							14:u'',
							15:u'',
							16:u'',
							17:u'',
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':''
						})
			i = 1
			while i <= item[1]:
				Data.append({
							1:str(i),
							2:u'',
							3:u'',
							4:u'',
							5:u'',
							6:u'',
							7:u'',
							8:u'',
							9:u'',
							10:u'',
							11:u'',
							12:u'',
							13:u'',
							14:u'',
							15:u'',
							16:u'',
							17:u'',
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':'',
							'LineFormat':''
						})
				i+=1

		Data.append({
							1:u'',
							2:u'សរុប\nTOTAL',
							3:u'',
							4:u'',
							5:u'',
							6:u'',
							7:u'',
							8:u'',
							9:u'',
							10:u'',
							11:u'',
							12:u'',
							13:u'',
							14:u'',
							15:u'',
							16:u'',
							17:u'',
							'LineType':'GH',
							'Indent':0,
							'RowBGColor':mktnbc.BG_BODY_COLOR,
							'LineFormat':''
						})

		Result.update({'TableHeader':TableHeader,'ReportHeader':ReportHeader,'Data':Data,'Excel':Excel})
		CellSyle = {
					'B9':'left*thin,FF000000:right*thin,FF000000',
					'B10':'left*thin,FF000000:right*thin,FF000000:bottom*thin,FF000000',
					
					'D9':'left*thin,FF000000:right*thin,FF000000',
					'D10':'left*thin,FF000000:right*thin,FF000000:bottom*thin,FF000000',
					
					'F9':'left*thin,FF000000:right*thin,FF000000',
					'F10':'left*thin,FF000000:right*thin,FF000000:bottom*thin,FF000000',
					
					'H10':'left*thin,FF000000:right*thin,FF000000:bottom*thin,FF000000',
					
					'J10':'left*thin,FF000000:right*thin,FF000000:bottom*thin,FF000000',
					
					'K10':'left*thin,FF000000:right*thin,FF000000:bottom*thin,FF000000',
					
					'M8':'top*medium,FF000000',
					'M10':'bottom*thin,FF000000:left*thin,FF000000',
					
					'N8':'top*medium,FF000000:bottom*thin,FF000000',
					'O8':'top*medium,FF000000',

					'P8':'top*medium,FF000000:bottom*thin,FF000000',


					'Q9':'left*thin,FF000000:right*medium,FF000000',
					'Q10':'right*medium,FF000000:bottom*thin,FF000000',

					'B262':'bottom*medium,FF000000',
					'D262':'bottom*medium,FF000000',
					'Q262':'right*medium,FF000000',

					}

		return Result, CellSyle

	except Exception as e:
		raise

