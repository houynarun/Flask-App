from app.tools.mktreport import *
from app.PD.models import *
from app.Branch.models import *
def getReport():
	# Consolidated Area Report by Branch
	QueryString = db.session.query(
								MKT_PAST_DUE.Branch,
								MKT_BRANCH.Description,
								MKT_PAST_DUE.Currency,
								func.count(MKT_PAST_DUE.LoanID).label('CountLoanID'),
								func.sum(MKT_PAST_DUE.TotODAmount).label('TotODAmount'),
								func.sum(MKT_PAST_DUE.TotPrincipalDue).label('TotPrincipalDue'),
								func.sum(MKT_PAST_DUE.TotInterestDue).label('TotInterestDue'),
								func.sum(MKT_PAST_DUE.TotPenaltyDue).label('TotPenaltyDue'),
								func.sum(MKT_PAST_DUE.TotChargeDue).label('TotChargeDue')).\
								join(MKT_BRANCH, MKT_BRANCH.ID == MKT_PAST_DUE.Branch).\
								group_by(MKT_PAST_DUE.Branch,MKT_BRANCH.Description,MKT_PAST_DUE.Currency)

	return QueryString
