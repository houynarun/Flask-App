from app.mktcore.wtfimports 	import *
from sqlalchemy 				import *
from .models 					import *
from wtforms 					import DecimalField, IntegerField

import app.tools.mktdate 		as mktdate

def loanBankDate():
	return mktdate.getBankDate()


class FRM_PRE_DEFINE_SCHEDULE(exform):
	Description 			= 	TextField("Description", 
								validators=[validators.Required()])
	PrincipalFreq 		= 	IntegerField(requiredlabel("Principal Frequency", "*"),[validators.Required()],default=1)
	InterestFreq 		= 	IntegerField(requiredlabel("Interest Frequency", "*"),[validators.Required()],default=1)
	RepMode 				= 	SelectField(requiredlabel("Repayment Mode", "*"),
								choices=[('1', 'Declining'),
										 ('2', 'Annuity'),
										 ('3', 'Flat'),
										 ('4', 'IRR')],
								coerce=str,
								validators=[validators.Required()])
	FwdBwdKey 				= 	SelectField(requiredlabel("Fwd/Bwd Key", "*"),
								choices=[('0','No Holiday'),
										 ('1','Backward within month'),
										 ('2','Forward within month'),
										 ('3','Backward'),
										 ('4','Forward')],
								coerce=str,
								default='1',
								validators=[validators.Required()])
	ValueDate 				=	DateField("Value Date",validators=[validators.Required()], default=loanBankDate)
	FirstInstallmentDate 	=	DateField("First Installment Date",[validators.Optional()])
	BaseDateKey 			= 	SelectField('Base Date Key',
								choices=[('1', '1. Value Date'),
									 ('2', '2. Previous Date'),
									 ('3', '3. First Date'),
									 ('4', '4. Week Day')],
								coerce=str)
	PaymentHoliday 			= 	TextField("Payment Holiday")
	NumOfHolidayInstallment = 	TextField("Num Of Holiday Installment")
	FreqType 				= 	SelectField(requiredlabel(getLanguage("Frequency Type"), "*"),
								choices=[('1', '1. %s' %getLanguage('Monthly')), 
									 ('2', '2. %s' %getLanguage("Weekly")),
									 ('3', '3. %s' % "Daily")],
								coerce=str,
								validators=[validators.Required()]
							)
	Frequency 				= 	TextField("Frequency",
								default=1,
								validators=[validators.Required()])
	WeekDay 				= 	SelectField("Week Day",
								choices=[('MO', 'Monday'), 
									 ('TU', 'Tuesday'),
									 ('WE', 'Wednesday'),
									 ('TH', 'Thursday'),
									 ('FR', 'Friday'),
									 ('SA', 'Saturday'),
									 ('SU', 'Sunday')],
								coerce=str
							)
	NumOfWeek 				= 	SelectField("Week number",
								choices=[('1','1'), 
									 ('2','2'),
									 ('3','3'),
									 ('4','4'),
									 ('5','5')],
								coerce=str
							)