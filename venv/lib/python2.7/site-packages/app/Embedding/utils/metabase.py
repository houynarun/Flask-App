from .base 		import EmbeddedBase
class MetabaseExtend(EmbeddedBase):
	def GenerateUrl(self):
		import jwt
		ID 	= ""
		METABASE_SITE_URL = self.MainConfig.get('site-url')
		METABASE_SECRET_KEY = self.MainConfig.get('secret-key')
		if 'question' in self.DetailConfig:
			keys = 'question'
			ID = self.DetailConfig.get('question')
		if 'dashboard' in self.DetailConfig:
			ID = self.DetailConfig.get('dashboard')
			keys = 'dashboard'
		payload = {
					"resource": {keys: int(ID)},
					"params": {}
				  }
		token = jwt.encode(payload, METABASE_SECRET_KEY, algorithm="HS256")
		titled = self.DetailConfig.get('titled','true')
		bordered = self.DetailConfig.get('bordered','true')
		theme 	= self.DetailConfig.get('theme','')
		iframeUrl = METABASE_SITE_URL + "/embed/%s/"%(keys) + token.decode("utf8") + "#theme=%s&bordered=%s&titled=%s"%(theme,bordered,titled)
		return iframeUrl





