from app.mktcore.imports import *
from .forms import *
import app.tools.mktteller 		as mktteller
import app.tools.mktparam 		as mktparam
import app.tools.mktmoney 		as mktmoney


registerCRUD(admin, '/IncomeExpenseBooking', 'IncomeExpenseBooking',FRM_INCOME_EXPENSE_BOOKING, [MKT_INCOME_EXPENSE_BOOKING])

@app.route("/Morakot/PendingIncomeExpense", methods=['GET'])
@checkLogOutSession
@checkLogOutTime
def routePendingIncomeExpense():
	IncomeTran 		= ''
	ExpenseTran 	= ''
	ErrorMsg 		= []
	# Block check access right
	getCheck 	= checkAccess ("/Morakot/IncomeExpenseBooking/","ListLive")
	if getCheck != True: 
		ErrorMsg.append(msg_error+msg_permission)
		return render_template("teller/pending_income_expense.html",ErrorMsg=ErrorMsg)
		
	QueryObj = mktteller.getTellerIncomeExpense()[0]
	TellerParam = mktparam.getTellerParam()
	if TellerParam:
		IncomeTran 		= TellerParam.IncomeTran
		ExpenseTran 	= TellerParam.ExpenseTran
		IncomeBookingTran 	= TellerParam.IncomeBookingTran
		ExpenseBookingTran 	= TellerParam.ExpenseBookingTran

	return render_template("teller/pending_income_expense.html",
							ErrorMsg=ErrorMsg,
							float=float,
							toMoney=mktmoney.toMoney,
							CurrencyObj=mktmoney.getCurrencyObj,
							QueryObj=QueryObj,
							IncomeTran=IncomeTran,
							ExpenseTran=ExpenseTran,
							IncomeBookingTran=IncomeBookingTran,
							ExpenseBookingTran=ExpenseBookingTran)