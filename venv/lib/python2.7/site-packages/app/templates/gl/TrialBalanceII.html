{% extends "layout.html" %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='stylesheets/jquery.datatables.css') }}">
    <style>
        h3.header-3{
            color: #888 !important;
            font-size: 16px;
            font-weight: bold;
            margin: 5px 0 10px;
            padding: 10px 18px 0;
        }

        h4.header-4{
            color: #888 !important;
            font-size: 14px;
            font-weight: normal;
            margin: 5px 0 10px;
            padding: 0px 18px 0;
        }

        .se-pre-con1 {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            z-index: 9999;
            background: #FFF url("{{ url_for('static',filename='images/loading.gif') }}") center no-repeat;
            opacity: 0.4;
            display: none;
        }

        .input-sm {

            width: 214px !important;
        }

        .modal-dialog{

            width: 428px !important;

        }

        .form-label{
            padding-top: 7px;
        }

        .modal-body {
            z-index: 99999 !important;
        }

    </style>

{% endblock %}

{% block content %}
    <div class="navbar navbar-default navbar-static-top">
        <div class="col-sm-12">
            <div style="margin-top: 8px;">
                <div class="col-sm-6" style="margin-top: 5px; padding: 0;">
                    <!-- Button Export -->
                    {% from "print.html" import exportButtonLink %}
                    {{exportButtonLink()}}
                </div>

                <div class="col-sm-6" style="padding: 0;">
                    <a id="Verified" href="/Morakot/TrialBalanceII?Branch={{ Branch }}&Verified=Yes" class="btn btn-flat btn-labeled btn-warning pull-right" style="margin-left: 5px;">
                        <span class="btn-label icon fa fa-check"></span> {{ getTextMsg('400005') }}
                    </a>
                    <button type="button" class="btn btn-flat btn-labeled btn-success pull-right" data-toggle="modal" data-target="#getCustomRange">
                        <span class="btn-label icon fa fa-gear"></span> {{ getTextMsg('400002') }}
                    </button>
                </div>
            </div>             
        </div>
    </div>

    <div class="clearfix"></div>
    {% include 'msg_error.html' %}
     <div class="col-sm-12">
        <h3 class="header-3 text-center">{{ BankName }}</h3>
        <h4 class="header-4 text-center">Trial Balance Report</h4>
        <h4 class="header-4 text-center"><strong>Date: </strong> From {{ str(FromDate).replace('00','12') }} To {{ str(ToDate).replace('00','12') }}</h4>
        <h4 class="header-4 text-center"><strong>Branch: </strong> {{ BranchName }}</h4>
    </div>
        {% if VerifiedGLMapping %}
            <div class="col-sm-12">
                
                <div class="alert alert-warning">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    <table >
                        <tr>
                            <th>GL / Consolidate Key</th>
                            <th style="padding-left: 5px;">Description</th>
                        </tr>
                         {%for row in VerifiedGLMapping%}
                            <tr>
                                <td>{{row.ID}}</td>
                                <td style="padding-left: 5px;">{{row.Message}}</td>   
                            </tr>
                         {%endfor%}
                     </table>
                </div>
            </div>
            <div class="clearfix">&nbsp;</div>
        {% elif Verified == "Yes"%}
            <div class="col-sm-12">
                <div class="alert alert-info">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    All consolidate keys are properly mapped!
                </div>
            </div>
            <div class="clearfix">&nbsp;</div>
        {% endif %}
    

        <div class="clearfix">&nbsp;</div>
        
            
        <div class="panel panel-default">
            <table id="mktlist" class="display" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>Acc No</th>
                        <th>Acc Name</th>
                        <th class="text-right" style="padding-right: 35px;">Beginning Debit Balance</th>
                        <th class="text-right" style="padding-right: 35px;">Beginning Credit Balance</th>
                        <th class="text-right" style="padding-right: 35px;">Movement Debit Balance</th>
                        <th class="text-right" style="padding-right: 35px;">Movement Credit Balance</th>
                        <th class="text-right" style="padding-right: 35px;">Ending Debit Balance</th>
                        <th class="text-right" style="padding-right: 35px;">Ending Credit Balance</th>
                    </tr>
                </thead>
                <tbody>
                    {% set TotalAmount = {"DrPreMonth":0, "CrPreMonth":0, "DrBalance":0, "CrBalance":0, "CurrentMonth":0} %}
                    
                    {% for row in TrialBalance: %}

                        {% if row.ID not in HiddenGLLine %}

                            <tr>
                                <td>
                                    {% if row.ID|length == 6 %}
                                        <strong>{{ row.ID }}</strong>
                                    {% else: %}
                                        {{ row.ID }}
                                    {% endif %}
                                </td>
                                <td>
                                {% if row.ID|length == 6 %}
                                        <strong>{{ row.Description }}</strong>
                                    {% else: %}
                                        {{ row.Description }}
                                    {% endif %}
                                </td>
                                <td class="text-right" style="padding-right: 35px;">

                                    {% if int(Period) == 1 %}
                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = row.PrevMonthBal %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = setDecimal(row.YTDBal)-setDecimal(row.CurrentMonthBal) %}
                                            {% endif %}
                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding ) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, Balance, 0, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}
                                        
                                    {% elif int(Period) == 2 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = setDecimal(row.PrevMonthBal) - setDecimal(row.CurrentPrevMonthBal) %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal-row.CurrentMonthBal-row.CurrentPrevMonthBal %}
                                            {% endif %}

                                            {{ formatBalance( Balance ,BaseCurrencyObj,Rounding ) }}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, Balance, 0, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}
                                        
                                    {% elif int(Period) == 3 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = setDecimal(row.PrevYearBal) - setDecimal(row.CurrentPrevYearBal) %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = 0 %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, Balance, 0, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}

                                    {% elif int(Period) == 4 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = row.PrevYearBal %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = 0 %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, Balance, 0, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}
                                        
                                    {% endif %}

                                </td>
                                <td class="text-right" style="padding-right: 35px;">

                                    {% if int(Period) == 1 %}

                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = row.PrevMonthBal %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = setDecimal(row.YTDBal)-setDecimal(row.CurrentMonthBal) %}
                                            {% endif %}
                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, Balance, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}
                                        
                                    {% elif int(Period) == 2 %}

                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = setDecimal(row.PrevMonthBal) - setDecimal(row.CurrentPrevMonthBal) %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal-row.CurrentMonthBal-row.CurrentPrevMonthBal %}
                                            {% endif %}
                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, Balance, 0, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        
                                    {% elif int(Period) == 3 %}

                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = setDecimal(row.PrevYearBal) - setDecimal(row.CurrentPrevYearBal) %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = 0 %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, Balance, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}

                                    {% elif int(Period) == 4 %}

                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = row.PrevYearBal %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = 0 %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, Balance, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}
                                        
                                    {% endif %}

                                </td>
                                {# {% if row.BalanceType == 'Cr' %}<td></td>{% endif %} #}
                                {# <td class="text-right" style="padding-right: 35px;"> #}

                                    {% if int(Period) == 1 %}

                                        {% if row.CurrentMonthBal %}
                                            {% set MovementBal = row.CurrentMonthBal%}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, row.CurrentMonthBal) }}
                                            {% endif %}
                                        {% else %}
                                            {% set MovementBal = 0 %}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, 0) }}
                                            {% endif %}
                                        {% endif %}
                                        {{ renderMovementBalance(MovementBal, BaseCurrencyObj, Rounding,row.BalanceType) }}
                                        
                                    {% elif int(Period) == 2 %}

                                        {% if row.CurrentPrevMonthBal %}
                                            {% set MovementBal = row.CurrentPrevMonthBal %}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, row.CurrentPrevMonthBal) }}
                                            {% endif %}

                                        {% else %}

                                            {% set MovementBal = 0 %}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        {{ renderMovementBalance(MovementBal, BaseCurrencyObj, Rounding,row.BalanceType) }}
                                        
                                    {% elif int(Period) == 3 %}

                                        {% if row.CurrentPrevYearBal %}
                                            {% set MovementBal = row.CurrentPrevYearBal %}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, row.CurrentPrevYearBal) }}
                                            {% endif %}

                                        {% else %}

                                            {% set MovementBal = 0 %}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        {{ renderMovementBalance(MovementBal, BaseCurrencyObj, Rounding,row.BalanceType) }}

                                    {% elif int(Period) == 4 %}

                                        {% if row.YTDBal %}
                                            {% set MovementBal = row.YTDBal %}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, row.YTDBal) }}
                                            {% endif %}

                                        {% else %}
                                            {% set MovementBal = 0 %}

                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        {{ renderMovementBalance(MovementBal, BaseCurrencyObj, Rounding,row.BalanceType) }}
                                        
                                    {% endif %}
                                    
                                </td>
                                {# {% if row.BalanceType == 'Dr' %}<td></td>{% endif %} #}

                                <td class="text-right" style="padding-right: 35px;">

                                    {% if int(Period) == 1 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = row.Balance %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, Balance, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        
                                    {% elif int(Period) == 2 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = setDecimal(row.PrevMonthBal) %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal-row.CurrentMonthBal %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, Balance, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        
                                    {% elif int(Period) == 3 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% if row.ID in PLGL%}
                                                {% set DrBalance = row.CurrentPrevYearBal %}
                                            {% else %}
                                                {% set DrBalance = row.PrevYearBal %}
                                            {% endif %}
                                            {{ formatBalance(DrBalance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, DrBalance, 0, 0) }}
                                            {% endif %}

                                        {% endif %}

                                    {% elif int(Period) == 4 %}

                                        {% if row.BalanceType == 'Dr' %}
                                            {% set Balance = row.Balance %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, Balance, 0, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        
                                    {% endif %}

                                </td>
                                <td class="text-right" style="padding-right: 35px;">

                                    {% if int(Period) == 1 %}
                                        
                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = row.Balance %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, Balance, 0) }}
                                            {% endif %}

                                        {% endif %}

                                    {% elif int(Period) == 2 %}

                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = setDecimal(row.PrevMonthBal) %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal-row.CurrentMonthBal %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding) }}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, Balance, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        
                                    {% elif int(Period) == 3 %}

                                        {% if row.BalanceType == 'Cr' %}

                                            {% if row.ID in PLGL%}
                                                {% set CrBalance = row.CurrentPrevYearBal %}
                                            {% else %}
                                                {% set CrBalance = row.PrevYearBal %}
                                            {% endif %}
                                            {{ formatBalance(CrBalance, BaseCurrencyObj,Rounding)}}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, CrBalance, 0) }}
                                            {% endif %}

                                        {% endif %}

                                    {% elif int(Period) == 4 %}

                                        {% if row.BalanceType == 'Cr' %}
                                            {% set Balance = row.Balance %}
                                            {% if row.ID in PLGL%}
                                                {% set Balance = row.YTDBal %}
                                            {% endif %}

                                            {{ formatBalance(Balance, BaseCurrencyObj,Rounding)}}
                                            
                                            {% if not row.SubGL: %}
                                                {{ getConsolBal(TotalAmount, 0, 0, 0, Balance, 0) }}
                                            {% endif %}

                                        {% endif %}
                                        
                                    {% endif %}

                                </td>
                            </tr>
                        {% endif %}
                        {% if loop.last %}
                       
                        <tr>
                            <td><strong>Total Balance:</strong></td>
                            <td></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['DrPreMonth']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['DrPreMonth'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['CrPreMonth']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['CrPreMonth'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong></strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong></strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['DrBalance']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['DrBalance'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['CrBalance']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['CrBalance'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                        </tr>
                       
                        {% endif %}
                    {% endfor %}
                     <tfoot>
                        <tr>
                            <td><strong>Total Balance:</strong></td>
                            <td></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['DrPreMonth']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['DrPreMonth'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['CrPreMonth']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['CrPreMonth'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong></strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong></strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['DrBalance']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['DrBalance'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                            <td class="text-right" style="padding-right: 35px;"><strong>
                            {# {{ toMoney(setFloat(TotalAmount['CrBalance']), getCurrencyObj(BaseCurrency)) }} #}
                            {{ formatBalance(TotalAmount['CrBalance'], BaseCurrencyObj,Rounding)}}
                            </strong></td>
                        </tr>
                    </tfoot>
                </tbody>
            </table>
        </div>
        {% if ShowPrintBy == 'Yes' %}
            {{PrintByAndDate()|safe}}   
        {% endif %}
        <input type="hidden" id="Period_ID" value="{{ Period }}">
        <input type="hidden" id="Option_ID" value="{{ HideMainGL }}">
        <input type="hidden" id="HideZeroBalance_ID" value="{{ HideZeroBalance }}">
   

{% endblock %}

{% block js %}
    <!-- Call in Block Js -->

    {% from "print.html" import exportIncludeJS %}
    {{exportIncludeJS()}}

    <script type="text/javascript">

        $(document).ready(function() {

            $('#mktlist').dataTable({
                "lengthMenu": [[25,50,100,200, -1], [25,50,100,200, "All"]],
                "bSort" : false
            });

            $("#Apply").click(function(){
               window.parent.$("#animated").fadeIn("slow");
            });
            $("#Verified").click(function(){
               window.parent.$("#animated").fadeIn("slow");
            });

            {% from "print.html" import exportDataTable %}
            {{exportDataTable('#mktlist','Trial Balance Report')}}

        });

    </script>

    <div class="modal fade" id="getCustomRange" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form class="form-horizontal" action="/Morakot/TrialBalanceII" method="GET">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Custom Branch</h4>
                    </div>
                    <div class="modal-body">

                        <div class="form-group">
                            <label for="Branch" class="col-sm-4 control-label">Branch:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control input-sm" value="{{ Branch }}" name="Branch">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="Period" class="col-sm-4 control-label">Period:</label>
                            <div class="col-sm-8">
                        
                                <select id="Period" name="Period" class="input-sm form-control" style="width: 100%;">

                                    <option value="1" {%if PrevOption[2] == '1'%}selected='selected'{%endif%} >Current Month</option>
                                    <option value="2" {%if PrevOption[2] == '2'%}selected='selected'{%endif%} >Current Previous Month</option>
                                    <option value="3" {%if PrevOption[2] == '3'%}selected='selected'{%endif%} >Current Previous Year</option>
                                    <option value="4" {%if PrevOption[2] == '4'%}selected='selected'{%endif%} >Current Year</option>
                                   
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="HideMainGL" class="col-sm-4 control-label"> Hide Main GL:</label>
                            <div class="col-sm-8">
                                <select id="HideMainGL" name="HideMainGL" class="input-sm form-control" style="width: 100%;">
                                    {% if HideMainGL == "Y" %}
                                        <option value="Y" selected>Yes</option>
                                        <option value="N">No</option>
                                    {% else %}
                                        <option value="Y">Yes</option>
                                        <option value="N" selected>No</option>
                                    {% endif %}
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="Rounding" class="col-sm-4 control-label">Rounding:</label>
                            <div class="col-sm-8">
                                <select id="Rounding" name="Rounding" class="input-sm form-control" style="width: 100%;">
                                    {% if Rounding == "Y" %}
                                        <option value="Y" selected>Yes</option>
                                        <option value="N">No</option>
                                    {% else %}
                                        <option value="Y" >Yes</option>
                                        <option value="N" selected>No</option>
                                    {% endif %}
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="HideZeroBalance" class="col-sm-4 control-label">Hide Zero Balance:</label>
                            <div class="col-sm-8">
                                <select id="HideZeroBalance" name="HideZeroBalance" class="input-sm form-control" style="width: 100%;">
                                {% if HideZeroBalance == "Y" %}
                                    <option value="Y" selected>Yes</option>
                                    <option value="N">No</option>
                                {% else %}
                                    <option value="Y">Yes</option>
                                    <option value="N" selected>No</option>
                                {% endif %}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="ShowPrintBy" class="col-sm-4 control-label">Show Print By & Date:</label>
                            <div class="col-sm-8">
                                <select class="form-control input-sm" name="ShowPrintBy" style="width: 100%;" id="ShowPrintBy">
                                    {% if ShowPrintBy == 'Yes' %}
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No" >No</option>
                                    {% else %}
                                        <option value="Yes">Yes</option>
                                        <option value="No" selected>No</option>
                                    {% endif %}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="Currency" class="col-sm-4 control-label"> Currency:</label>
                            <div class="col-sm-8">
                                <select id="Currency" name="Currency" class="input-sm form-control" style="width: 100%;">
                                    <option value="ALL">ALL</option>
                                    {% for item in CurrencyObj %}
                                        <option value="{{ item.ID }}"{% if item.ID == Currency%}selected{% endif %}>{{ item.ID}} </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        {% with class=8,Month=PrevOption[1],Year=PrevOption[0] %}
                        {% include 'gl/AdvanceOption.html' %}
                        {% endwith %}
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary" id="Apply">Apply</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

{% endblock %}

{% macro getConsolBal(TotalAmount, DrPreMonth, CrPreMonth, DrBalance, CrBalance, CurrentMonthBal) %}
    {% if TotalAmount.update({ 

        "DrPreMonth":setDecimal(TotalAmount["DrPreMonth"]) + setDecimal(DrPreMonth),
        "CrPreMonth":setDecimal(TotalAmount["CrPreMonth"]) + setDecimal(CrPreMonth),
        "DrBalance":setDecimal(TotalAmount["DrBalance"]) + setDecimal(DrBalance),
        "CrBalance":setDecimal(TotalAmount["CrBalance"]) + setDecimal(CrBalance),
        "CurrentMonth":setDecimal(TotalAmount["CurrentMonth"]) + setDecimal(CurrentMonthBal)

    }) %}{% endif %}
{% endmacro %}

{% macro renderMovementBalance(Balance, BaseCurrencyObj, Rounding, BalanceType) %}
    
    {% if Balance >= 0 %}

        {% if BalanceType == 'Cr' %}
            <td></td>
            <td class="text-right" style="padding-right: 35px;">
                {{ formatBalance( Balance, BaseCurrencyObj,Rounding) }}
            </td>
        {% else %}
            <td class="text-right" style="padding-right: 35px;">
                {{ formatBalance( Balance, BaseCurrencyObj,Rounding) }}
            </td>
            <td></td>
        {% endif %}

    {% else %}

        {% if BalanceType == 'Cr' %}
            <td class="text-right" style="padding-right: 35px;">
                {{ formatBalance( Balance|abs, BaseCurrencyObj,Rounding) }}
            </td>
            <td></td>
        {% else %}
            <td></td>
            <td class="text-right" style="padding-right: 35px;">
                {{ formatBalance( Balance|abs, BaseCurrencyObj,Rounding) }}
            </td>
        {% endif %}

    {% endif %}

{% endmacro %}