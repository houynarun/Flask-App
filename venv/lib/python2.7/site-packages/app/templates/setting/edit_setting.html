{% extends "layout.html" %}
{% block css %}
	<style>
		.header {
			background-color: #eee;
			padding: 20px 11px 20px 11px;
			margin-bottom: 15px;
		}
	</style>
{% endblock %}
{% block content %}


<form method="post" id="frm" name="frm" role="form" action="/Morakot/AppSetting/Config/{{Application}}">

	<div class="col-sm-12 header">
        {% if Apps %}

            <button style="color: #777; border: none; background: transparent;">
                <span class="btn-label icon fa fa-floppy-o"></span> Save
            </button> &nbsp;&nbsp;&nbsp;
        {% endif %}
			<a href="/Morakot/AppSetting/Config/" id="Cancel" style="color: #777;">
				<span class="btn-label icon fa fa-pencil-square-o"></span>&nbsp; Cancel
			</a>

	</div>
	{% include 'msg_error.html' %}
		
	<input type="hidden" value="{{ Application }}" name="Application">

	<div class="row">
		<div class="col-sm-12">

		<!-- 11. $BOOTSTRAP_TAB_DROP ======================================================================= Stacked pills -->
		<!-- Javascript -->
		<script>
			init.push(function () {
				$('ul.bs-tabdrop-example').tabdrop();
			});
		</script>
		<!-- / Javascript -->

		<div class="panel">
			<div class="panel-heading">
				<span class="panel-title text-bold">{{SettingTitle}}</span>
			</div>
			<div class="panel-body">
				<div class="row">
					<div class="col-sm-12">

						{% if Apps %}
				  			{%if ListGroupByTab.first().GroupBy==None%}

								{% for App in Apps %}
									<input type="hidden" value="{{ App.ID }}" name="IDs[]">
									{{ render_field(App, getValueByType)|safe }}
								{% endfor %}

							{%else%}

								<!-- Tabs -->
								<ul class="nav nav-tabs bs-tabdrop-example">
									{%for row in ListGroupByTab%}
										
											{%if loop.first%}
												<li class="active"><a href="#bs-tabdrop-tab-{{loop.index}}" data-toggle="tab">
												{%if row.GroupBy == None%}
														Default
													{%else%}
														{{row.GroupBy}}
													{%endif%}
												</a></li>
											{%else%}
												<li><a href="#bs-tabdrop-tab-{{loop.index}}" data-toggle="tab">
													{%if row.GroupBy == None%}
														Default
													{%else%}
														{{row.GroupBy}}
													{%endif%}

												</a></li>
											{%endif%}

									{%endfor%}
									
								</ul>
								<div class="tab-content tab-content-bordered">
									{%for row in ListGroupByTab%}
										{%if row.GroupBy != None or row.GroupBy != '' %}
											{%if loop.first%}
												<div class="tab-pane active" id="bs-tabdrop-tab-{{loop.index}}" style="margin-top: 10px;">
													
													 {% for App in Apps.filter_by(GroupBy =  row.GroupBy) %}
												    	<input type="hidden" value="{{ App.ID }}" name="IDs[]">
										        		{{ render_field(App, getValueByType)|safe }}
													{% endfor %}

												</div>
											{%else%}
												<div class="tab-pane" id="bs-tabdrop-tab-{{loop.index}}" style="margin-top: 10px;">
													 {% for App in Apps.filter_by(GroupBy =  row.GroupBy) %}
												    	<input type="hidden" value="{{ App.ID }}" name="IDs[]">
										        		{{ render_field(App, getValueByType)|safe }}
													{% endfor %}
												</div>
											{%endif%}

										{%endif%}

									{%endfor%}
								</div>
							{% endif %}

						{% endif %}

					</div>
					
				</div>
			</div>
		</div>
		<!-- /11. $BOOTSTRAP_TAB_DROP -->

		</div>
	</div>
</form>


{% endblock %}

{% block js %}
	<script type="text/javascript">
		$(document).ready(function() {
			$('select').select2();
		});
	</script>
{% endblock %}

{% macro render_field(FormObj, getValueByType) %}

    <div class="row">
		{%if FormObj.Definition%}
			<!-- Javascript -->
			<script>
				init.push(function () {
					$('#tooltips-demo-{{FormObj.ID}} label').tooltip();
				});
			</script>
			<!-- / Javascript -->
		{%endif%}

        <div class="form-group ">
            <label class="col-sm-3 control-label text-right" for="LOV" style="padding-top: 5px;" id="tooltips-demo-{{FormObj.ID}}">
                <label for="LOV"  class="link tooltip-info" data-toggle="tooltip" data-placement="left" title="" data-original-title="{{FormObj.Definition}}">
                	 {{ FormObj.Description }}
                    <span style="color:#d38e99">*</span>
                </label>
            </label>

            <div class="col-sm-9">

                {% if FormObj.Type == 'I' %}
                    <input type="text" name="Values[]" class="form-control" value="{{ FormObj.Value }}">
                {% elif FormObj.Type == 'S' %}
                    <select name="Values[]" class="form-control">{{ getValueByType(FormObj.LOV, FormObj.Value)|safe }}</select>
                {% elif FormObj.Type == 'T' %}
                    <textarea name="Values[]" class="form-control">{{ FormObj.Value }}</textarea>
                 {% elif FormObj.Type == 'P'%}
    				<input type="password" name="Values[]" class="form-control" value="{{ FormObj.Value }}">
                {% endif %}
                
            </div>
        </div>


    </div>

{% endmacro %}