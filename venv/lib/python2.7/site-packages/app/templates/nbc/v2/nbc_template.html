<!-- 

Create by       : Sovankiry Rim
Create Date     : Tue, 07 Feb 2017
Update By       : .............
Last Update     : .............

Thanks for team for update code more.
Enjoy your work ! :)
 -->

{% macro getHeaderReport(Title,ReportName,AsOf,CompanyName,ReportingRate,SubTitleReport='', NetWorth="")%}

    <div class="clearfix"></div>
    {% include 'msg_error.html' %}

    <!-- Header Report -->
    <div class="col-sm-12">
        <!-- Report Title -->
            <h3 class="header-3 text-center">{{ Title }}</h3>
            <h4 class="text-center">{{ ReportName }}</h4><br/>
            {%if SubTitleReport%}
                <h4 class="text-center">{{ SubTitleReport }}</h4><br/>
            {%endif%}   
            <div class="text-right col-xs-6">
                <div class="text-bold">
                    កាលបរិច្ឆេទ៖
                </div>
                <div class="text-bold"> 
                    As of:​
                </div>
            </div>
            <div class="text-left col-xs-6">
                <div  class="text-bold" style="font-size: 16px;">
                  {{ AsOf }}
                </div>
            </div>
        <!-- Report Title -->

        <div class="clearfix">&nbsp;</div>

       <!-- Company Name -->
            <div style="width: 150px; float: left;">
                <div class="text-bold">
                   ឈ្មោះគ្រឹះស្ថាន   ៖
                </div>
                <div class="text-bold"> 
                   Institution's Name:
                </div>
            </div>
            <div>
                 <h4 class="header-4"><b>{{ mktMarkup(CompanyName) }}</b></h4>
            </div>
        <!-- Company Name -->

        <div class="clearfix">&nbsp;</div>

        <!-- NetWorth -->
        {% if NetWorth %}
            <div style="width:150px; float: left; margin-left: 100px;">
                <div class="text-bold">
                    មូលនិធិផ្ទាល់សុទ្ធ ៖
                </div>
                <div class="text-bold">
                    Networth:
                </div>
            </div>
            <div>
                <h4 class="header-4"><b>{{ NetWorth }}</b></h4>
            </div>

        {% endif %}
        <!-- NetWorth -->

        <div class="clearfix">&nbsp;</div>

        <!-- Exchange Rate -->
            <div class="col-xs-3"></div>
            <div class="text-right col-xs-3">
                <div>
                    អត្រាប្តូរក្នុង ១ ដុល្លារអាមេរិក =
                </div>
                <div > 
                   Exchange Rate 1 USD =
                </div>
            </div>
            <div class="col-xs-1"> 
                <div class="text-right text-bold" style="font-size: 18px;">
                   {{ ReportingRate }}
                </div>

            </div>
            <div class="col-xs-1 text-left">
                <div>
                   រៀល
                </div>
                <div>
                    Riels
                </div>
            </div>

            <div class="col-xs-4 text-right">
                <div>
                   គិតជាលានរៀល
                </div>
                <div>
                    In Million Riels
                </div>
            </div>
        <!-- Exchange Rate -->
    </div>
    <!-- Header Report -->
    <div class="clearfix">&nbsp;</div>
{%endmacro%}

<!-- Function for markup html with newline only -->
{%macro mktMarkup(Text)%}
  
    {% for line in Text.splitlines() %}
        {{line | safe}}<br>
    {% endfor %}
{%endmacro%}

<!-- Default css in report NBC -->
{%macro setStyleNBCReport()%}
    <style>
        h3.header-3{
            font-size: 16px;
            font-weight: bold;
            margin: 5px 0 10px;
            padding: 10px 18px 0;
        }

        .form-label{
            padding-top: 7px;
        }

        .input-sm {

            width: 214px !important;
        }

        .modal-dialog{

            width: 428px !important;

        }

        .form-label{
            padding-top: 7px;
        }

        .modal-body {
            z-index: 99999 !important;
        }
        .nbc-bg-header{
            font-weight: bold !important;
            background-color: {{getNBCColor()}}
            
        }   
        .nbc-bg-body{
            background-color: {{getNBCColor('body')}};
        }
    </style>
{%endmacro%}

<!-- for table style css with NBC style -->
{%macro setTableStyle()%}
    class="table table-striped table-bordered" style="border: 3px solid black;"
{%endmacro%}

<!-- for border style css with NBC style -->
{%macro setStyleBorder()%}
    style="border: 3px solid black;"
{%endmacro%}

<!-- Using for indent of text by default if line detail with 45px of pendding -->
{%macro setTextIndent(LineType,Indent)%}
    {%set NewIndent = 45 %}

    {%if ( Indent == 0 or Indent == '' or Indent == 1 ) and  LineType == 'LD'%}
        
        {{NewIndent}}px;

    {%elif (Indent == 0 or Indent == '') and  LineType == 'GH'%}
        8px;
    {%else %}

        {%set NewIndent = NewIndent * Indent %}

        {{NewIndent}}px;
    {%endif%}

{%endmacro%}

<!-- Using for get color code of NBC report -->
{%macro getNBCColor(Type='Header')%}
{%if Type == 'Header'%}#93CDDD;{%else%}#DBEEF4;{%endif%}
{%endmacro%}


{% macro exportNBCButton(ID='', Branch='', Period='', ReportedDate='',Year='',Month='') %}
    <div id="exportButton">
        <b>Also available in :</b>
        <a title="Download to Excel" href="/Morakot/NBC/Excel/{{ID}}?Branch={{ Branch }}&Period={{ Period }}&ReportedDate={{ ReportedDate }}&Year={{Year}}&Month={{Month}}" style="cursor:pointer; color:#1d89cf;"> 
            <i class='fa fa-file-excel-o'></i> Current Report to Excel 
        </a> | 
        <a title="Download to Excel" href="/Morakot/NBC/Excel/Download?Branch={{ Branch }}&Period={{ Period }}&ReportedDate={{ ReportedDate }}&Year={{Year}}&Month={{Month}}" style="cursor:pointer; color:#1d89cf;"> 
            <i class='fa fa-download'></i> All to Excel
        </a>

    </div>

{% endmacro %}

{% macro setRowStyle(row,FirstCol=False)%}
    {%if row.get('LineType') %}
        {%set ValueCss=''%}
        {%if row.get('RowBGColor') %}
            {%set ValueCss = 'background:'+row.get('RowBGColor')+';' %}
        {%endif%}

        {%if row.get('LineFormat') %}
            {%set ValueCss = ValueCss +'font-weight:'+row.get('LineFormat')+';' %}
        {%endif%}

        {%if FirstCol==True %}
            {%set ValueCss = ValueCss + 'padding-left:'+ setTextIndent(row.get('LineType'),row.get('Indent',0))+';' %}
        {%endif%}

        {%if ValueCss%}
            style="{{ValueCss}}"
        {%endif%}

    {%endif%}
   
{% endmacro %}