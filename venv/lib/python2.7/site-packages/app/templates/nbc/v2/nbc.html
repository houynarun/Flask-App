{% extends "layout.html" %}
{% import 'nbc/v2/nbc_template.html' as nbc %}
{% block css %}
   
{{nbc.setStyleNBCReport()}}

{% endblock %}

{% block content %}
	<div class="navbar navbar-default navbar-static-top">
	    <div class="col-sm-6" style="margin-top: 15px;">
	        <!-- Button Export -->
           {{ exportButtonLink(Branch,Period,ReportedDate,Year,Month) }}
	    </div>

	    <div class="col-sm-6" style="margin-top: 8px;">
			<a href="javascript:void(0)" title="Refresh" id="Refresh" class="btn btn-flat btn-labeled btn-warning pull-right" style="margin-left: 5px;">
				<span class="btn-label icon fa fa-refresh"></span> Refresh
			</a>
			<button type="button" class="btn btn-flat btn-labeled btn-success pull-right" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">
                <span class="btn-label icon fa fa-gear"></span>{{ getLanguage('Custom') }} 
            </button>
	    </div>

	</div>
	<div style="margin-left:10%; margin-right:10%;">
		<h2 class="text-center">National Bank of Cambodia Reports for {{Title}}</h2>
	</div>
	<div class="clearfix">&nbsp;</div>

	 <div class="col-sm-12">
		<table id="mktlist" class="table table-striped table-hover" cellspacing="0" width="100%" style="border: 3px solid black;">
			<thead>
				<tr style="background: #93CDDD; font-weight: bold; font-size: 14px;">
					<th>No</th>
					<th>Reports Name</th>
					<th>ឈ្មោះរបាយការណ៏</th>
				</tr>
			</thead>
			<tbody>
				{%for key in sorted(ReportList)%}
					{% set value = ReportList.get(key,{})%}
					<tr class="link" onclick="CustomClickView('{{key}}-{{value.Title}}','Report/NBC/{{Type}}/{{key}}?Branch={{ Branch }}')">
						<td width="4%">{{key}}</td>
						<td width="48%">{{value.English}}</td>
						<td width="48%">{{value.Khmer}}</td>
					</tr>
				{%endfor%}
			</tbody>
			
		</table>
		
	</div>
{% endblock %}


{% block js %}

{% from "print.html" import exportIncludeJS %}
{{exportIncludeJS()}}

<script type="text/javascript">

	$(document).ready(function() {
		$('#mktlist').dataTable({
			"lengthMenu": [[25,50,100,200, -1], [25,50,100,200, "All"]],
			"bSort" : false,
			"bScrollCollapse": true
		});
		{% from "print.html" import exportDataTable %}
		{{exportDataTable("#mktlist","NBC ")}}
		$("#Refresh").click(function() {
            fn_fadeIn();
            window.location.reload(true);
        });
	});

	$('#mktlist tbody tr').click(function() {
    	$(this).addClass('btn-info').siblings().removeClass('btn-info');
	});

	$('#exportExcel').click(function() {
       fn_fadeIn();
    });
    
</script>
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
                {% set ReportType = ''%}
                {% if Type == 'MFI' %}
                    {% set ReportType = 'getNBCMFIReport'%}
                {% elif Type == 'NGO' %}
                    {% set ReportType = 'getNBCNGOReport'%}
                {% elif Type == 'BANK' %}
                    {% set ReportType = 'getNBCBANKReport'%}
                {% elif Type == 'BANK1' %}
                    {% set ReportType = 'getNBCBANK1Report'%}
                {% endif %}
                <form class="form-horizontal" action="{{ url_for(ReportType) }}" method="GET">

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="exampleModalLabel">{{ getLanguage('Custom') }}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="InDollar" class="col-sm-4 control-label">{{ getLanguage('Branch') }}:</label>
                        <div class="col-sm-8">
                            <input class="form-control input-sm" name="Branch" style="width: 100%;" id="Branch" value="{{ Branch }}">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">{{ getLanguage('Apply') }}</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">{{ getLanguage('Cancel') }}</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% macro exportButtonLink(Branch='', Period='', ReportedDate='',Year='',Month='') %}
	<div id="exportButton">
		<b>Also available in :</b>
		<a id="exportExcel" title="Download to Excel" href="/Morakot/Report/NBC/{{Type}}/Excel?Branch={{ Branch }}&Period={{ Period }}&ReportedDate={{ ReportedDate }}&Year={{Year}}&Month={{Month}}" style="cursor:pointer;"> 
			<i class='fa fa-file-excel-o'></i> All Reports to Excel
		</a> |
		<a href="javascript:void(0)" id="print"><i class='fa fa-print'></i>&nbsp;Print</a>
	</div>

{% endmacro %}