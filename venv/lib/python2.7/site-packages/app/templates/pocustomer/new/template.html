{## Template - New Inquiry ##}
{% macro NewInquiry(g_getUrlExtend,NewObj,ReAssigneeObj="",IsAssigner="",RejectedStageObj="") %}
	<style type="text/css">
		.count-color{
			background: #fff;
			color: #000;
			margin-left: 10px;
			border:none;
		}
		.table-container {
			overflow-x: auto !important; 
		}
		.container {
		     /*width: 140px;*/
		     height: 300px;
		     background-color: #DCDCDC ;
		     overflow-x: scroll;  /*showing scrollbars */
	    }
	    ::-webkit-scrollbar {
	         width: 5px;
	    } /* this targets the default scrollbar (compulsory) */    
    
	    ::-webkit-scrollbar-thumb {
	          background-color: rgba(0, 0, 0, 0.1);
	          border-radius: 5px;
	          opacity:.3 !important;
	    } /* this will style the thumb, ignoring the track */
     	::-webkit-scrollbar:horizontal {
			/*background: blue;*/
			height: 7px;
			border-width: 4px 0 0
		}

	</style>
	<script>
	init.push(function () {
		$('#NewInquiryRefresh').on("click",function(e){
			var Branch = "{{NewObj[2].get('Branch')}}"
			var IsIndividual = "{{NewObj[2].get('IsIndividual')}}"
			var UserID = "{{NewObj[2].get('UserID')}}"
			$.ajax({
				url: "/Morakot/NewInquiryRefresh",
				type: "GET",
				data: {'Branch': Branch,'IsIndividual': IsIndividual,'UserID': UserID},
				beforeSend: function() {
				
					$('#NewInquiryRefresh').addClass('fa-spin');
				
				},
				success: function(data){
					$('.new-inquiry > div').html(data);
					$('#NewInquiryRefresh').removeClass('fa-spin');					
					$('.table-container').css('height','300px')
					$('.new-inquiry > div').slimScroll({ height: 300, alwaysVisible: true, color: '#888',allowPageScroll: true });
				}
			});
		});
		$('.new-inquiry > div').slimScroll({ height: 300, alwaysVisible: true, color: '#888',allowPageScroll: true });

		$('body').on("change", ".select-assign", function(){
			var user_id = $(this).val()
			var po_id 	= $(this).find(':selected').data('po-id')		
			// console.log(po_id)
			$.ajax({
	            method: "GET",
	            url: "/Morakot/SetAssignee/",
	            data: {"UserID": user_id, "POCustomerID": po_id},
	        })
	        .done(function( data ) {
	            if (data == "True"){
	            	$("#InquiryRefresh").click()  
	            	$("#NewInquiryRefresh").click()    
	            	$("#ActivityRefresh").click()  
	            }
	        });					
			
		})
		$(".select-assign").select2();		
	})
	
	</script>

	<div class="panel panel-info panel-dark" id="NewInquiry">
		<div class="panel-heading">
			<span class="panel-title"> 
				List of Potential Customer Un-assigned<span class="badge count-color" id="new-count">{{ NewObj[0].count() }}</span>
			</span>
			<div class="panel-heading-controls" >
				<div class="panel-heading-icon"style="padding-top:0px;" >
					<a title='Refresh' class="link" ><i id='NewInquiryRefresh' class='fa fa-refresh' style="color:#fff"></i></a>
				</div>
			</div>

		</div>
		<div class="panel-body new-inquiry">
			<div class="table-container">	
				<table  class="table" id="mktlist_new">
					<thead>
						<tr>	
							<th>Branch</th>						
							<th>ID</th>							
							<th>English Name</th>
				            <th>Gender</th>
				            <th>Mobile</th>
				            <th>Date of Contact</th>
			            	<th style="width: 100px">Assign To</th>		            				            
						</tr>
					</thead>
					<tbody>	
						{%for row in NewObj[0] %}	
							{% set RejectedStatus = '5' %}
		            		{% set AppliedStatus = '4' %}
		            		{% set MeetingStatus = '3' %}
		            		{% set AssignStatus = '2' %}
		            		{% set NewStatus = '1' %}

							{% set color = 'label-default' %}
							{% if row.POStatus == NewStatus %}
								{% set color = 'label-warning' %}
							{% endif %}

							{% if row.POStatus == AssignStatus %}
								{% set color = 'label-info' %}
							{% endif %}

							{% if row.POStatus == MeetingStatus %}
								{% set color = 'label-primary' %}
							{% endif %}

							{% if row.POStatus == AppliedStatus %}
								{% set color = 'label-success' %}
							{% endif %}

							{% if row.POStatus == RejectedStatus %}
								{% set color = 'label-danger' %}
							{% endif %}
						<tr>
							<td>{{row.AssignBranch}}</td>	
							<td class="{{row.ID}} link"> <a href="javascript:void()" class="link" onClick="ClickView('POCustomer','{{g_getUrlExtend(Module="POCustomer")}}','{{row.ID}}')">{{ row.ID }}</a></td>
							<td class="">{{ row.LastNameEn }} {{ row.FirstNameEn }}</td>
							<td class="">{{ row.Gender }}</td>
							<td class="">{{ row.Mobile1 }}</td>
							<td class="">{{ row.DateOfContact }}</td>
			            	<td>
			            		<select class="form-control input-sm select2 select-assign" style="width: 200px;">
									<option value=""><option>
								{% for row_user in NewObj[1] %}
									{%if row_user.Role!=IsAssigner[1].Role%}		
										<option value="{{row_user.ID}}" data-po-id="{{row.ID}}">{{row_user.DisplayName}}</option>
									{%endif%}
								{% endfor %}
								</select>								
							</td>						
						</tr>
						{% endfor %}				
					</tbody>
				</table>	
			</div>
		</div> <!-- panel-body -->
	</div> <!-- panel panel-info -->

{% endmacro %}
	                            

{## Template - Inquiry By Status ##}
{% macro InquiryByStatus(g_getUrlExtend="",POObj,POStatusObj="",IsAssigner="",ReAssigneeObj="",RejectedStageObj="") %}
	{#
		POObj[0] = NewAssignObj
		POObj[1] = POCustomerObj (ALL Status)
		POObj[2] = UserObj
		POObj[3] = POStatusObj
		POObj[4] = Param
		[NewAssignObj, POCustomerObj, UserObj, POStatusObj,Param, UpcomingObj,TodayObj, PastDueObj, RejectedObj,ReasonTypeObj]
	#}

	<style>
		.table-container {
			overflow-x: auto !important; 
		}
		.container {
		     /*width: 140px;*/
		     height: 300px;
		     background-color: #DCDCDC ;
		     overflow-x: scroll;  /*showing scrollbars */
	    }
	    ::-webkit-scrollbar {
	         width: 5px;
	    } /* this targets the default scrollbar (compulsory) */    
    
	    ::-webkit-scrollbar-thumb {
	          background-color: rgba(0, 0, 0, 0.1);
	          border-radius: 5px;
	          opacity:.3 !important;
	    } /* this will style the thumb, ignoring the track */
     	::-webkit-scrollbar:horizontal {
			/*background: blue;*/
			height: 10px;
			border-width: 4px 0 0
		}
	</style>

	<script>
	init.push(function () {
		$('#InquiryRefresh').on("click",function(e){
			var Branch = "{{POObj[4].get('Branch')}}"
			var IsIndividual = "{{POObj[4].get('IsIndividual')}}"
			var UserID = "{{POObj[4].get('UserID')}}"
			console.log(IsIndividual)
			$.ajax({
				url: "/Morakot/InquiryRefresh",
				type: "GET",
				data: {'Branch': Branch,'IsIndividual': IsIndividual,'UserID': UserID},
				beforeSend: function() {
				
					$('#InquiryRefresh').addClass('fa-spin');
				
				},
				success: function(data){
					$('.inquiry-list > div').html(data);
					$('#InquiryRefresh').removeClass('fa-spin');
					$('.inquiry-list > div').slimScroll({ height: 300, alwaysVisible: true, color: '#888',allowPageScroll: true });
					$('.table-container').css('height','300px')

					$('.bs-tabdrop-example li').removeClass('active')					
					$('.bs-tabdrop-example li:nth-child(2)').addClass('active')
					$('.bs-tabdrop-example li:nth-child(1) ul li').removeClass('active')	
				}
			});
		});
		$('.inquiry-list > div').slimScroll({ height: 300, alwaysVisible: true, color: '#888',allowPageScroll: true });
		$('ul.bs-tabdrop-example').tabdrop();

		$('.re-assign').popover({
			html:true,
			// trigger: 'focus'
		})

		$('body').on('shown.bs.popover', function(){
			$(".select-re-assign").select2("destroy");
		    $(".select-re-assign").select2();
		});

		$('body').on("change", ".select-re-assign", function(){
			var user_id = $(this).val()
			var po_id 	= $(this).find(':selected').data('po-id')		
			// console.log(po_id)
			$.ajax({
	            method: "GET",
	            url: "/Morakot/SetAssignee/",
	            data: {"UserID": user_id, "POCustomerID": po_id,"ReAssign": 'Y'},
	        })
	        .done(function( data ) {
	            if (data == "True"){
	            	$("#InquiryRefresh").click()  
	            	$("#NewInquiryRefresh").click()    
	            	$("#ActivityRefresh").click()  
	            }
	        });					
			
		})
			
				
	})
		
	</script>
	<div class="panel colourable panel-info panel-dark">
		<div class="panel-heading">
			<div class="row">
				<div class="col-xs-4"><span class="panel-title">List of Potential Customer By Status</span></div>
				<div class="col-xs-7">
					{% set TabObj = [] %}
					{% do TabObj.append(('new-assign','New Assign', POObj[0])) %}
					
					{% for POStatus in POStatusObj%}
						{% set  PO 		= POObj[1].filter_by(POStatus=POStatus.ID) %}
						{% set OneTable = (POStatus.ID,POStatus.Description,PO) %}
						{% do TabObj.append(OneTable) %}
					{% endfor %}
					
					{% do TabObj.append(('upcoming','Upcoming Followup', POObj[5])) %}
					{% do TabObj.append(('today','Today Followup', POObj[6])) %}
					{% do TabObj.append(('past-due','Past Due Followup', POObj[7])) %}

					{% set TabSelected = POObj[4].get("TabSelected") if POObj[4].get("TabSelected") else "" %}

					<ul class="nav nav-tabs nav-tabs-xs bs-tabdrop-example" style="margin-bottom: -28px">
						{% set Dict = {'i': 1} %}
						{%for item in TabObj%}
							{% if TabSelected == "" %}
								<li class="{{ 'active' if Dict.get('i') == 1 else '' }}">
							{%else%}
								<li class="{{ 'active' if TabSelected == item[0] else '' }}">
							{%endif%}
								<a href="#tab-{{item[0]}}" data-toggle="tab">
									<span>{{item[1]}}</span>
								</a> 
							</li>
							{% if Dict.update({"i": (Dict.get('i') + 1) }) %} {%endif%}							
						{%endfor%}
					</ul> 
				</div>	
				<div class="col-xs-1">
					<div class="panel-heading-controls" >
				<div class="panel-heading-icon"style="padding-top:0px;" >
					<a title='Refresh' class="link" ><i id='InquiryRefresh' class='fa fa-refresh' style="color:#fff"></i></a>
				</div>
			</div>
				</div>
			</div>

		</div> <!-- / .panel-heading -->
		<div class="panel-body inquiry-list">
			<div class="tab-content table-container">

			{% set Dict = {'i': 1} %}
			{%for item in TabObj%}	
				{% if TabSelected == "" %}
					<div class="tab-pane {{ 'active' if Dict.get('i') == 1 else '' }}" id="tab-{{item[0]}}">
				{%else%}
					<div class="tab-pane {{ 'active' if TabSelected == item[0] else '' }}" id="tab-{{item[0]}}">
				{%endif%}				
					<table  class="table">
						<thead>
							{%if item[0] == "5" %}
								<tr>	
									<th>Branch</th>							
									<th>ID</th>
									<th>English Name</th>
						            <th>Gender</th>
						            <th>Mobile</th>
						            <th>Date of Contact</th>	
					            	<th>Rejected/Block Date</th>
					            	<th>Rejected/Block By</th>
					            	<th>Rejected Stage</th>
					            	<th>Assign To</th>
					            	<th>Status</th>	
					            	<th class="text-center" style="min-width: 80px">Action</th>
								</tr>
							{%else%}
								<tr>	
									<th>Branch</th>							
									<th>ID</th>
									<th>English Name</th>
						            <th>Gender</th>
						            <th>Mobile</th>
						            <th>Date of Contact</th>
					            	<th>Followup Date</th>	
					            	<th>Assign To</th>
					            	<th>Status</th>	
					            	<th class="text-center" style="min-width: 80px">Action</th>
								</tr>

							{%endif%}
								
						</thead>
						<tbody>	
							{%for row in item[2] %}	

								{% set CurrentDate = POObj[4].get("CurrentDate") | string %}
			            		{% set NextDate    = POObj[4].get("NextDate") | string %}

			            		{% set RejectedStatus = '5' %}
			            		{% set AppliedStatus = '4' %}
			            		{% set MeetingStatus = '3' %}
			            		{% set AssignStatus = '2' %}
			            		{% set NewStatus = '1' %}

								{% set color = 'label-default' %}
								{% if row.POStatus == NewStatus %}
									{% set color = 'label-warning' %}
								{% endif %}

								{% if row.POStatus == AssignStatus %}
									{% set color = 'label-info' %}
								{% endif %}

								{% if row.POStatus == MeetingStatus %}
									{% set color = 'label-primary' %}
								{% endif %}

								{% if row.POStatus == AppliedStatus %}
									{% set color = 'label-success' %}
								{% endif %}

								{% if row.POStatus == RejectedStatus %}
									{% set color = 'label-danger' %}
								{% endif %}

			            	{% if row.Block == "Y" %}
			            		<tr style="text-decoration:line-through;">
			            	{% else %}
			            		<tr style="">
			            	{% endif %}
								<td>{{row.AssignBranch}}</td>
								<td class="{{row.ID}} link"> <a href="javascript:void()" class="link" onClick="ClickView('POCustomer','{{g_getUrlExtend(Module="POCustomer")}}','{{row.ID}}')">{{ row.ID }}</a></td>
								<td class="">{{ row.LastNameEn }} {{ row.FirstNameEn }}</td>
								<td class="">{{ row.Gender }}</td>
								<td class="">{{ row.Mobile1 }}</td>
								<td class="">{{ row.DateOfContact }}</td>	

								{% set RejectedObj = POObj[8] %}
								{% set ReasonTypeObj = POObj[9] %}
								{% set RejectedObj1 = RejectedObj.filter_by(CustomerID=row.ID).first() %}	

								{% set decoration = "none"%}
			            		{% set title = "" %}
			            		{% set RejectedBlockDate = "" %}
			            		{% set RejectedBlockBy = "" %}
			            		{% set IsBlock = "" %}
			            		{%if RejectedStageObj %}
			            			{% set StageID	= RejectedObj1.RejectedStage %}
			            			{% if not StageID %}
			            				{% set StageID = ''%}
			            			{%endif%}

			            			{% set Description = ""%}
			            			{% set StageObj 	= RejectedStageObj.filter_by(ID=StageID).first() %}
			            			
			            			{% if StageObj %}
			            				{% set Description = StageObj.Description%}
			            			{%endif %}
			            		{%endif%}
								{% if row.POStatus == RejectedStatus and RejectedObj1.Rejected == "Y" %}
			            			{% set ReasonTypeObj1 = ReasonTypeObj.filter_by(ID=RejectedObj1.ReasonType).first() %}
			            			{% set title = "%s - %s" % (ReasonTypeObj1.Description, RejectedObj1.RejectedReason) %}
			            			{% set RejectedBlockDate = RejectedObj1.RejectedDate %}
			            			{% set RejectedBlockBy= "Client" if RejectedObj1.RejectedBy == '1' else "Company" %}
			            			{% set IsBlock = "N" %}
			            		{% endif %}
			            		{% if row.POStatus == RejectedStatus and row.Block == "Y" %}
			            			{% set title = row.BlockReason %}
			            			{% set RejectedBlockDate = row.Createdon %}
			            			{% set RejectedBlockBy= row.Inputter %}
			            			{% set IsBlock = "Y" %}
			            		{% endif %}						

								{% if item[0] == RejectedStatus %}


								<td class="">{{ RejectedBlockDate }}</td>
								<td class="">{{ RejectedBlockBy }}</td>
								<td class="">{{ Description }}</td>
								{%else%}
								<td class="">
									{{ row.NextFollowDate}}
									{% if row.NextFollowDate <= NextDate and row.NextFollowDate > CurrentDate  and row.POStatus !=RejectedStatus%}
										<span class="label label-tag label-warning" title="Customer who you need to follow up in few days">Upcoming</span>	
									{% endif %}

									{% if row.NextFollowDate == CurrentDate and row.POStatus !=RejectedStatus %}
										<span class="label label-tag label-success" title="Customer who you need to follow up Today">Today</span>
									{% endif %}

									{% if row.NextFollowDate < CurrentDate and row.POStatus ==MeetingStatus %}
										<span class="label label-tag label-danger" title="Please followup with this customer">Past Due</span>
									{% endif %}

								</td>

								{%endif%}

								{%set UserObj1 = POObj[2].filter_by(ID=row.AssignTo).first() %}					
								<td class="">{{ UserObj1.DisplayName }}</td>

								{%set POStatusObj1 = POObj[3].filter_by(ID=row.POStatus).first() %}
				            	<td class="">			            		
				            		
				            		{% if row.POStatus == AssignStatus and row.AssignDate == CurrentDate %}
				            			{% set decoration = "underline"%}
				            			{% set title= "New Assigned" %}
				            		{%endif%}
				            		
				            		<span class="label {{ color }}" style="text-decoration: {{decoration}}" title="{{title}}">{{ POStatusObj1.Description }}</span>

				            	</td>	
				            	<td class="text-center" style="text-decoration: none !important">
				            		{% if item[0] != RejectedStatus %}				            		
				            		<a href="javascript:void(0);" onClick="CustomClickView('POCustomer - Activity','{{g_getUrlExtend(Module="POCustomerAct")}}/New?POID={{row.ID}}')">
				            			<i class="fa fa-plus-circle" title="Add Activity"></i>
				            		</a>
				            		{% endif%}
				            		{% if item[0] == RejectedStatus and IsBlock=="N" %}
				            			| <a href="javascript:void(0);" onClick="CustomClickView('Rejected-Potential','{{g_getUrlExtend(Module="Rejected")}}/?ID={{RejectedObj1.ID}}')">
					            			<i class="fa fa-eye text-danger" title="View Rejected"></i>
					            		</a>	
				            		{% endif%}
				            		{% if item[0] == RejectedStatus and IsBlock=="Y" %}
				            			| <a href="javascript:void(0);" onClick="CustomClickView('Potential-Customer','{{g_getUrlExtend(Module="POCustomer")}}/?ID={{row.ID}}')">
					            			<i class="fa fa-eye text-danger" title="View Block"></i>
					            		</a>	
				            		{% endif%}
				            		{%if IsAssigner[0]%}
					            		| <a href="javascript:void(0);" class="re-assign popover-info popover-dark" data-toggle="popover" data-content='<select class="form-control input-sm select2 select-re-assign" style="width: 200px;"> 
					            			<option value=""><option> 
					            			{% for row_user in ReAssigneeObj %} 
					            				<option value="{{row_user.ID}}" data-po-id="{{row.ID}}">{{row_user.DisplayName}}</option> 
					            			{% endfor %} 
					            		</select>' data-title="Re-Assign - {{row.ID}}" data-placement="left">
					            			<i class="fa fa-user-plus text-warning" title="Re-Assign"></i>
					            		</a>
					            	{%endif%}
			            		</td>				            						
							</tr>
							{% endfor %}				
						</tbody>
					</table>
				</div>
				{% if Dict.update({"i": (Dict.get('i') + 1) }) %} {%endif%}							
			{%endfor%}
				
			</div>
		</div>
	</div> 

{% endmacro %}

{## Template - Activity ##}
{% macro Activity(g_getUrlExtend="",Obj) %}

	{# Obj = [ActObj, POCustomerObj, UserObj, POStatusObj,ActTypeObj,Param]#}

	<style type="text/css">
		.widget-article-comments .comment-text{
			border: 0px
		}
		h3.list-title{
			font-size: 14px;
			font-weight: bold;
		}
		.widget-article-comments .comment-body:before{
			border: 0px
		}
		.comment span.label {
			cursor: pointer;
		}
		.name {
			min-width:130px;float:left;margin-left: 10px
		}
		/*.followup-date {
			min-width:120px;float:left;margin-left: 10px
		}*/
		.phone {
			min-width:120px;float:left;margin-left: 10px
		}
		@media (max-width: 576px) {
			.control-heading {padding-top: 10px !important}
			.name {min-width:265px !important;}
			.followup-date {margin-left: 76px;}
			.phone {min-width:265px !important;}
		}
	</style>

	<script>
	init.push(function () {
		$('#ActivityRefresh').on("click",function(e){
			var Branch = "{{Obj[5].get('Branch')}}"
			var IsIndividual = "{{Obj[5].get('IsIndividual')}}"
			var UserID = "{{Obj[5].get('UserID')}}"
			UserID = $("#Assignee").val()
			$.ajax({
				url: "/Morakot/ActivityRefresh",
				type: "GET",
				data: {'Branch': Branch,'IsIndividual': IsIndividual,'UserID': UserID},
				beforeSend: function() {
				
					$('#ActivityRefresh').addClass('fa-spin');
				
				},
				success: function(data){
					$('.activity-list > div').html(data);
					$('#ActivityRefresh').removeClass('fa-spin');
					// $('.activity-list > div').slimScroll({ height: 500, alwaysVisible: true, color: '#888',allowPageScroll: true });
				}
			});
		});
		$("#Assignee").select2()
		// $('.activity-list > div').slimScroll({ height: 500, alwaysVisible: true, color: '#888',allowPageScroll: true });
		$('#Assignee').on("change", function(){
			$('#ActivityRefresh').click()	
		})
		$("#Assignee").select2("val", '{{Obj[5].get('UserID')}}').trigger("change")
	})
	</script>

	<div class="panel colourable widget-article-comments panel-info panel-dark">
		<div class="panel-heading">
			<div class="row">
				<div class="col-xs-5">
					<span class="panel-title">View Task Under Assignee</span> 
					{#&nbsp;&nbsp; <a href="javascript:void(0)" onClick="CustomClickView('POCustomer - Activity','{{g_getUrlExtend(Module="POCustomerAct")}}/New')"><i class="fa fa-plus" title="Add Activity" style="color:#fff"></i> </a> #}
				</div>
				<div class="col-xs-7">
					<div class="panel-heading-controls">
						<div class="row">
							<div class="col-xs-10 control-heading" style="padding-top: 0px;">
								<select class="form-control input-sm select2" id="Assignee" style="width: 200px;margin-top:-5px;margin-right: 15px">
									<option value="ALL">-- Choose Assignee --</option>
								{%if Obj[2]:%}
									{% for row_user in Obj[2] %}				
										<option value="{{row_user.ID}}">{{row_user.DisplayName}}</option>
									{% endfor %}
								{%endif%}
								</select>
							</div>
							<div class="col-xs-2 control-heading">
								<div class="panel-heading-icon pull-right" style="padding-top:0px;" >
									<a title='Refresh' class="link" ><i id='ActivityRefresh' class='fa fa-refresh' style="color:#fff"></i></a>
								</div>
							</div>
						</div>
								
						
					</div>
				</div>	
			</div>
			 <!-- / .panel-heading-controls -->
		</div> <!-- / .panel-heading -->
		<div class="panel-body activity-list">
			<div>
			{% set UserObj1 = Obj[2] %}
			{% set UserID = Obj[5].get("UserID") %}

			{% if UserID != "ALL" %}
				{% set UserObj1 = UserObj1.filter_by(ID=UserID) if UserObj1 else None %}
			{% endif %}

			{% set CurrentDate = Obj[5].get("CurrentDate") | string %}
    		{% set NextDate    = Obj[5].get("NextDate") | string %}
    		{%if UserObj1 %}
				{% for row in UserObj1 %}
					{% set POCustomerObj1 = Obj[1].filter_by(AssignTo=row.ID) %}
					{% set TotalNew = POCustomerObj1.filter_by(POStatus='1').count() %}
					{% set TotalMeeting = POCustomerObj1.filter_by(POStatus='3').count() %}
					{% set TotalAssign = POCustomerObj1.filter_by(POStatus='2').count() %}
				{% if POCustomerObj1.count() > 0 %}
				<div class="comment">
					<img src="/static/avatars/{{ row.ProfilePicture if row.ProfilePicture else 'default.jpg' }}" alt="" class="comment-avatar">
					<div class="comment-body">
						<div class="comment-text">
							<div class="comment-heading">						
								
								<a href="javascript:void(0)" title="">{{ row.DisplayName }}</a><span>Currently have <b> {{TotalNew}} </b> new, <b>{{ TotalAssign }}</b> assigned, <b> {{ TotalMeeting }} </b> meeting (Inquiry)</span>
								
							</div>									
						</div>
					</div> <!-- / .comment-body -->

					{% for row_cust in POCustomerObj1 %}

						{% set POStatusObj1 = Obj[3].filter_by(ID=row_cust.POStatus).first() %}

						{% set RejectedStatus = '5' %}
						{% set AppliedStatus = '4' %}
						{% set MeetingStatus = '3' %}
						{% set AssignStatus = '2' %}
						{% set NewStatus = '1' %}

						{% set color = 'label-default' %}
						{% if row_cust.POStatus == NewStatus %}
							{% set color = 'label-warning' %}
						{% endif %}

						{% if row_cust.POStatus == AssignStatus %}
							{% set color = 'label-info' %}
						{% endif %}

						{% if row_cust.POStatus == MeetingStatus %}
							{% set color = 'label-primary' %}
						{% endif %}

						{% if row_cust.POStatus == AppliedStatus %}
							{% set color = 'label-success' %}
						{% endif %}

						{% if row_cust.POStatus == RejectedStatus %}
							{% set color = 'label-danger' %}
						{% endif %}

					<div class="comment">						
								
						{% set isNewAssign = "N" %}
	            		{% if row_cust.POStatus == AssignStatus and row_cust.AssignDate == CurrentDate  %}
	            			<span class="label {{ color }}" style="text-decoration: underline;float:left;margin-left: 10px" title="New Assigned" onClick="ClickView('POCustomer','{{g_getUrlExtend(Module="POCustomer")}}','{{row_cust.ID}}')">{{ POStatusObj1.Description }}</span>
	            			{% set isNewAssign = "Y" %}
	            		{%endif%}
	            		{% if isNewAssign == "N" %}
	            			<span class="label {{ color }}" style="float: left;margin-left: 10px" onClick="ClickView('POCustomer','{{g_getUrlExtend(Module="POCustomer")}}','{{row_cust.ID}}')">{{ POStatusObj1.Description }}</span>
	            		{%endif%}            		
	            		
						<span class="name link" onClick="ClickView('POCustomer','{{g_getUrlExtend(Module="POCustomer")}}','{{row_cust.ID}}')">{{ row_cust.LastNameEn }} {{ row_cust.FirstNameEn }} </span>
						<span class="phone">|&nbsp;&nbsp;<i class="fa fa-phone" ></i> &nbsp;&nbsp;{{row_cust.Mobile1}} </span>
						<span class="followup-date">|&nbsp;&nbsp;<i class="fa fa-calendar" title="Next Follow Up Date"></i>&nbsp;&nbsp; {{row_cust.NextFollowDate if row_cust.NextFollowDate !="" else "____/__/__"  }} </span>  

						{% if row_cust.NextFollowDate <= NextDate and row_cust.NextFollowDate > CurrentDate  and row_cust.POStatus !=RejectedStatus %}
							<span class="label label-tag label-warning" title="Customer who you need to follow up in few days">Upcoming</span>	
						{% endif %}

						{% if row_cust.NextFollowDate == CurrentDate  and row_cust.POStatus !=RejectedStatus %}
							<span class="label label-tag label-success" title="Customer who you need to follow up Today">Today</span>
						{% endif %}

						{% if row_cust.NextFollowDate < CurrentDate  and row_cust.POStatus ==MeetingStatus %}
							<span class="label label-tag label-danger" title="Please followup this customer it is past followup date already">Past Due</span>
						{% endif %}

						<div class="comment-body test" style="margin-left: 65px">				
							{% set ActObj1 = Obj[0].filter_by(PotentialCustomer=row_cust.ID) %}
							{% for row_act in ActObj1 %}
								{% set ActTypeObj1 = Obj[4].filter_by(ID=row_act.ActivityType).first() %}
							<div class="comment-text">
								<div class="comment-heading">
									<i class="fa fa-long-arrow-right"></i> &nbsp;&nbsp; <a href="javascript:void(0)" title="" style="font-size:14px">{{ActTypeObj1.Description}}</a> 
								</div>
								<span style="margin-left: 25px">{{row_act.ActivityDesc}}</span>
							</div>
							<div class="comment-footer">
								<a href="javascript:void(0)
								" onClick="ClickView('POCustomerAct','{{g_getUrlExtend(Module="POCustomerAct")}}','{{row_act.ID}}')" style="margin-left: 25px">Read More
								</a> | 

								<a href="javascript:void(0);" onClick="CustomClickView('POCustomer - Activity','{{g_getUrlExtend(Module="POCustomerAct")}}','{{row_act.ID}}')">
					            	Add Activity
			            		</a>
							</div>
							{% endfor %}

						</div> <!-- / .comment-body -->

					</div> <!-- / .comment -->	
					
					<hr style="border-style: dashed;">		

					{% endfor %} 
					
				</div> <!-- / .comment -->

				{%endif%}
			{% endfor %}
		{% endif %}

			</div>
		</div> 
	</div>

{% endmacro %}

{## Template - Note ##}
{% macro Note() %}
<div class="note note-info">
	<h3>Legend</h3>
	<table class="table">
		<tr>
			<td style="width:100px"><span class="label label-tag label-danger">Past Due</span></td>
			<td><span>Followup date of inquiry is already past</span></td>
		</tr>
		<tr>
			<td><span class="label label-tag label-success">Today</span></td>
			<td><span>Followup date of inquiry is today</span></td>
		</tr>
		<tr>
			<td><span class="label label-tag label-warning">Upcoming</span></td>
			<td><span>Followup date of inquiry is in near future</span></td>
		</tr>
		<tr>
			<td><span class="label label-info" style="text-decoration: underline;">Assigned</span></td>
			<td><span>New Assigned Inquiry</span></td>
		</tr>
		<tr>
			<td><span style="text-decoration: line-through;">PC000397</span></td>
			<td><span>This inquiry is block/black list. You can review reason of block by hover on status of this inquiry. </span></td>
		</tr>
		<tr>
			<td><span class="label label-danger">Rejected</span></td>
			<td><span>For Rejected inquiry, you can hover on status to see rejected reason.</span></td>
		</tr>
	</table>
	
</div>
{% endmacro %}