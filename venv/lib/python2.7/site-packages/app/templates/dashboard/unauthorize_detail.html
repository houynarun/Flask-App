{% extends "layout.html" %}

{% block css %}
<style type="text/css">


.modal-body {
	z-index: 99999 !important;
}

#Main {
  width: 1px;
  min-width: 100%;
  *width: 100%;
}
.panel {
  width: 100%;
}
</style>
{% endblock %}

{% block content %}
<script src="{{ url_for('static',filename='javascripts/jquery.datatables.min.js') }}"></script>
<script src="{{ url_for('static',filename='js/dataTables.tableTools.js') }}"></script>

<!-- <link rel=stylesheet type=text/css href="{{ url_for('static', filename='stylesheets/jquery.datatables.css') }}">
 -->
 <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.bootstrap.min.css">
 <link rel=stylesheet type=text/css href="{{ url_for('static', filename='stylesheets/dataTables.tableTools.css') }}">
 <script src="{{ url_for('static',filename='javascripts/dataTables.responsive.min.js') }}"></script>

<div id="Main">
<!--  message  -->
<div class="clearfix"></div>
<p>
<!-- Import Message -->
{% include 'msg_error.html' %}
</p>
	<form method="GET" id="frm" name="frm" role="form" >
		<!-- Modal -->
		<div id="getCustomRange" class="modal fade" tabindex="-1" role="dialog" style="display: none;">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
						<h4 class="modal-title" id="myModalLabel">Custom</h4>
					</div>
					<div class="modal-body">

						
						<div class="form-group">
							<label for="StartDate" class="col-sm-3 control-label">
								{{ getLanguage('Branch') }}
								<span style="color:#d38e99">*</span>
							</label>
							<div class="col-sm-9">
								<input class="input-sm form-control" type="text" value="{{ Branch }}" placeholder="{{ getLanguage('Branch') }}" name="Branch" id="Branch"  style="width:214px;">
							</div>
						</div>

					</div> <!-- / .modal-body -->
					<div class="modal-footer">
						
						<button type="submit" class="btn btn-primary">{{ getLanguage('Apply') }}</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">{{ getLanguage('Cancel') }}</button>
					</div>
				</div> <!-- / .modal-content -->
			</div> <!-- / .modal-dialog -->
		</div> <!-- /.modal -->
		<!-- / Modal -->
	</form>
<div class="col-sm-12" style="padding-top:5px;">
	<div class="panel panel-info">
		<div class="panel-heading" style="height:50px;">
			<span class="panel-title"><i class="panel-title-icon fa fa-bullhorn"></i> 
				Unauthorized Records - {{Title}} :  <span class="badge badge-info"> {{QueryObj.count()}}</span>
			</span>
			<div class="panel-heading-controls" >
				<div class="panel-heading-icon"style="padding-top:0px;" >
				<!-- 	<a class="btn btn-flat btn-labeled btn-success" id="SpinOnClick">
					<span class="icon fa fa-refresh" id="iConSpin"></span> &nbsp;Update</a> -->
				
		<!-- 		<button  type="button" data-toggle="modal" data-target="#getCustomRange"  class="btn btn-flat btn-labeled btn-success pull-right" >
				<span class="btn-label icon fa fa-gear" ></span> Custom </button> -->

				<a href="javascript:void(0)" title="Refresh" id="Refresh" class="btn btn-flat btn-labeled btn-warning pull-right" style="margin-left: 5px;">
					<span class="btn-label icon fa fa-refresh"></span> Refresh
				</a>
				<button  type="button" data-toggle="modal" data-target="#getCustomRange"  class="btn btn-flat btn-labeled btn-success pull-right" >
				<span class="btn-label icon fa fa-gear"></span> Custom </button>
				</div>
			</div>

		</div>
		<div class="panel-body" >

			{%if QueryObj.count() != 0 %}
				<div class="table-responsive">
				<table  class="table table-hover table-striped panel" id="mktlist" style="width:100%;">
					<thead>
						<tr>
							<th width="250px">ID</th>
							<th> Status</th>
							<th>Inputter</th>
							{% if NAuthorize > 1 %}
								{% for item in range(1, NAuthorize) %}
									<th>Review_{{item}}</th>
								{% endfor %}
							{% endif %}
							<th>Input DateTime</th>
							<th>Branch</th>
							<th>Description</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody>
						{%for row in QueryObj%}
						
						<tr>

							<td class="{{row.ID}}" {%if User == row.Inputter%} style=" text-decoration: underline;" {%endif%}>{{row.ID}} </td>

							<td class="link border-b" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')">{{row.Status}} </td>

							<td class="link" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')">{{row.Inputter}} </td>
							{% if NAuthorize > 1 %}
								{% for item in range(1, NAuthorize) %}
									{% if getattr(row,'Reviewer_%s'%item) %}
										<td class="link" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')">{{getattr(row,'Reviewer_%s'%item)}}</td>
									{% else %}
										<td class="link" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')"> </td>
									{% endif %}
								{% endfor %}
							{% endif %}
							<td class="link" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')">{{row.Createdon}} </td>

							<td class="link" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')">{{row.Branch}} </td>
							<td class="link" onClick="ClickView('{{Title}}','{{Url}}','{{row.ID}}')">{{row.Description}}</td>
							<td>
							<a class="link" title="Edit" onClick="ClickEdit('{{Title}}','{{Url}}','{{row.ID}}')">
								<span class="label label-warning">Edit</span> 
							</a>

							</td>
						</tr>
						{%endfor%}
					</tbody>
				</table>
				</div>
			{%endif%}
		</div> <!-- panel-body -->
	</div> <!-- panel panel-info -->
</div> <!-- col-sm-12 -->
	
{% endblock %}
</div> <!-- ./#Main -->
{% block js %}


{# <script src="{{ url_for('static',filename='javascripts/jquery.datatables.min.js') }}"></script> #}

<script type="text/javascript">
	$(document).ready(function() {

		$('#mktlist').dataTable({
		"lengthMenu": [[25,50,100,200, -1], [25,50,100,200, "All"]],
		responsive: true,
	
		});

		$("#Refresh").click(function() {
			fn_fadeIn();
			window.location.reload(true);
		});
	});
</script>

{% endblock %}