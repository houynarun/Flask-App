{% extends "layout.html" %}

{% block css %}
<style type="text/css">
		.modal {
			z-index: 99999 !important;
		}
		.modal-backdrop {
			z-index: 99 !important;	
		}
</style>
{% endblock %}

{% block content %}
{%if ErrorMsg %}
	<div class="col-sm-12" style="padding-top:5px;">
		<div class="alert alert-danger">
		<button type="button" class="close" data-dismiss="alert">&times;</button>
		{%for message in ErrorMsg %}
			{{ message }}
		{%endfor%}
		</div>
	</div>
{%else%}
	
	<div class="navbar navbar-default navbar-static-top ActionHeader"  >
	<div class="col-sm-12">

		<div style="margin-top: 8px;">

		</div> 
		<div class="col-sm-6" style="padding-top:10px; padding-left:0px;">

			{% from "print.html" import exportButtonLink %}
			{{exportButtonLink()}}

		</div>

		<button  type="button"  class="btn btn-flat btn-labeled btn-success pull-right" data-toggle="modal" data-target="#myModal">
		<span class="btn-label icon fa fa-gear"></span> Custom </button>
	</div> 
	<!-- Filter  -->
	<div class="modal fade" id="myModal" role="dialog" tabindex="-1" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<form class="form-horizontal" action="/Morakot/RecordLog" method="POST">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="exampleModalLabel">Custom</h4>
					</div>
					 <!-- filter control -->
					<div class="modal-body" style="margin-right: 120px;">
						<!-- Branch-->
						<div class="form-group">
							<label for="Branch" class="col-sm-4 control-label">Branch:</label>
							<div class="col-sm-8">
								<input name="Branch" value="{{ Branch }}" class="input-sm form-control" style="width: 100%;">
							</div>
						</div>

						<!-- User ID -->
						<div class="form-group">
							<label for="UserID" class="col-sm-4 control-label">User ID:</label>
							<div class="col-sm-8">
								<input name="UserID" value="{{ UserID }}" class="input-sm form-control" style="width: 100%;">
							</div>
						</div>

						<!-- Global ID -->
						<div class="form-group">
							<label for="GlobalID" class="col-sm-4 control-label">Global ID:</label>
							<div class="col-sm-8">
								<input name="GlobalID" autocomplete="on" value="{{ GlobalID }}" class="input-sm form-control" style="width: 100%;">
							</div>
						</div>

						<!-- Module -->
						<div class="form-group">
							<label for="GlobalID" class="col-sm-4 control-label">Module:</label>
							<div class="col-sm-8">
								<select name="Module" id="Module" style="width:100% !important;">
									<option value="">None</option>
									{% for key,value in Module.iteritems() %}
										<option value="{{value}}">{{value}}</option>
									{% endfor %}

								</select>
								<script type="text/javascript">
									init.push(function () {
										// Single selects
										$("#Module").select2({
											allowClear: true,
											placeholder: "Module Option",
											sortResults: function(data) {
													        /* Sort data using lowercase comparison */
													        return data.sort(function (a, b) {
													            a = a.text.toLowerCase();
													            b = b.text.toLowerCase();
													            if (a > b) {
													                return 1;
													            } else if (a < b) {
													                return -1;
													            }
													            return 0;
													        });
													    }

										});
									});
									if ("{{SelectedModule}}"!=""){
										$("#Module").val("{{SelectedModule}}")
								}

								</script>
							</div>
						</div>

						<!-- Date -->
						<div class="form-group">
							<label for="Date" class="col-sm-4 control-label">Date:</label>
							<div class="col-sm-8">
								<input type="textbox" name="Date" value="{{Date}}" id="Date" class="input-sm form-control" style="width: 100%;">
							</div>
						</div>
						
						<!-- Unuse ID -->
						<div class="form-group">
							<label for="UnusedID" class="col-sm-4 control-label">Unused ID: </label>
							<div class="col-sm-8">
								<select class="input-sm form-control" id="UnusedID" name="UnusedID" style="width:100%;">
									<optgroup label="">
										<option value="None">None</option>
										<option value="Y">Yes</option>
									 </optgroup>
								</select>
								<script type="text/javascript">
									UnusedID = "{{UnusedID}}";
									if(UnusedID!=""){
										$("#UnusedID").val(UnusedID);
									}
								</script>
							</div>
						</div>
			   
					</div>
						<!-- end filter control -->
					<div class="modal-footer">
						<button type="submit" id="btnApply" class="btn btn-primary">Apply</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
					</div>

				</form>
			</div>
		</div>
	</div>

</div>
	<!--  message  -->
	<div class="clearfix"></div>
	<div class="col-sm-12">
		{% for message in get_flashed_messages() %}
			{% if contain(message,"Error") %}
				<div class="alert alert-danger">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				{{ message[6:]}}
			</div>
			{% elif contain(message,"Warning") %}
				<div class="alert alert-warning">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				{{ message[8:] }}
			</div>
			{% else %}
				<div class="alert alert-info">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
				{{ message }}
			</div>
			{% endif %}
		{% endfor %}
		
	</div>
	<div class="col-sm-12">
		<h3 class="header-3 text-center" style="padding-bottom:40px;">Record Log Reports</h3>
		<table class="table table-hover" id="mktlist">
			<thead>
				<tr>
					<th>Branch</th>
					<th>Status</th>
					<th>User ID</th>
					<th>Date</th>
					<th>Global ID</th>
					<th>Tittle</th>
					<th>Description</th>
				</tr>
			</thead>
			
			<tbody class="valign-middle">
				{%if NotificationList%}
				{%for row in NotificationList%}
				<tr>
					<td>{{row.get('1')}}</td>
					<td>{{row.get('2')}}</td>
					<td>{{row.get('3')}}</td>
					<td>{{row.get('4')}}</td>
					<td>{{row.get('5')}}</td>
					<td>{{row.get('6')}}</td>
					<td>{{row.get('7')}}</td>
				</tr>
				{%endfor%}
				{%endif%}
			</tbody>	
		</table>
	</div>
{%endif%}
{% endblock %}

{% block js %}

{% from "print.html" import exportIncludeJS %}
{{exportIncludeJS()}}
<script type="text/javascript">
	$(document).ready(function() {
		init.push(function () {
				var options = {
					orientation: $('body').hasClass('right-to-left') ? "auto right" : 'auto auto',
					format:"yyyy-mm-dd",
					multidate:true,
					autoclose:true,
					multidateSeparator:' '
				}
				$('#Date').datepicker(options);
			});
		
		var oTable = $('#mktlist').dataTable({
			"lengthMenu": [[25,50,100,200, -1], [25,50,100,200, "All"]],
			"bSort" : false,
			// "bLengthChange" :false,
		});
		// $('.table-header').hide()
		// $('#users-url').addClass('active');
		{% from "print.html" import exportDataTable %}
		{{exportDataTable('#mktlist',"Record Log Reports")}}
	});

</script>

{% endblock %}