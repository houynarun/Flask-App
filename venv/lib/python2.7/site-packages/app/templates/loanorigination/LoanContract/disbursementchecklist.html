{% extends "layout.html" %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='stylesheets/jquery.datatables.css') }}">
<style type ="text/css">
	/*CSS*/
</style>
{% endblock %}

{% block content %}
<div class="container">
	<div id="checklistpreview" style="clear: both;" data-checklist='false'>
	</div>
</div>

{% endblock %}

{% block js %}
<script type="text/javascript" src="{{ url_for('static', filename='javascripts/jquery.datatables.min.js') }}"></script>
<script type="text/javascript">
	$(document).ready(function(){

		var ID = window.parent.$('#ID').val();
		/* Load on page load */
		getCheckListPreview(ID);

		function getCheckListPreview(ID)
		{
			var Status = window.parent.$('#Status').val();

			var Save = window.parent.$('#Save').length;

			if(Save == 0)
			{
				// alert('Saved');
				window.parent.$('#container_tab li a[href="#6-DisbursementCheckList"]').css('display','none');
				window.parent.$('#container_tab li a[href="#7-DisbursementCheckList"]').css('display','block');
			}else
			{
				window.parent.$('#container_tab li a[href="#6-DisbursementCheckList"]').css('display','block');
				window.parent.$('#container_tab li a[href="#7-DisbursementCheckList"]').css('display','none');
			}
			
			if((Status == 'AUTH' || Status=='INAU') && Save==0)
			{
				setTimeout(disableButton, 1000 );

				function disableButton () {
						$('#checklist').attr('disabled','disabled');
						$('input:checkbox').attr('disabled','disabled');
				        }
			}
			// alert(Curr);
			var LoanID = ID;
			var url = '/Morakot/checklistDisb/'+LoanID;
			$.ajax({
				url: url,
				type: "GET",
				beforeSend: function(data) {
				},
				success: function(data){
					$('#checklistpreview').attr('data-checklist','true');
					var contents = $('#checklistpreview').html(data);
					// alert(data);
					var input = contents.find('input').length;
					if(input > 0)
					{
						$('a#checklist').attr('data-href','/Morakot/checklistDisbEdit/'+LoanID);
						$('#checklist').text('Update Check List');
					}
				},
				error:function(data){
				}
			});
		}

	})
</script>
{% endblock %}