{# Macro for show signture of loan application #}

{% macro Signature(ApprovalObj,Action,RejectedObj) %}

{%set LoanApp = ApprovalObj.filter_by(Action=Action) %}
{%set ActionName = {'1':'Reviewed','2':'Approved','3':'Rejected','4': 'Comment'} %}
{%set Cardinal = {1:'1<sup>st</sup>',2:'2<sup>nd</sup>',3:'3<sup>rd</sup>'}%}
{%set Count = 1 %}
{% if LoanApp.count() >= 1 %}
	{%for row in LoanApp %}
		{%set date = row.Createdon.split(' ') %}
		{%set createdon = row.Createdon %}
		<div class="form-group">
			<label for="{{ActionName[Action]}}By_{{Count}}" class="col-sm-2 control-label"><label for="{{ActionName[Action]}}By_{{Count}}">{{Cardinal[Count]|safe}} {{ActionName[Action]}} By</label></label>
			<div class="col-sm-10">
				<input class="form-control" value="{{row.Inputter}}" id="{{ActionName[Action]}}By_{{Count}}" readonly="readonly" name="{{ActionName[Action]}}By_{{Count}}" type="text" data-original-title="" title="">
			</div>
		</div>
		<div class="form-group">
			<label for="{{ActionName[Action]}}Date_{{Count}}" class="col-sm-2 control-label"><label for="{{ActionName[Action]}}Date_{{Count}}">{{ActionName[Action]}} Date</label></label>
			<div class="col-sm-10">
				<input class="form-control" value="{{createdon}}" id="{{ActionName[Action]}}Date_{{Count}}" readonly="readonly" name="{{ActionName[Action]}}Date_{{Count}}" type="text" data-original-title="" title="">
			</div>
		</div>
		<div class="form-group">
			<label for="Comment{{ActionName[Action]}}_{{Count}}" class="col-sm-2 control-label"><label for="Comment{{ActionName[Action]}}_{{Count}}">Comment</label></label>
			<div class="col-sm-10">
				<textarea class="form-control" id="Comment{{ActionName[Action]}}_{{Count}}" readonly="readonly" name="Comment{{ActionName[Action]}}_{{Count}}" data-original-title="">{{row.Comment}}</textarea>
			</div>
		</div>
		{%if Action=='3'%}
			{% set ReasonObj = RejectedObj.filter_by(Inputter=row.Inputter).first() %}
			<div class="form-group">
				<label for="Reason{{ActionName[Action]}}_{{Count}}" class="col-sm-2 control-label"><label for="Reason{{ActionName[Action]}}_{{Count}}">Reason</label></label>
				<div class="col-sm-10">
					<textarea class="form-control" id="Reason{{ActionName[Action]}}_{{Count}}" readonly="readonly" name="Reason{{ActionName[Action]}}_{{Count}}" data-original-title="">{{ ReasonObj.RejectedReason if ReasonObj.RejectedReason else row.Comment }} </textarea>
				</div>
			</div>
		{%endif%}

		{%set Count = Count+1 %}
	{%endfor%}
{% else %}
	<div class="form-group">
		<label for="{{ActionName[Action]}}By" class="col-sm-2 control-label"><label for="{{ActionName[Action]}}By">{{ActionName[Action]}} By</label></label>
		<div class="col-sm-10">
			<input class="form-control" value="" id="{{ActionName[Action]}}By" readonly="readonly" name="{{ActionName[Action]}}By" type="text" data-original-title="" title="">
		</div>
	</div>
	<div class="form-group">
		<label for="{{ActionName[Action]}}Date" class="col-sm-2 control-label"><label for="{{ActionName[Action]}}Date">{{ActionName[Action]}} Date</label></label>
		<div class="col-sm-10">
			<input class="form-control" value="" id="{{ActionName[Action]}}Date" readonly="readonly" name="{{ActionName[Action]}}Date" type="text" data-original-title="" title="">
		</div>
	</div>
	<div class="form-group">
		<label for="Comment{{ActionName[Action]}}" class="col-sm-2 control-label"><label for="Comment{{ActionName[Action]}}">Comment</label></label>
		<div class="col-sm-10">
			<textarea class="form-control" value="" id="Comment{{ActionName[Action]}}" readonly="readonly" name="Comment{{ActionName[Action]}}" data-original-title="" title=""></textarea>
		</div>
	</div>
	{%if Action=='3'%}
	<div class="form-group">
		<label for="Reason{{ActionName[Action]}}_{{Count}}" class="col-sm-2 control-label"><label for="Reason{{ActionName[Action]}}_{{Count}}">Reason</label></label>
		<div class="col-sm-10">
			<textarea class="form-control" id="Reason{{ActionName[Action]}}_{{Count}}" readonly="readonly" name="Reason{{ActionName[Action]}}_{{Count}}" data-original-title=""></textarea>
		</div>
	</div>
	{%endif%}
{%endif%}
{% endmacro %}

{% macro FullSignature(ApprovalObj,LoanAppObj,Action=['1','2','3','4'],RejectedObj) %}
	{% set PreparedBy = "" %}
	{% set PreparedDate = "" %}
	{% if LoanAppObj %}
		{% set PreparedBy = LoanAppObj.PreparedBy %}
		{% set PreparedDate = LoanAppObj.PreparedDate %}
	{% endif %}
	{# Prepared By #}	
	<div class="form-horizontal" style="width: 100%">
		<div class="form-group">
			<label for="PreparedBy" class="col-sm-2 control-label"><label for="PreparedBy">Prepared By</label></label>
			<div class="col-sm-10">
				<input class="form-control" value="{{PreparedBy}}" id="PreparedBy" readonly="readonly" name="PreparedBy" type="text" data-original-title="" title="">
			</div>
		</div>
		<div class="form-group">
			<label for="PreparedDate" class="col-sm-2 control-label"><label for="Prepared Date">Prepared Date</label></label>
			<div class="col-sm-10">
				<input class="form-control" value="{{PreparedDate}}" id="PreparedDate" readonly="readonly" name="PreparedDate" type="text" data-original-title="" title="">
			</div>
		</div>
		<hr>
		{# Reviewe, Approve , Rejected, Comment #}
		{% for item in Action %}
			{{Signature(ApprovalObj=ApprovalObj,Action=item,RejectedObj=RejectedObj)}}
			<hr>
		{% endfor %}
	</div>
{% endmacro %}