{% extends "layout.html" %}

{% block css %}
   
    <style type="text/css">
        .form-control
        {
            width: 100% !important;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="se-pre-con1"></div>
    <div class="navbar navbar-default navbar-static-top ActionFotter" id="CriteriaSetting" >
        <div class="col-sm-12">
                <div style="margin-top: 8px;">
                </div> 
                <div class="col-sm-6" style="padding-top:10px; padding-left:0px;">

                    {% from "print.html" import exportButtonLink %}
                    {{exportButtonLink()}}

                </div>  
        </div> 
    </div>
    
    
    <div class="col-sm-12" id="navberCriteria">
        {% include 'msg_error.html' %}
        <form action="" method="GET" role="FORM" id="generate_schedule">
            <div class="col-sm-6 col-sm-offset-1">
                <div class="panel colourable panel-info panel-dark">

                    <div class="panel-heading">
                        <span class="panel-title"><i class="fa fa-calculator" aria-hidden="true"></i> Calculator</span>
                    </div>
                    <div class="panel-body">
                        
                        <div class="form-group">
                            <label class="col-sm-3">Income <span style="color:#D49CAC;">*</span>:</label>
                            <div class="col-sm-4">
                                <input type="number" step="0.01" id="Income" name="Income" value="{{Income}}" class="form-control" required="required" min="0">
                            </div>
                            <span class="col-sm-5"> ($ US Dollar) </span>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3">Expense <span style="color:#D49CAC;">*</span> :</label>
                            <div class="col-sm-4">
                                <input type="number" step="0.01" id="Expense" name="Expense" value="{{Expense}}" class="form-control" required="required" min="0">
                            </div>
                            <span class="col-sm-5"> ($ US Dollar) </span>
                        </div>
                    
                        <div class="form-group">
                            <label class="col-sm-3">Product :</label>
                            <div class="col-sm-4">
                               <select class="form-control" id="Product" name="Product">
                                    <optgroup label="Product">
                                        {%for row in LoanProductObj %}
                                            <option value="{{row.ID}}"> {{row.ID}} - {{row.Description}} </option> 
                                        {%endfor%}
                                     </optgroup>
                                </select>
                                <script type="text/javascript">
                                    init.push(function () {
                                        // Single select
                                        $("#Product").val('{{Product}}');
                                        $("#Product").select2({
                                            allowClear: true,
                                            placeholder: "Product"
                                        });

                                    });
                                </script>
                            </div>
                            <span class="col-sm-5"> (Loan Product) </span>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3">Interest Rate <span style="color:#D49CAC;">*</span>:</label>
                            <div class="col-sm-4">
                                <input type="number" step="0.01" id="InterestRate" name="InterestRate" value="{{ InterestRate }}" class="form-control" required="required" min="0">
                            </div>
                            <span class="col-sm-5"> (% Monthly)</span>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3">Tenor <span style="color:#D49CAC;">*</span>:</label>
                            <div class="col-sm-4">
                                <input type="number" step="1" name="Tenor" value="{{Tenor}}" class="form-control" required="required" min="1" max="1200">
                            </div>
                            <span class="col-sm-5"> (Month) </span>
                        </div>
                        
                        <div class="form-group">
                            <label class="col-sm-3">Property Price :</label>
                            <div class="col-sm-4">
                                <input type="number" step="0.01" name="PropertyPrice" value="{{PropertyPrice}}" class="form-control" min="0">
                            </div>
                            <span class="col-sm-5"> ($ US Dollar) </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 form-group text-center">
                            <input type="submit" id="Generate" value="Calculate Amount" class="btn btn-info">
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-sm-4">

                <div class="panel colourable panel-info panel-dark">
                    <div class="panel-heading">
                        <span class="panel-title"><i class="fa fa-pie-chart" aria-hidden="true"></i> Summary</span>
                    </div>
                    <div class="panel-body responsive" style="height: 368px; line-height: 300%; position: relative;">

                        <div class="form-group">
                            <label class="col-xs-12 col-sm-6">Estimated Loan Amount : </label>
                            <span class="col-xs-12 col-sm-6 text-lg"><strong>$ {{Principal if Principal else 0}}</strong></span>
                        </div>

                        <div class="form-group">
                            <label class="col-xs-12 col-sm-6">Equated Monthly Installment : </label>
                            <span class="col-xs-12 col-sm-6 text-lg"><strong>$ {{EMI if EMI else 0}}</strong></span>
                        </div>

                        <div class="form-group">
                            <label class="col-xs-12 col-sm-6">Loan to Value Ratio : </label>
                            <span class="col-xs-12 col-sm-6 text-lg"><strong>{{LVR if LVR else 0}} %</strong></span>
                        </div>

                        <div class="text-right" style="position: absolute; right:10px; bottom: 10px;">
                            <a href='javascript:void(0)' onClick=CustomClickView('Loan&nbspCalculator','LoanCalculator')>Advance Loan Calculator</a>
                        </div>
                    </div>
                </div>
            </div><!--End Summary Data-->

        </form>

<!--         <div>
            <a class="btn btn-info" href="/Morakot/LoanCalculator">LoanCalculator</a>
        </div> -->
    </div>

{% endblock %}

{% block js %}

{% from "print.html" import exportIncludeJS %}
{{exportIncludeJS()}}

<script type="text/javascript">

    $(document).ready(function() {
        $('#mktlist').dataTable({
            "lengthMenu": [[25,50,100,200, -1], [25,50,100,200, "All"]],
            "bSort" : false,
            "bScrollCollapse": true
        });
        {% from "print.html" import exportDataTable %}
        {{exportDataTable("#mktlist","Daily Cash Collection Reports ")}}
        
        $(function() {
            $('#Product').bind('change', function() {
                $.getJSON('/Morakot/LoanProductInfo', {
                    LoanProduct:$("#Product").val(),Currency:'USD'
                }, function(data) {
                    var MonthlyInterestRate = parseFloat(data.InterestRate)/parseFloat(12);
                    $('#InterestRate').val(MonthlyInterestRate.toPrecision(2));
                    console.log(data);
                });
                return false;
            });
        });
    });

</script>
{% endblock %}