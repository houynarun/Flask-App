<style type="text/css">
		.carousel-inner > .item > img {
    	max-height: 100%;  
	    max-width: 100%; 
	    width: auto;
	    height: auto;
	    position: absolute;  
	    top: 0;  
	    bottom: 0;  
	    left: 0;  
	    right: 0;  
	    margin: auto;
	}
	.carousel .left, .carousel .right{
		width: 0px;
	}
	.carousel .left > span,
	.carousel .right > span {
	  position: absolute;
	  left: 20px;
	  top: 50%;
	  transform: translateY(-50%);
	}
	.carousel .right > span {
	  left: auto;
	  right: 20px;
	}
	.modal-dialog .close-modal {
	    color: #555;
	    font-size: 25px;
	    margin-top: -22px;
	    margin-right: -15px;
	}
	#caption-title{
		font-weight: bold;
		color:#fff;
		font-size: 30px !important;
	}
	.carousel-caption {
		bottom: 0px;
		background: #807b7ca8;
		padding: inherit;
		display: none;
		width: 75%;
		left: 13%;
		right: 0;
	}
	.modal {
		background: rgba(0,0,0,.7);
	}
	.fullscreen{
		margin:0;
		width:100% !important;
		height:100% !important;
	}
	.item-full-height {
		height:560px !important;
	}
</style>
<div class="modal-dialog modal-lg" style="width: 90%;">
	<div class="modal-content" style="background: #fff">

		<!-- <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="exampleModalLabel">Document</h4>
        </div> -->

        {% set first_index = FirstIndex %}

        <div class="modal-body" style="background: none;">
        	<button type="button" class="close close-modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        	{% if DocumentObj %}
        			<div id="carousel-api-attachment-generic" class="carousel" data-ride="carousel">

					  	<!-- Wrapper for slides -->
					  	<div class="carousel-inner">

				  			{% set i = 0 %}

				  			{% for item in DocumentObj %}
				  				{% set url_no_image =  url_for('static', filename='images/noPreview.png')%}

				  				{% if item.DocumentType == 'Image' %}
				  				
					  				<div class="item item-{{i}} {% if i | string == first_index %}active{% endif %}" style="height: 500px;background: #555"
					  					data-description-{{i}}='{{item.Description}}'
					  					data-link-{{i}}='{{item.Link}}'
					  					data-createdon-{{i}}='{{item.Createdon}}'>
							     		<img class="" src="{{ url_for('custom_attachment', filename=item.Link) }}" onerror="this.src='{{url_no_image}}'">
							      		<div class="carousel-caption" style="background: pink">
				        					<div class="carousel-caption" style="">
				        		        		<h3 class="title" id="caption-title"><b>{{ item.Description }}</b></h3>
				        		        		<p><span style="color:#fff" id="caption-createdon">Created On {{ item.Createdon }}</span></p>
				        		        		<p>
				        		        			<a target="_blank" href="{{ url_for("custom_attachment", filename=item.Link) }}" title="Download"><i class="fa fa-download" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff">Download</span> </a> &nbsp;&nbsp;
				        		        			<a href="javascript:void(0)" data-dismiss="modal"><i class="fa fa-times" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff">Close</span> </a> &nbsp;&nbsp;
				        		        			<a href="javascript:void(0)" class="fullscreen"><i class="fa fa-external-link" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff" class='spanfull'>Full Screen</span> </a>
				        		        		</p>
				        		      		</div>
							      		</div>
							    	</div>

							    {% else %}

							    	<div class="item item-{{i}} {% if i | string == first_index %}active{% endif %}" style="height: 500px;background: #555" 
							    		data-description-{{i}}='{{item.Description}}'
					  					data-link-{{i}}='{{item.Link}}'
					  					data-createdon-{{i}}='{{item.Createdon}}'> 
								    	<object data="{{ url_for('custom_attachment', filename=item.Link) }}" type="application/pdf" class="pdf-item" width="100%" height="550px">
										  	<p>Can't view this file - link <a href="{{ url_for('custom_attachment', filename=item.Link) }}">to download PDF!</a></p>
										</object>
										<div class="carousel-caption" style="">
							        		<h3 class="title" id="caption-title"><b>{{ item.Description }}</b></h3>
							        		<p><span style="color:#fff" id="caption-createdon">Created On {{ item.Createdon }}</span></p>
							        		<p>
							        			<a target="_blank" href="{{ url_for("custom_attachment", filename=item.Link) }}" title="Download"><i class="fa fa-download" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff">Download</span> </a> &nbsp;&nbsp;
							        			<a href="javascript:void(0)" data-dismiss="modal"><i class="fa fa-times" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff">Close</span> </a> &nbsp;&nbsp;
							        			<a href="javascript:void(0)" class="fullscreen"><i class="fa fa-external-link" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff" class='spanfull'>Full Screen</span> </a>
							        		</p>
							      		</div>
									</div>

							    {% endif %}

						    	{% set i = i + 1 %}

				  			{% endfor %}

					  	</div>

					  	{%if DocumentObj | length > 1 %}
					  	
					  	<!-- Controls -->
					  	<a class="left carousel-control" href="#carousel-api-attachment-generic" role="button" data-slide="prev" style="">
					    	<span class="fa fa-chevron-left"></span>
					  	</a>
					  	<a class="right carousel-control" href="#carousel-api-attachment-generic" role="button" data-slide="next" style="">
					    	<span class="fa fa-chevron-right"></span>
					  	</a>
					  	{% endif%}
					  	
					</div>	

			{% else %}
		    		
					<div class="col-sm-12" style="padding: 5%"></div>	
					<div class="col-sm-12 text-center">
						<i class="fa fa-file text-success" style="font-size: 70px"></i>
					</div>
					<div class="col-sm-12">
						<h1 class="header-3 text-center text-default"><span style="font-weight: bold;">Document Upload</span></h1>
					</div>	
					<div class="col-sm-12 text-center" style="padding:5px 10px">
						<span class="text-center" style="font-size: 15px">
							There are no upload files.
						</span> 
					</div>
					<div class="col-sm-12" style="padding: 5%"></div>
	    	{% endif %}

		</div>
	</div>
<!-- 	{% if DocumentObj %}
	<div class="row">
		<div class="text-center" style="padding: 10px;background: none;" id="dev-caption">
			<h4 class="title" id="caption-title"></h4>
			<p><span style="color:#fff" id='caption-createdon'></span></p>

				<p>
					<a target="_blank" href="" title="Download" id="caption-link">
					<i class="fa fa-download" style="color:#fff"></i>&nbsp;&nbsp;
					<span style="text-decoration: underline;color:#fff">Download</span> </a> &nbsp;&nbsp;
					
					<a href="javascript:void(0)" data-dismiss="modal"><i class="fa fa-times" style="color:#fff"></i>&nbsp;&nbsp;
					<span style="text-decoration: underline;color:#fff">Close</span> </a>
				</p>
		</div>	
	</div>
	{%endif%} -->
</div>

<!-- <script src="http://malsup.github.com/jquery.form.js"></script> -->
<script type="text/javascript">
	$('#carousel-api-attachment-generic').carousel({interval:false});
	//set caption text for first slide
	var first_index = '{{first_index}}'
	$("#caption-title").html('<b>'+$(".item-"+first_index).data('description-'+first_index)+'</b>')
	$("#caption-link").attr("href",'{{ url_for("custom_attachment", filename="") }}'+$(".item-"+first_index).data('link-'+first_index))
	$("#caption-createdon").html('Created On '+ $(".item-"+first_index).data('createdon-'+first_index))
	//end

	//change caption text dynamic based on each slide
	$("#carousel-api-attachment-generic").on('slide.bs.carousel', function(evt) {

		var step = $(evt.relatedTarget).index();
		var item = $(this).children('div.carousel-inner').children('div.item-'+step)
		var description = item.data('description-'+step)
		var link = item.data('link-'+step)
		var createdon = item.data('createdon-'+step)

		var stringhtml = '<h3 class="title" id="caption-title"><b>'+description+'</b></h3>'
		stringhtml+= '<p><span style="color:#fff" id="caption-createdon">Created On '+createdon+'</span></p>'
		stringhtml+= '<p>';
		stringhtml+= '<a target="_blank" href="{{ url_for("custom_attachment", filename="") }}'+link+'" title="Download"><i class="fa fa-download" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff">Download</span> </a> &nbsp;&nbsp;'
		stringhtml+='<a href="javascript:void(0)" data-dismiss="modal"><i class="fa fa-times" style="color:#fff"></i>&nbsp;&nbsp;<span style="text-decoration: underline;color:#fff">Close</span> </a>'
		stringhtml+='</p>'

		$("#dev-caption").html('')
		$("#dev-caption").html(stringhtml)
		$('.carousel-caption').show();
	});

	//set auto height of modal based on screen size
  	// problem with iphone device, so we need to disable it on iphone
  	// if not, image won't display
    var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      if(isMobile==false)
      {
      	setModalHeight()
      	$(window).resize(function(){
      		setModalHeight()	
      	})
      }

	function setModalHeight(){
		var height = window.outerHeight
		$('.item').css('height', (75)+'vh')		
		$('.pdf-item').css('height', (75)+'vh')	
	}

	/* caption fade out or fade in */
	var interval = 15000; // 15 seconds
	/* when hover on modal */
	$('.item,embed').hover(function(){
		$('.carousel-caption').stop(true,true);
		$('.carousel-caption').show().fadeOut(interval);
	}, function(){
		$('.carousel-caption').fadeOut(interval);
	});
	// /* when hover over caption it self */
	$('.carousel-caption,embed').hover(function(){
		$(this).stop(true,true).show();
	},function(){
		$(this).stop(true,true).fadeOut(interval);
	});
	// /* when moving mouse over caption*/
	$('.item').mousemove(function(){
		$('.carousel-caption').stop(true,true);
		$('.carousel-caption').show().fadeOut(interval);
	})

	/* Event click to full screen */
	$('.fullscreen').click(function(){
		// $('.carousel-caption').stop(true,true);
		$('.carousel-caption').show().fadeOut(interval);

		$('.item').toggleClass('item-full-height');
		$('.modal-dialog').toggleClass('fullscreen');
	
		if($('.modal-dialog').hasClass('fullscreen')){
			$('.spanfull').text('Exit full screen');

		}else {
			$('.spanfull').text('Enter full screen');
			$('.carousel-caption').stop(true,true);
			$('.carousel-caption').show().fadeOut(interval);
		}

	})

	$('.modal').on('hidden.bs.modal', function () {
		 $('body').find('div.modal-backdrop').remove(); // Removed modal in case it does not disappear already close modal
	});

</script>