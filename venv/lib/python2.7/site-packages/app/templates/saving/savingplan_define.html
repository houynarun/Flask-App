{% extends "layout.html" %}

{% block css %}
   
	<style type="text/css">
		.form-control
		{
			width: 100% !important;
		}
		table.borderless td, .borderless th {
			border: none !important;
		}

		@page {
			margin: 0.1cm 0.5cm;
		}

	body{
		background-color: #fff;
		color: #555;
		/*font-family: "Suwannaphum", Helvetica, Arial, sans-serif;*/
		font-size: 14px;
		line-height: 1.42857;
	}

	.header{
		margin: 10px 0;
	}

	.logo{
		width: 20%;
		/*border: 1px solid;*/
		float: left;
		text-align: center;
	}

	.company{
		width: 75%;
		/*border: 1px solid;*/
		float: left;
	}

	.clearfix{
		clear: both;
		width: 10%;
		height: 15px;
	}

	.companyKh
	{
		font-family: 'Moul', Arial;
	}
	h3 {
		font-size: {% if CompanyKh|length > 25 %} 10pt {% else %} 11pt {% endif %};
	}

	@media print {
		.hideprint {
			display:none;
		}

		.id_table {
			
		}
	}

	</style>
{% endblock %}

{% block content %}
	{% if SavingPlanObj %}
		<div class="se-pre-con1"></div>
			<div class="navbar navbar-default navbar-static-top ActionFotter" id="CriteriaSetting" >
				<div class="col-sm-12">
						<div style="margin-top: 8px;">
						</div> 
						<div class="col-sm-6" style="padding-top:10px; padding-left:0px;">

							{% from "print.html" import exportButtonLink %}
							{{exportButtonLink()}}

						</div>  
				</div> 
			</div> 
		<div class="container">
			<div class="header">
				<div class="col-xs-12">
					<div class="row text-center">
						<div class="col-xs-3" style="height: 150px;">
							<img style="max-width: 100%; max-height: 95%; margin-top: 20px;" 
								src="{{ url_for('static', filename='company/logo.png') }}">
						</div>
						<div class="col-xs-5" style="margin-top:10px;">
							<h4 class="companyKh">{{CompanyObj.LocalName}}</h4>
							{#<h3>{{CompanyObj.CompanyName}}</h3>#}
							<div style="text-align: center; height:24px;"><img src="/static/artwork/lineheader.png"/></div>
							<h4 class="companyKh">Schedule Saving Plan</h4>
						</div>
						<div class="col-xs-4 text-left id_table">
							<table class="" style="width: 100%; margin-top: 30px; margin-right: 30px;" frame="box">
								<tbody>
									<tr style="height: 25px;">
										<td style="padding-left: 10px;">Saving Acc: </td>
										<td><b>{{ SavingPlanObj.SavingAccount }}</b></td>
									</tr>
									<tr style="height: 25px;">
										<td style="padding-left: 10px;">Nominated Acc: </td>
										<td><b>{{ SavingPlanObj.GeneralAccount }}</b></td>
									</tr>
									<tr style="height: 25px">
										<td style="padding-left: 10px;">Customer: </td>
										<td>{{ SavingPlanObj.CustomerID }}</td>
									</tr>
									<tr style="height: 25px">
										<td style="padding-left: 10px;">Saving Plan: </td>
										<td>{{ SavingPlanObj.ID }}</td>
									</tr>
									<tr style="height: 25px">
										<td style="padding-left: 10px;">LoanID: </td>
										<td>{{ SavingPlanObj.LoanID }}</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			 </div>

			<div class="clearfix">&nbsp;</div>

			<div class="clearfix">&nbsp;</div>
			{% include 'msg_error.html' %}			
			<div class="clearfix"></div>

			{#<div class="col-lg-12 col-sm-12 col-xs-12">
				<table style="width: 100%;margin-bottom: 20px" border="0">
					<tbody>
						<tr style="height: 25px;">
							<td><b>Customer Name:</b> {{ CustomerObj.LastNameEn + " " +  CustomerObj.FirstNameEn }}</td>
							<td><b>Value Date:</b> {{mktdate.formatDate(ContractObj.ValueDate,'dd/mm/yyyy')}}</td>
							<td><b>Maturity Date:</b> {{mktdate.formatDate(ContractObj.MaturityDate,'dd/mm/yyyy')}} </td> 
						</tr>
						<tr style="height: 25px;">
							<td><b>Disbursed:</b> {{ toMoney(float(ContractObj.Disbursed), CurrencyObj,1) }}</td>
							<td><b>Interest Rate:</b> {{ ContractObj.InterestRate }} % </td>
							<td><b>Term:</b> {{ ContractObj.Term }} Months </td> 
						</tr>
						<tr style="height: 25px;">
							<td><b>Operation:</b> {{ "Terminate" if DictData.get("Operation") == "TMN" else "Partial Prepayment" }}</td>
							<td><b>Request Date:</b> {{ mktdate.formatDate(str(DictData.get("RequestDate")),'dd/mm/yyyy') }}</td>
							<td><b>Amend Date:</b> {{ mktdate.formatDate(str(DictData.get("AmendmentDate")),'dd/mm/yyyy') }} </td>
						</tr>
						<tr style="height: 25px;">
							<td><b>Deduct Amount:</b> {{ toMoney(float(DictData.get("DeductAmount")), CurrencyObj,1) }}</td> 
							{% if DictData.get("DictPenalty") %}
							<td><b>Num. Day Notify:</b> {{ DictData.get("DictPenalty").get("NumDayNotify") }}</td>
							<td><b>Num. Day Penalty:</b> {{ DictData.get("DictPenalty").get("NumDayPenalty") }}</td>
							{% endif %}
						</tr>
					</tbody>
				</table>
						
			</div>#}

			<table class="table table-striped table-hover" cellpadding="0" >
				<thead>
					<tr>
						<th>No.</th>
						<th>Date</th>
						<th>Amount</th>
						<th>Est.Interest</th>
						<th>Est.Tax</th>
						<th>Est.Balance</th>
					</tr>
				</thead>
				<tbody>
					{% set TotalDict = {"TotAmount":0,"TotInterest": 0,"TotTax": 0} %}
					{% if ScheduleObj %}
					{% for row in ScheduleObj %}
						<tr>
							<td>{{ row.No }}</td>
							<td>{{ row.CollectionDate }}</td>
							<td>{{toMoney(float(row.Amount), CurrencyObj,1)}}</td>
							<td>{{toMoney(float(row.Interest), CurrencyObj,1)}}</td>
							<td>{{toMoney(float(row.Tax), CurrencyObj,1)}}</td>
							<td>{{toMoney(float(row.Balance), CurrencyObj,1)}}</td>
						</tr>
						{%if TotalDict.update({"TotAmount": TotalDict.get("TotAmount") + row.Amount }) %} {%endif%}
						{%if TotalDict.update({"TotInterest": TotalDict.get("TotInterest") + row.Interest }) %} {%endif%}
						{%if TotalDict.update({"TotTax": TotalDict.get("TotTax") + row.Tax }) %} {%endif%}
					{%endfor%}
					{%endif%}
				</tbody>
				<tfooter>
					<tr style="font-weight: bold;">
						<td></td>
						<td>Total</td>
						<td>{{toMoney(float(TotalDict.get("TotAmount")), CurrencyObj,1)}}</td>
						<td>{{toMoney(float(TotalDict.get("TotInterest")), CurrencyObj,1)}}</td>
						<td>{{toMoney(float(TotalDict.get("TotTax")), CurrencyObj,1)}}</td>
						<td></td>
					</tr>
				</tfooter>
			</table>
		</div><br><br><br>

	{% else %}
	<div class="col-xs-12">
		Please save records to view schedule ... 
	</div>
	{% endif %}

{% endblock %}

{% block js %}

{% from "print.html" import exportIncludeJS %}
{{exportIncludeJS()}}

<script type="text/javascript">

	$(document).ready(function() {

		{% from "print.html" import exportDataTable %}
		{{exportDataTable("#mktlist","")}}
		
	});

</script>
{% endblock %}