import app.tools.mkttool 		as mkttool
import app.tools.mktdatamigration as mktmigrate

def validateDrawdown(DictRecord):
	DictMessage 		= {}
	##################################
	### Validate Group field
	#################################	

	Required 			= 	[
								"Branch","ID","CustomerList","AccName","Currency",	
								"AccStatus","OpenDate","Balance","AvailableBal","NextAccrDate",
								"AccCategory","AccProduct","InterestRate","Charge","AccrInterest",
								"AccrCurMonth","AccrIntBooked","AccrCurCapital"
							]

	FormatDate 			=	["OpenDate","NextAccrDate","CloseDate"]
	Choices		 		=	[
								("AccStatus", ("O","C")),
								("AccCategory", ("38982")),
								("AccProduct", ("101")),
								("InterestRate", ("0")),
								("Charge", ("0")),	
								("AccrInterest", ("0")),	
								("AccrCurMonth", ("0")),	
								("AccrIntBooked", ("0")),
								("AccrCurCapital", ("0")),								
							]	
	RecordFound 		=	[
								("Branch","MKT_BRANCH","ID"),
								("CustomerList","MKT_CUSTOMER","ID"),
								("Currency","MKT_CURRENCY","ID"),
							]
	
	Number				=	["Balance","AvailableBal"]	

	RecordFoundMulti	=	[
								("MKT_CUSTOMER", "Branch", "ID", "Branch", "CustomerList"),
							]

	Prefix 				=	[("DDM", "ID")]	

	LookupConcat		=	[("AccName", "MKT_CUSTOMER", ["LastNameEn","FirstNameEn"], {"ID": "CustomerList"}, " ")]	
	CompareValue 		=	[
								("NextAccrDate","==","BankDate")
							]

	DictMessage.update(mktmigrate.exeFunctionValidate(DictRecord=DictRecord,
						Required=Required, 
						FormatDate=FormatDate, 
						InvalidChoies=Choices, 
						Prefix=Prefix, 
						RecordFound=RecordFound, 
						Number=Number,
						RecordFoundMulti=RecordFoundMulti,	
						LookupConcat=LookupConcat,	
						CompareValue=CompareValue,		
						DebugMode=False))

	##################################
	### Validate Custom field
	##################################
	#check if AvailableBal equal to Balance
	AvailableBal = DictRecord.get("AvailableBal")
	Balance		 = DictRecord.get("Balance")
	if AvailableBal != Balance:
		DictMessage.update({"AvailableBal" : "AvailableBal must be equal to Balance"})

	##NextAccrDate must equal system bank date

	return DictMessage